2025-07-23 18:13:49,310 - test_etl - INFO - Starting tests...
2025-07-23 18:13:49,310 - test_etl - INFO - Testing PostgreSQL connection...
2025-07-23 18:13:49,332 - test_etl - ERROR - PostgreSQL connection failed
2025-07-23 18:13:49,332 - test_etl - INFO - Testing Firebird connection...
2025-07-23 18:13:49,332 - test_etl - INFO - Firebird config: {'host': '192.168.160.168', 'port': 3050, 'database': '099-1', 'user': 'SYSDBA', 'password': 'masterkey', 'charset': 'UTF-8', 'debug': False}
2025-07-23 18:13:49,370 - test_etl - INFO - Firebird connection successful
2025-07-23 18:13:49,373 - test_etl - INFO - Firebird current time: 2025-07-23 18:13:49.365000
2025-07-23 18:13:49,380 - test_etl - INFO - Retrieved 3 patients from Firebird through repository
2025-07-23 18:13:49,380 - test_etl - INFO - Patient 1: Проверочный Иван
2025-07-23 18:13:49,380 - test_etl - INFO - Patient 2: Проверочныйюр Наличный
2025-07-23 18:13:49,383 - test_etl - INFO - Testing YottaDB connection...
2025-07-23 18:13:49,383 - test_etl - INFO - WARNING: This test will take 2-3 minutes due to YottaDB API response time
2025-07-23 18:14:19,436 - test_etl - ERROR - YottaDB connection failed
2025-07-23 18:14:19,439 - test_etl - INFO - Testing PostgreSQL schema...
2025-07-23 18:14:19,470 - test_etl - WARNING - Skipping document type handling test due to connection or schema issues
2025-07-23 18:14:19,471 - test_etl - WARNING - Skipping ETL process test due to connection or schema issues
2025-07-23 18:14:19,471 - test_etl - INFO - 
Test Results Summary:
2025-07-23 18:14:19,471 - test_etl - INFO - PostgreSQL Connection: ✗
2025-07-23 18:14:19,471 - test_etl - INFO - Firebird Connection: ✓
2025-07-23 18:14:19,471 - test_etl - INFO - YottaDB Basic Connection: ✗
2025-07-23 18:14:19,471 - test_etl - INFO - YottaDB Full Fetch: ✗
2025-07-23 18:14:19,472 - test_etl - INFO - PostgreSQL Schema: ✗
2025-07-23 18:14:19,472 - test_etl - INFO - Document Type Handling: ✗
2025-07-23 18:14:19,472 - test_etl - INFO - ETL Process: ✗
2025-07-23 18:14:19,472 - test_etl - INFO - 
Tests completed.
2025-07-23 18:15:29,190 - test_etl - INFO - Starting tests...
2025-07-23 18:15:29,190 - test_etl - INFO - Testing PostgreSQL connection...
2025-07-23 18:15:29,205 - test_etl - INFO - PostgreSQL connection successful
2025-07-23 18:15:29,206 - test_etl - INFO - PostgreSQL version: PostgreSQL 15.13 (Debian 15.13-0+deb12u1) on x86_64-pc-linux-gnu, compiled by gcc (Debian 12.2.0-14+deb12u1) 12.2.0, 64-bit
2025-07-23 18:15:29,206 - test_etl - INFO - Testing Firebird connection...
2025-07-23 18:15:29,206 - test_etl - INFO - Firebird config: {'host': '192.168.160.168', 'port': 3050, 'database': '099-1', 'user': 'SYSDBA', 'password': 'masterkey', 'charset': 'UTF-8', 'debug': False}
2025-07-23 18:15:29,266 - test_etl - INFO - Firebird connection successful
2025-07-23 18:15:29,271 - test_etl - INFO - Firebird current time: 2025-07-23 18:15:29.275000
2025-07-23 18:15:29,288 - test_etl - INFO - Retrieved 3 patients from Firebird through repository
2025-07-23 18:15:29,289 - test_etl - INFO - Patient 1: Проверочный Иван
2025-07-23 18:15:29,289 - test_etl - INFO - Patient 2: Проверочныйюр Наличный
2025-07-23 18:15:29,295 - test_etl - INFO - Testing YottaDB connection...
2025-07-23 18:15:29,295 - test_etl - INFO - WARNING: This test will take 2-3 minutes due to YottaDB API response time
2025-07-23 18:15:59,353 - test_etl - ERROR - YottaDB connection failed
2025-07-23 18:15:59,353 - test_etl - INFO - Testing PostgreSQL schema...
2025-07-23 18:15:59,390 - test_etl - INFO - All essential tables exist
2025-07-23 18:15:59,392 - test_etl - INFO - Found 2 HIS systems in hislist table
2025-07-23 18:15:59,393 - test_etl - INFO -   hislist entry: (1, 'qMS')
2025-07-23 18:15:59,393 - test_etl - INFO -   hislist entry: (2, 'Инфоклиника')
2025-07-23 18:15:59,394 - test_etl - INFO - Found 3 business units in businessunits table
2025-07-23 18:15:59,395 - test_etl - INFO -   businessunits entry: (1, 'ОО ФК "Хадасса Медикал ЛТД"')
2025-07-23 18:15:59,395 - test_etl - INFO -   businessunits entry: (2, 'ООО "Медскан"')
2025-07-23 18:15:59,395 - test_etl - INFO -   businessunits entry: (3, 'ООО "Клинический госпиталь на Яузе"')
2025-07-23 18:15:59,396 - test_etl - INFO - Found 17 document types in documenttypes table
2025-07-23 18:15:59,397 - test_etl - INFO -   documenttypes entry: (1, 'Паспорт')
2025-07-23 18:15:59,397 - test_etl - INFO -   documenttypes entry: (2, 'Паспорт СССР')
2025-07-23 18:15:59,397 - test_etl - INFO -   documenttypes entry: (3, 'Заграничный паспорт РФ')
2025-07-23 18:15:59,398 - test_etl - INFO -   documenttypes entry: (4, 'Заграничный паспорт СССР')
2025-07-23 18:15:59,398 - test_etl - INFO -   documenttypes entry: (5, 'Свидетельство о рождении')
2025-07-23 18:15:59,398 - test_etl - INFO - Testing document type handling...
2025-07-23 18:15:59,443 - test_etl - INFO - Inserted patient with Паспорт (ID: 1), number: 3559508182
2025-07-23 18:15:59,445 - test_etl - INFO - Inserted patient with Заграничный паспорт РФ (ID: 3), number: 768171821
2025-07-23 18:15:59,447 - test_etl - INFO - Inserted patient with Свидетельство о рождении (ID: 5), number: 292657551020
2025-07-23 18:15:59,449 - test_etl - INFO - Inserted patient with Иностранный паспорт (ID: 10), number: 948733329
2025-07-23 18:15:59,451 - test_etl - INFO - Inserted patient with Временное удостоверение (ID: 14), number: 70321163
2025-07-23 18:15:59,453 - test_etl - INFO - Inserted patient with Иные документы (ID: 17), number: 95863965
2025-07-23 18:15:59,453 - test_etl - INFO - Successfully inserted 6 out of 6 test patients with different document types
2025-07-23 18:15:59,453 - test_etl - INFO - Testing ETL process with the repository-transformer architecture...
2025-07-23 18:15:59,510 - test_etl - INFO - Processing 10 patients through ETL
2025-07-23 18:15:59,544 - test_etl - INFO - ETL processed 0 patients successfully
2025-07-23 18:15:59,545 - test_etl - WARNING - ETL process test completed but no records were processed
2025-07-23 18:15:59,550 - test_etl - INFO - 
Test Results Summary:
2025-07-23 18:15:59,550 - test_etl - INFO - PostgreSQL Connection: ✓
2025-07-23 18:15:59,550 - test_etl - INFO - Firebird Connection: ✓
2025-07-23 18:15:59,550 - test_etl - INFO - YottaDB Basic Connection: ✗
2025-07-23 18:15:59,550 - test_etl - INFO - YottaDB Full Fetch: ✗
2025-07-23 18:15:59,550 - test_etl - INFO - PostgreSQL Schema: ✓
2025-07-23 18:15:59,550 - test_etl - INFO - Document Type Handling: ✓
2025-07-23 18:15:59,550 - test_etl - INFO - ETL Process: ✗
2025-07-23 18:15:59,551 - test_etl - INFO - 
Tests completed.
2025-07-23 18:16:51,497 - test_etl - INFO - Starting tests...
2025-07-23 18:16:51,497 - test_etl - INFO - Testing PostgreSQL connection...
2025-07-23 18:16:51,523 - test_etl - INFO - PostgreSQL connection successful
2025-07-23 18:16:51,524 - test_etl - INFO - PostgreSQL version: PostgreSQL 15.13 (Debian 15.13-0+deb12u1) on x86_64-pc-linux-gnu, compiled by gcc (Debian 12.2.0-14+deb12u1) 12.2.0, 64-bit
2025-07-23 18:16:51,525 - test_etl - INFO - Testing Firebird connection...
2025-07-23 18:16:51,525 - test_etl - INFO - Firebird config: {'host': '192.168.160.168', 'port': 3050, 'database': '099-1', 'user': 'SYSDBA', 'password': 'masterkey', 'charset': 'UTF-8', 'debug': False}
2025-07-23 18:16:51,579 - test_etl - INFO - Firebird connection successful
2025-07-23 18:16:51,582 - test_etl - INFO - Firebird current time: 2025-07-23 18:16:51.588000
2025-07-23 18:16:51,591 - test_etl - INFO - Retrieved 3 patients from Firebird through repository
2025-07-23 18:16:51,591 - test_etl - INFO - Patient 1: Проверочный Иван
2025-07-23 18:16:51,591 - test_etl - INFO - Patient 2: Проверочныйюр Наличный
2025-07-23 18:16:51,594 - test_etl - INFO - Testing YottaDB connection...
2025-07-23 18:16:51,595 - test_etl - INFO - WARNING: This test will take 2-3 minutes due to YottaDB API response time
2025-07-23 18:17:21,645 - test_etl - ERROR - YottaDB connection failed
2025-07-23 18:17:21,645 - test_etl - INFO - Testing PostgreSQL schema...
2025-07-23 18:17:21,692 - test_etl - INFO - All essential tables exist
2025-07-23 18:17:21,694 - test_etl - INFO - Found 2 HIS systems in hislist table
2025-07-23 18:17:21,694 - test_etl - INFO -   hislist entry: (1, 'qMS')
2025-07-23 18:17:21,694 - test_etl - INFO -   hislist entry: (2, 'Инфоклиника')
2025-07-23 18:17:21,695 - test_etl - INFO - Found 3 business units in businessunits table
2025-07-23 18:17:21,696 - test_etl - INFO -   businessunits entry: (1, 'ОО ФК "Хадасса Медикал ЛТД"')
2025-07-23 18:17:21,696 - test_etl - INFO -   businessunits entry: (2, 'ООО "Медскан"')
2025-07-23 18:17:21,696 - test_etl - INFO -   businessunits entry: (3, 'ООО "Клинический госпиталь на Яузе"')
2025-07-23 18:17:21,697 - test_etl - INFO - Found 17 document types in documenttypes table
2025-07-23 18:17:21,698 - test_etl - INFO -   documenttypes entry: (1, 'Паспорт')
2025-07-23 18:17:21,698 - test_etl - INFO -   documenttypes entry: (2, 'Паспорт СССР')
2025-07-23 18:17:21,698 - test_etl - INFO -   documenttypes entry: (3, 'Заграничный паспорт РФ')
2025-07-23 18:17:21,698 - test_etl - INFO -   documenttypes entry: (4, 'Заграничный паспорт СССР')
2025-07-23 18:17:21,699 - test_etl - INFO -   documenttypes entry: (5, 'Свидетельство о рождении')
2025-07-23 18:17:21,699 - test_etl - INFO - Testing document type handling...
2025-07-23 18:17:21,734 - test_etl - INFO - Inserted patient with Паспорт (ID: 1), number: 1973761981
2025-07-23 18:17:21,737 - test_etl - INFO - Inserted patient with Заграничный паспорт РФ (ID: 3), number: 890061429
2025-07-23 18:17:21,739 - test_etl - INFO - Inserted patient with Свидетельство о рождении (ID: 5), number: 768052524031
2025-07-23 18:17:21,742 - test_etl - INFO - Inserted patient with Иностранный паспорт (ID: 10), number: 181241868
2025-07-23 18:17:21,745 - test_etl - INFO - Inserted patient with Временное удостоверение (ID: 14), number: 99427303
2025-07-23 18:17:21,749 - test_etl - INFO - Inserted patient with Иные документы (ID: 17), number: 32118864
2025-07-23 18:17:21,749 - test_etl - INFO - Successfully inserted 6 out of 6 test patients with different document types
2025-07-23 18:17:21,750 - test_etl - INFO - Testing ETL process with the repository-transformer architecture...
2025-07-23 18:17:21,835 - test_etl - INFO - Processing 10 patients through ETL
2025-07-23 18:17:21,878 - test_etl - INFO - ETL processed 10 patients successfully
2025-07-23 18:17:21,878 - test_etl - INFO - ETL process test successful
2025-07-23 18:17:21,883 - test_etl - INFO - 
Test Results Summary:
2025-07-23 18:17:21,883 - test_etl - INFO - PostgreSQL Connection: ✓
2025-07-23 18:17:21,883 - test_etl - INFO - Firebird Connection: ✓
2025-07-23 18:17:21,883 - test_etl - INFO - YottaDB Basic Connection: ✗
2025-07-23 18:17:21,883 - test_etl - INFO - YottaDB Full Fetch: ✗
2025-07-23 18:17:21,883 - test_etl - INFO - PostgreSQL Schema: ✓
2025-07-23 18:17:21,883 - test_etl - INFO - Document Type Handling: ✓
2025-07-23 18:17:21,883 - test_etl - INFO - ETL Process: ✓
2025-07-23 18:17:21,883 - test_etl - INFO - 
Tests completed.
2025-07-23 18:24:17,210 - test_etl - INFO - Starting tests...
2025-07-23 18:24:17,211 - test_etl - INFO - Testing PostgreSQL connection...
2025-07-23 18:24:17,242 - test_etl - INFO - PostgreSQL connection successful
2025-07-23 18:24:17,245 - test_etl - INFO - PostgreSQL version: PostgreSQL 15.13 (Debian 15.13-0+deb12u1) on x86_64-pc-linux-gnu, compiled by gcc (Debian 12.2.0-14+deb12u1) 12.2.0, 64-bit
2025-07-23 18:24:17,245 - test_etl - INFO - Testing Firebird connection...
2025-07-23 18:24:17,245 - test_etl - INFO - Firebird config: {'host': '192.168.160.168', 'port': 3050, 'database': '099-1', 'user': 'SYSDBA', 'password': 'masterkey', 'charset': 'UTF-8', 'debug': False}
2025-07-23 18:24:17,302 - test_etl - INFO - Firebird connection successful
2025-07-23 18:24:17,307 - test_etl - INFO - Firebird current time: 2025-07-23 18:24:17.309000
2025-07-23 18:24:17,318 - test_etl - INFO - Retrieved 3 patients from Firebird through repository
2025-07-23 18:24:17,318 - test_etl - INFO - Patient 1: Проверочный Иван
2025-07-23 18:24:17,318 - test_etl - INFO - Patient 2: Проверочныйюр Наличный
2025-07-23 18:24:17,322 - test_etl - INFO - Testing YottaDB connection...
2025-07-23 18:24:17,322 - test_etl - INFO - WARNING: This test will take 2-3 minutes due to YottaDB API response time
2025-07-23 18:24:17,335 - test_etl - INFO - YottaDB basic connection test successful
2025-07-23 18:24:17,336 - test_etl - INFO - Testing YottaDB repository with small batch...
2025-07-23 18:26:21,052 - test_etl - INFO - Retrieved 2 patients from YottaDB
2025-07-23 18:26:21,052 - test_etl - INFO - Patient 1: Елена Вадимовна (ID: )
2025-07-23 18:26:21,052 - test_etl - INFO - Patient 2: Юлия Денисовна (ID: )
2025-07-23 18:26:21,216 - test_etl - INFO - Testing PostgreSQL schema...
2025-07-23 18:26:21,253 - test_etl - INFO - All essential tables exist
2025-07-23 18:26:21,254 - test_etl - INFO - Found 2 HIS systems in hislist table
2025-07-23 18:26:21,254 - test_etl - INFO -   hislist entry: (1, 'qMS')
2025-07-23 18:26:21,254 - test_etl - INFO -   hislist entry: (2, 'Инфоклиника')
2025-07-23 18:26:21,255 - test_etl - INFO - Found 3 business units in businessunits table
2025-07-23 18:26:21,256 - test_etl - INFO -   businessunits entry: (1, 'ОО ФК "Хадасса Медикал ЛТД"')
2025-07-23 18:26:21,256 - test_etl - INFO -   businessunits entry: (2, 'ООО "Медскан"')
2025-07-23 18:26:21,256 - test_etl - INFO -   businessunits entry: (3, 'ООО "Клинический госпиталь на Яузе"')
2025-07-23 18:26:21,257 - test_etl - INFO - Found 17 document types in documenttypes table
2025-07-23 18:26:21,257 - test_etl - INFO -   documenttypes entry: (1, 'Паспорт')
2025-07-23 18:26:21,257 - test_etl - INFO -   documenttypes entry: (2, 'Паспорт СССР')
2025-07-23 18:26:21,257 - test_etl - INFO -   documenttypes entry: (3, 'Заграничный паспорт РФ')
2025-07-23 18:26:21,257 - test_etl - INFO -   documenttypes entry: (4, 'Заграничный паспорт СССР')
2025-07-23 18:26:21,257 - test_etl - INFO -   documenttypes entry: (5, 'Свидетельство о рождении')
2025-07-23 18:26:21,258 - test_etl - INFO - Testing document type handling...
2025-07-23 18:26:21,304 - test_etl - INFO - Inserted patient with Паспорт (ID: 1), number: 4334254569
2025-07-23 18:26:21,306 - test_etl - INFO - Inserted patient with Заграничный паспорт РФ (ID: 3), number: 414274945
2025-07-23 18:26:21,309 - test_etl - INFO - Inserted patient with Свидетельство о рождении (ID: 5), number: 914722975636
2025-07-23 18:26:21,312 - test_etl - INFO - Inserted patient with Иностранный паспорт (ID: 10), number: 430000307
2025-07-23 18:26:21,313 - test_etl - INFO - Inserted patient with Временное удостоверение (ID: 14), number: 69706031
2025-07-23 18:26:21,316 - test_etl - INFO - Inserted patient with Иные документы (ID: 17), number: 38393429
2025-07-23 18:26:21,316 - test_etl - INFO - Successfully inserted 6 out of 6 test patients with different document types
2025-07-23 18:26:21,317 - test_etl - INFO - Testing ETL process with the repository-transformer architecture...
2025-07-23 18:26:21,385 - test_etl - INFO - Processing 10 patients through ETL
2025-07-23 18:26:21,419 - test_etl - INFO - ETL processed 10 patients successfully
2025-07-23 18:26:21,419 - test_etl - INFO - ETL process test successful
2025-07-23 18:26:21,424 - test_etl - INFO - 
YottaDB basic connectivity test passed.
2025-07-23 18:27:38,865 - test_etl - INFO - Skipping YottaDB full fetch test
2025-07-23 18:27:38,866 - test_etl - INFO - 
Test Results Summary:
2025-07-23 18:27:38,866 - test_etl - INFO - PostgreSQL Connection: ✓
2025-07-23 18:27:38,866 - test_etl - INFO - Firebird Connection: ✓
2025-07-23 18:27:38,867 - test_etl - INFO - YottaDB Basic Connection: ✓
2025-07-23 18:27:38,867 - test_etl - INFO - PostgreSQL Schema: ✓
2025-07-23 18:27:38,867 - test_etl - INFO - Document Type Handling: ✓
2025-07-23 18:27:38,867 - test_etl - INFO - ETL Process: ✓
2025-07-23 18:27:38,867 - test_etl - INFO - 
Tests completed.
2025-07-23 18:34:58,975 - test_etl - INFO - Starting tests...
2025-07-23 18:34:58,975 - test_etl - INFO - Testing PostgreSQL connection...
2025-07-23 18:34:58,992 - test_etl - INFO - PostgreSQL connection successful
2025-07-23 18:34:58,993 - test_etl - INFO - PostgreSQL version: PostgreSQL 15.13 (Debian 15.13-0+deb12u1) on x86_64-pc-linux-gnu, compiled by gcc (Debian 12.2.0-14+deb12u1) 12.2.0, 64-bit
2025-07-23 18:34:58,994 - test_etl - INFO - Testing Firebird connection...
2025-07-23 18:34:58,994 - test_etl - INFO - Firebird config: {'host': '192.168.160.168', 'port': 3050, 'database': '099-1', 'user': 'SYSDBA', 'password': 'masterkey', 'charset': 'UTF-8', 'debug': False}
2025-07-23 18:34:59,054 - test_etl - INFO - Firebird connection successful
2025-07-23 18:34:59,058 - test_etl - INFO - Firebird current time: 2025-07-23 18:34:59.060000
2025-07-23 18:34:59,069 - test_etl - INFO - Retrieved 3 patients from Firebird through repository
2025-07-23 18:34:59,069 - test_etl - INFO - Patient 1: Проверочный Иван
2025-07-23 18:34:59,069 - test_etl - INFO - Patient 2: Проверочныйюр Наличный
2025-07-23 18:34:59,072 - test_etl - INFO - Testing YottaDB connection...
2025-07-23 18:34:59,072 - test_etl - INFO - WARNING: This test will take 2-3 minutes due to YottaDB API response time
2025-07-23 18:34:59,081 - test_etl - INFO - YottaDB basic connection test successful
2025-07-23 18:34:59,081 - test_etl - INFO - Testing YottaDB repository with small batch...
2025-07-23 18:37:02,465 - test_etl - INFO - Retrieved 2 patients from YottaDB
2025-07-23 18:37:02,465 - test_etl - INFO - Patient 1: Кузнецов Степан (ID: 1)
2025-07-23 18:37:02,465 - test_etl - INFO - Patient 2: Дахиева Фариза (ID: 1)
2025-07-23 18:37:02,584 - test_etl - INFO - Testing PostgreSQL schema...
2025-07-23 18:37:02,609 - test_etl - INFO - All essential tables exist
2025-07-23 18:37:02,611 - test_etl - INFO - Found 2 HIS systems in hislist table
2025-07-23 18:37:02,611 - test_etl - INFO -   hislist entry: (1, 'qMS')
2025-07-23 18:37:02,612 - test_etl - INFO -   hislist entry: (2, 'Инфоклиника')
2025-07-23 18:37:02,613 - test_etl - INFO - Found 3 business units in businessunits table
2025-07-23 18:37:02,613 - test_etl - INFO -   businessunits entry: (1, 'ОО ФК "Хадасса Медикал ЛТД"')
2025-07-23 18:37:02,613 - test_etl - INFO -   businessunits entry: (2, 'ООО "Медскан"')
2025-07-23 18:37:02,614 - test_etl - INFO -   businessunits entry: (3, 'ООО "Клинический госпиталь на Яузе"')
2025-07-23 18:37:02,614 - test_etl - INFO - Found 17 document types in documenttypes table
2025-07-23 18:37:02,615 - test_etl - INFO -   documenttypes entry: (1, 'Паспорт')
2025-07-23 18:37:02,615 - test_etl - INFO -   documenttypes entry: (2, 'Паспорт СССР')
2025-07-23 18:37:02,615 - test_etl - INFO -   documenttypes entry: (3, 'Заграничный паспорт РФ')
2025-07-23 18:37:02,615 - test_etl - INFO -   documenttypes entry: (4, 'Заграничный паспорт СССР')
2025-07-23 18:37:02,615 - test_etl - INFO -   documenttypes entry: (5, 'Свидетельство о рождении')
2025-07-23 18:37:02,615 - test_etl - INFO - Testing document type handling...
2025-07-23 18:37:02,638 - test_etl - INFO - Inserted patient with Паспорт (ID: 1), number: 1538725726
2025-07-23 18:37:02,640 - test_etl - INFO - Inserted patient with Заграничный паспорт РФ (ID: 3), number: 317518094
2025-07-23 18:37:02,642 - test_etl - INFO - Inserted patient with Свидетельство о рождении (ID: 5), number: 632781851567
2025-07-23 18:37:02,643 - test_etl - INFO - Inserted patient with Иностранный паспорт (ID: 10), number: 766504077
2025-07-23 18:37:02,646 - test_etl - INFO - Inserted patient with Временное удостоверение (ID: 14), number: 63532146
2025-07-23 18:37:02,648 - test_etl - INFO - Inserted patient with Иные документы (ID: 17), number: 50604928
2025-07-23 18:37:02,649 - test_etl - INFO - Successfully inserted 6 out of 6 test patients with different document types
2025-07-23 18:37:02,649 - test_etl - INFO - Testing ETL process with the repository-transformer architecture...
2025-07-23 18:37:02,750 - test_etl - INFO - Processing 10 patients through ETL
2025-07-23 18:37:02,788 - test_etl - INFO - ETL processed 10 patients successfully
2025-07-23 18:37:02,788 - test_etl - INFO - ETL process test successful
2025-07-23 18:37:02,793 - test_etl - INFO - 
YottaDB basic connectivity test passed.
2025-07-23 18:37:11,002 - test_etl - INFO - Testing YottaDB full data fetch...
2025-07-23 18:37:11,003 - test_etl - INFO - WARNING: This will take 2-3 minutes!
2025-07-23 18:39:19,752 - test_etl - INFO - YottaDB full fetch returned 409963 patients
2025-07-23 18:39:19,752 - test_etl - INFO - Sample patient 1: Махова Анна (ID: 5)
2025-07-23 18:39:19,752 - test_etl - INFO - Sample patient 2: Егорова Ольга (ID: 7)
2025-07-23 18:39:19,752 - test_etl - INFO - Sample patient 3: Родин Александр (ID: 8)
2025-07-23 18:39:19,863 - test_etl - INFO - 
Test Results Summary:
2025-07-23 18:39:19,863 - test_etl - INFO - PostgreSQL Connection: ✓
2025-07-23 18:39:19,863 - test_etl - INFO - Firebird Connection: ✓
2025-07-23 18:39:19,863 - test_etl - INFO - YottaDB Basic Connection: ✓
2025-07-23 18:39:19,863 - test_etl - INFO - YottaDB Full Fetch: ✓
2025-07-23 18:39:19,863 - test_etl - INFO - PostgreSQL Schema: ✓
2025-07-23 18:39:19,863 - test_etl - INFO - Document Type Handling: ✓
2025-07-23 18:39:19,863 - test_etl - INFO - ETL Process: ✓
2025-07-23 18:39:19,863 - test_etl - INFO - 
Tests completed.
2025-07-23 18:43:39,420 - test_etl - INFO - Starting tests...
2025-07-23 18:43:39,421 - test_etl - INFO - Testing PostgreSQL connection...
2025-07-23 18:43:39,437 - test_etl - INFO - PostgreSQL connection successful
2025-07-23 18:43:39,438 - test_etl - INFO - PostgreSQL version: PostgreSQL 15.13 (Debian 15.13-0+deb12u1) on x86_64-pc-linux-gnu, compiled by gcc (Debian 12.2.0-14+deb12u1) 12.2.0, 64-bit
2025-07-23 18:43:39,438 - test_etl - INFO - Testing Firebird connection...
2025-07-23 18:43:39,438 - test_etl - INFO - Firebird config: {'host': '192.168.160.168', 'port': 3050, 'database': '099-1', 'user': 'SYSDBA', 'password': 'masterkey', 'charset': 'UTF-8', 'debug': False}
2025-07-23 18:43:39,499 - test_etl - INFO - Firebird connection successful
2025-07-23 18:43:39,503 - test_etl - INFO - Firebird current time: 2025-07-23 18:43:39.503000
2025-07-23 18:43:39,512 - test_etl - INFO - Retrieved 3 patients from Firebird through repository
2025-07-23 18:43:39,513 - test_etl - INFO - Patient 1: Проверочный Иван
2025-07-23 18:43:39,513 - test_etl - INFO - Patient 2: Проверочныйюр Наличный
2025-07-23 18:43:39,516 - test_etl - INFO - Testing YottaDB connection...
2025-07-23 18:43:39,526 - test_etl - INFO - YottaDB connectivity test successful
2025-07-23 18:43:39,526 - test_etl - INFO - Testing PostgreSQL schema...
2025-07-23 18:43:39,558 - test_etl - INFO - All essential tables exist
2025-07-23 18:43:39,559 - test_etl - INFO - Found 2 HIS systems in hislist table
2025-07-23 18:43:39,559 - test_etl - INFO -   hislist entry: (1, 'qMS')
2025-07-23 18:43:39,560 - test_etl - INFO -   hislist entry: (2, 'Инфоклиника')
2025-07-23 18:43:39,560 - test_etl - INFO - Found 3 business units in businessunits table
2025-07-23 18:43:39,560 - test_etl - INFO -   businessunits entry: (1, 'ОО ФК "Хадасса Медикал ЛТД"')
2025-07-23 18:43:39,561 - test_etl - INFO -   businessunits entry: (2, 'ООО "Медскан"')
2025-07-23 18:43:39,561 - test_etl - INFO -   businessunits entry: (3, 'ООО "Клинический госпиталь на Яузе"')
2025-07-23 18:43:39,561 - test_etl - INFO - Found 17 document types in documenttypes table
2025-07-23 18:43:39,562 - test_etl - INFO -   documenttypes entry: (1, 'Паспорт')
2025-07-23 18:43:39,562 - test_etl - INFO -   documenttypes entry: (2, 'Паспорт СССР')
2025-07-23 18:43:39,562 - test_etl - INFO -   documenttypes entry: (3, 'Заграничный паспорт РФ')
2025-07-23 18:43:39,562 - test_etl - INFO -   documenttypes entry: (4, 'Заграничный паспорт СССР')
2025-07-23 18:43:39,562 - test_etl - INFO -   documenttypes entry: (5, 'Свидетельство о рождении')
2025-07-23 18:43:39,562 - test_etl - INFO - Testing document type handling...
2025-07-23 18:43:39,603 - test_etl - INFO - Inserted patient with Паспорт (ID: 1), number: 1130314449
2025-07-23 18:43:39,604 - test_etl - INFO - Inserted patient with Заграничный паспорт РФ (ID: 3), number: 991447119
2025-07-23 18:43:39,606 - test_etl - INFO - Inserted patient with Свидетельство о рождении (ID: 5), number: 764701744358
2025-07-23 18:43:39,607 - test_etl - INFO - Inserted patient with Иностранный паспорт (ID: 10), number: 480124624
2025-07-23 18:43:39,608 - test_etl - INFO - Inserted patient with Временное удостоверение (ID: 14), number: 98114952
2025-07-23 18:43:39,610 - test_etl - INFO - Inserted patient with Иные документы (ID: 17), number: 14490912
2025-07-23 18:43:39,610 - test_etl - INFO - Successfully inserted 6 out of 6 test patients with different document types
2025-07-23 18:43:39,610 - test_etl - INFO - Testing Firebird ETL process...
2025-07-23 18:43:39,698 - test_etl - INFO - Processing 10 patients through Firebird ETL
2025-07-23 18:43:39,738 - test_etl - INFO - Firebird ETL processed 0 patients successfully
2025-07-23 18:43:39,739 - test_etl - WARNING - Firebird ETL process test completed but no records were processed
2025-07-23 18:43:39,743 - test_etl - INFO - Testing YottaDB ETL process...
2025-07-23 18:43:39,743 - test_etl - INFO - WARNING: This will fetch all data from YottaDB API (takes 2-3 minutes)
2025-07-23 18:43:43,104 - test_etl - INFO - YottaDB ETL test skipped by user
2025-07-23 18:43:43,105 - test_etl - INFO - 
Test Results Summary:
2025-07-23 18:43:43,105 - test_etl - INFO - PostgreSQL Connection: ✓
2025-07-23 18:43:43,105 - test_etl - INFO - Firebird Connection: ✓
2025-07-23 18:43:43,106 - test_etl - INFO - YottaDB Connection: ✓
2025-07-23 18:43:43,106 - test_etl - INFO - PostgreSQL Schema: ✓
2025-07-23 18:43:43,106 - test_etl - INFO - Document Type Handling: ✓
2025-07-23 18:43:43,106 - test_etl - INFO - Firebird ETL Process: ✗
2025-07-23 18:43:43,106 - test_etl - INFO - YottaDB ETL Process: Skipped
2025-07-23 18:43:43,107 - test_etl - INFO - 
Tests completed.
2025-07-23 18:43:54,651 - test_etl - INFO - Starting tests...
2025-07-23 18:43:54,651 - test_etl - INFO - Testing PostgreSQL connection...
2025-07-23 18:43:54,669 - test_etl - INFO - PostgreSQL connection successful
2025-07-23 18:43:54,671 - test_etl - INFO - PostgreSQL version: PostgreSQL 15.13 (Debian 15.13-0+deb12u1) on x86_64-pc-linux-gnu, compiled by gcc (Debian 12.2.0-14+deb12u1) 12.2.0, 64-bit
2025-07-23 18:43:54,672 - test_etl - INFO - Testing Firebird connection...
2025-07-23 18:43:54,673 - test_etl - INFO - Firebird config: {'host': '192.168.160.168', 'port': 3050, 'database': '099-1', 'user': 'SYSDBA', 'password': 'masterkey', 'charset': 'UTF-8', 'debug': False}
2025-07-23 18:43:54,737 - test_etl - INFO - Firebird connection successful
2025-07-23 18:43:54,741 - test_etl - INFO - Firebird current time: 2025-07-23 18:43:54.738000
2025-07-23 18:43:54,750 - test_etl - INFO - Retrieved 3 patients from Firebird through repository
2025-07-23 18:43:54,750 - test_etl - INFO - Patient 1: Проверочный Иван
2025-07-23 18:43:54,750 - test_etl - INFO - Patient 2: Проверочныйюр Наличный
2025-07-23 18:43:54,754 - test_etl - INFO - Testing YottaDB connection...
2025-07-23 18:43:54,763 - test_etl - INFO - YottaDB connectivity test successful
2025-07-23 18:43:54,763 - test_etl - INFO - Testing PostgreSQL schema...
2025-07-23 18:43:54,786 - test_etl - INFO - All essential tables exist
2025-07-23 18:43:54,788 - test_etl - INFO - Found 2 HIS systems in hislist table
2025-07-23 18:43:54,789 - test_etl - INFO -   hislist entry: (1, 'qMS')
2025-07-23 18:43:54,789 - test_etl - INFO -   hislist entry: (2, 'Инфоклиника')
2025-07-23 18:43:54,790 - test_etl - INFO - Found 3 business units in businessunits table
2025-07-23 18:43:54,790 - test_etl - INFO -   businessunits entry: (1, 'ОО ФК "Хадасса Медикал ЛТД"')
2025-07-23 18:43:54,791 - test_etl - INFO -   businessunits entry: (2, 'ООО "Медскан"')
2025-07-23 18:43:54,791 - test_etl - INFO -   businessunits entry: (3, 'ООО "Клинический госпиталь на Яузе"')
2025-07-23 18:43:54,792 - test_etl - INFO - Found 17 document types in documenttypes table
2025-07-23 18:43:54,793 - test_etl - INFO -   documenttypes entry: (1, 'Паспорт')
2025-07-23 18:43:54,793 - test_etl - INFO -   documenttypes entry: (2, 'Паспорт СССР')
2025-07-23 18:43:54,793 - test_etl - INFO -   documenttypes entry: (3, 'Заграничный паспорт РФ')
2025-07-23 18:43:54,793 - test_etl - INFO -   documenttypes entry: (4, 'Заграничный паспорт СССР')
2025-07-23 18:43:54,793 - test_etl - INFO -   documenttypes entry: (5, 'Свидетельство о рождении')
2025-07-23 18:43:54,794 - test_etl - INFO - Testing document type handling...
2025-07-23 18:43:54,827 - test_etl - INFO - Inserted patient with Паспорт (ID: 1), number: 7259658610
2025-07-23 18:43:54,829 - test_etl - INFO - Inserted patient with Заграничный паспорт РФ (ID: 3), number: 567523328
2025-07-23 18:43:54,831 - test_etl - INFO - Inserted patient with Свидетельство о рождении (ID: 5), number: 195042558414
2025-07-23 18:43:54,833 - test_etl - INFO - Inserted patient with Иностранный паспорт (ID: 10), number: 136140709
2025-07-23 18:43:54,835 - test_etl - INFO - Inserted patient with Временное удостоверение (ID: 14), number: 29254401
2025-07-23 18:43:54,836 - test_etl - INFO - Inserted patient with Иные документы (ID: 17), number: 16570564
2025-07-23 18:43:54,837 - test_etl - INFO - Successfully inserted 6 out of 6 test patients with different document types
2025-07-23 18:43:54,837 - test_etl - INFO - Testing Firebird ETL process...
2025-07-23 18:43:54,891 - test_etl - INFO - Processing 10 patients through Firebird ETL
2025-07-23 18:43:54,936 - test_etl - INFO - Firebird ETL processed 10 patients successfully
2025-07-23 18:43:54,937 - test_etl - INFO - Firebird ETL process test successful
2025-07-23 18:43:54,941 - test_etl - INFO - Testing YottaDB ETL process...
2025-07-23 18:43:54,941 - test_etl - INFO - WARNING: This will fetch all data from YottaDB API (takes 2-3 minutes)
2025-07-23 18:44:05,007 - test_etl - INFO - Fetching all patients from YottaDB API...
2025-07-23 18:46:10,632 - test_etl - INFO - Retrieved 409963 patients from YottaDB
2025-07-23 18:46:10,632 - test_etl - INFO - Testing ETL process with 10 random patients...
2025-07-23 18:46:10,632 - test_etl - INFO - Processing patient 1/10: Голомедова Анна (ID: 41449)
2025-07-23 18:46:10,635 - test_etl - ERROR -   ✗ Failed to insert patient 41449
2025-07-23 18:46:10,635 - test_etl - INFO - Processing patient 2/10: Иванова Раиса (ID: 3732)
2025-07-23 18:46:10,636 - test_etl - ERROR -   ✗ Failed to insert patient 3732
2025-07-23 18:46:10,636 - test_etl - INFO - Processing patient 3/10: Федоров Константин (ID: 76636)
2025-07-23 18:46:10,638 - test_etl - ERROR -   ✗ Failed to insert patient 76636
2025-07-23 18:46:10,638 - test_etl - INFO - Processing patient 4/10: Ляшкевич Светлана (ID: 40740)
2025-07-23 18:46:10,639 - test_etl - ERROR -   ✗ Failed to insert patient 40740
2025-07-23 18:46:10,639 - test_etl - INFO - Processing patient 5/10: Мамаева Елена (ID: 100242)
2025-07-23 18:46:10,640 - test_etl - ERROR -   ✗ Failed to insert patient 100242
2025-07-23 18:46:10,640 - test_etl - INFO - Processing patient 6/10: Бычуткин Денис (ID: 175215)
2025-07-23 18:46:10,641 - test_etl - ERROR -   ✗ Failed to insert patient 175215
2025-07-23 18:46:10,641 - test_etl - INFO - Processing patient 7/10: Шерстюк Наталья (ID: 138118)
2025-07-23 18:46:10,642 - test_etl - ERROR -   ✗ Failed to insert patient 138118
2025-07-23 18:46:10,642 - test_etl - INFO - Processing patient 8/10: Пожарский Дмитрий (ID: 158064)
2025-07-23 18:46:10,643 - test_etl - ERROR -   ✗ Failed to insert patient 158064
2025-07-23 18:46:10,643 - test_etl - INFO - Processing patient 9/10: Чепина Полина (ID: 50374)
2025-07-23 18:46:10,644 - test_etl - ERROR -   ✗ Failed to insert patient 50374
2025-07-23 18:46:10,645 - test_etl - INFO - Processing patient 10/10: Еремина Виктория (ID: 14267)
2025-07-23 18:46:10,646 - test_etl - ERROR -   ✗ Failed to insert patient 14267
2025-07-23 18:46:10,646 - test_etl - INFO - YottaDB ETL test completed: 0 successful, 10 errors
2025-07-23 18:46:10,646 - test_etl - INFO - Total patients in YottaDB: 409963
2025-07-23 18:46:10,646 - test_etl - INFO - Test batch processed: 10
2025-07-23 18:46:10,646 - test_etl - INFO - Success rate: 0.0%
2025-07-23 18:46:10,755 - test_etl - INFO - 
Test Results Summary:
2025-07-23 18:46:10,755 - test_etl - INFO - PostgreSQL Connection: ✓
2025-07-23 18:46:10,755 - test_etl - INFO - Firebird Connection: ✓
2025-07-23 18:46:10,755 - test_etl - INFO - YottaDB Connection: ✓
2025-07-23 18:46:10,755 - test_etl - INFO - PostgreSQL Schema: ✓
2025-07-23 18:46:10,756 - test_etl - INFO - Document Type Handling: ✓
2025-07-23 18:46:10,756 - test_etl - INFO - Firebird ETL Process: ✓
2025-07-23 18:46:10,756 - test_etl - INFO - YottaDB ETL Process: ✗
2025-07-23 18:46:10,756 - test_etl - INFO - 
Tests completed.
2025-07-23 19:11:52,212 - test_etl - INFO - Starting tests...
2025-07-23 19:11:52,212 - test_etl - INFO - Testing PostgreSQL connection...
2025-07-23 19:11:52,233 - test_etl - INFO - PostgreSQL connection successful
2025-07-23 19:11:52,235 - test_etl - INFO - PostgreSQL version: PostgreSQL 15.13 (Debian 15.13-0+deb12u1) on x86_64-pc-linux-gnu, compiled by gcc (Debian 12.2.0-14+deb12u1) 12.2.0, 64-bit
2025-07-23 19:11:52,235 - test_etl - INFO - Testing Firebird connection...
2025-07-23 19:11:52,235 - test_etl - INFO - Firebird config: {'host': '192.168.160.168', 'port': 3050, 'database': '099-1', 'user': 'SYSDBA', 'password': 'masterkey', 'charset': 'UTF-8', 'debug': False}
2025-07-23 19:11:52,303 - test_etl - INFO - Firebird connection successful
2025-07-23 19:11:52,308 - test_etl - INFO - Firebird current time: 2025-07-23 19:11:52.309000
2025-07-23 19:11:52,320 - test_etl - INFO - Retrieved 3 patients from Firebird through repository
2025-07-23 19:11:52,320 - test_etl - INFO - Patient 1: Проверочный Иван
2025-07-23 19:11:52,320 - test_etl - INFO - Patient 2: Проверочныйюр Наличный
2025-07-23 19:11:52,325 - test_etl - INFO - Testing YottaDB connection...
2025-07-23 19:11:52,334 - test_etl - INFO - YottaDB connectivity test successful
2025-07-23 19:11:52,334 - test_etl - INFO - Testing PostgreSQL schema...
2025-07-23 19:11:52,374 - test_etl - INFO - All essential tables exist
2025-07-23 19:11:52,375 - test_etl - INFO - Found 2 HIS systems in hislist table
2025-07-23 19:11:52,375 - test_etl - INFO -   hislist entry: (1, 'qMS')
2025-07-23 19:11:52,375 - test_etl - INFO -   hislist entry: (2, 'Инфоклиника')
2025-07-23 19:11:52,376 - test_etl - INFO - Found 3 business units in businessunits table
2025-07-23 19:11:52,376 - test_etl - INFO -   businessunits entry: (1, 'ОО ФК "Хадасса Медикал ЛТД"')
2025-07-23 19:11:52,377 - test_etl - INFO -   businessunits entry: (2, 'ООО "Медскан"')
2025-07-23 19:11:52,377 - test_etl - INFO -   businessunits entry: (3, 'ООО "Клинический госпиталь на Яузе"')
2025-07-23 19:11:52,377 - test_etl - INFO - Found 17 document types in documenttypes table
2025-07-23 19:11:52,378 - test_etl - INFO -   documenttypes entry: (1, 'Паспорт')
2025-07-23 19:11:52,378 - test_etl - INFO -   documenttypes entry: (2, 'Паспорт СССР')
2025-07-23 19:11:52,378 - test_etl - INFO -   documenttypes entry: (3, 'Заграничный паспорт РФ')
2025-07-23 19:11:52,378 - test_etl - INFO -   documenttypes entry: (4, 'Заграничный паспорт СССР')
2025-07-23 19:11:52,378 - test_etl - INFO -   documenttypes entry: (5, 'Свидетельство о рождении')
2025-07-23 19:11:52,378 - test_etl - INFO - Testing document type handling...
2025-07-23 19:11:52,411 - test_etl - INFO - Inserted patient with Паспорт (ID: 1), number: 3320916740
2025-07-23 19:11:52,413 - test_etl - INFO - Inserted patient with Заграничный паспорт РФ (ID: 3), number: 709154165
2025-07-23 19:11:52,415 - test_etl - INFO - Inserted patient with Свидетельство о рождении (ID: 5), number: 719575516708
2025-07-23 19:11:52,416 - test_etl - INFO - Inserted patient with Иностранный паспорт (ID: 10), number: 515149077
2025-07-23 19:11:52,418 - test_etl - INFO - Inserted patient with Временное удостоверение (ID: 14), number: 45823444
2025-07-23 19:11:52,419 - test_etl - INFO - Inserted patient with Иные документы (ID: 17), number: 14135226
2025-07-23 19:11:52,419 - test_etl - INFO - Successfully inserted 6 out of 6 test patients with different document types
2025-07-23 19:11:52,419 - test_etl - INFO - Testing Firebird ETL process...
2025-07-23 19:11:52,471 - test_etl - INFO - Processing 10 patients through Firebird ETL
2025-07-23 19:11:52,518 - test_etl - INFO - Firebird ETL processed 10 patients successfully
2025-07-23 19:11:52,518 - test_etl - INFO - Firebird ETL process test successful
2025-07-23 19:11:52,525 - test_etl - INFO - Testing YottaDB ETL process...
2025-07-23 19:11:52,525 - test_etl - INFO - WARNING: This will fetch all data from YottaDB API (takes 2-3 minutes)
2025-07-23 19:11:53,459 - test_etl - INFO - Fetching all patients from YottaDB API...
2025-07-23 19:14:01,636 - test_etl - INFO - Retrieved 409987 patients from YottaDB
2025-07-23 19:14:01,636 - test_etl - INFO - Testing ETL process with 10 random patients...
2025-07-23 19:14:01,636 - test_etl - INFO - Processing patient 1/10: Качай Алексей (ID: 173959/A21)
2025-07-23 19:14:01,652 - test_etl - INFO -   ✓ Patient 173959/A21 inserted successfully
2025-07-23 19:14:01,652 - test_etl - INFO - Processing patient 2/10: Внучкова Оксана (ID: 17171/A25)
2025-07-23 19:14:01,654 - test_etl - INFO -   ✓ Patient 17171/A25 inserted successfully
2025-07-23 19:14:01,654 - test_etl - INFO - Processing patient 3/10: Ушаков Кирилл (ID: 119065/A21)
2025-07-23 19:14:01,656 - test_etl - INFO -   ✓ Patient 119065/A21 inserted successfully
2025-07-23 19:14:01,656 - test_etl - INFO - Processing patient 4/10: Куропятников Валерий (ID: 4585/A23)
2025-07-23 19:14:01,658 - test_etl - INFO -   ✓ Patient 4585/A23 inserted successfully
2025-07-23 19:14:01,658 - test_etl - INFO - Processing patient 5/10: Гурков Юрий (ID: 156323/A21)
2025-07-23 19:14:01,659 - test_etl - INFO -   ✓ Patient 156323/A21 inserted successfully
2025-07-23 19:14:01,660 - test_etl - INFO - Processing patient 6/10: Иванов Павел (ID: 25544/A23)
2025-07-23 19:14:01,662 - test_etl - INFO -   ✓ Patient 25544/A23 inserted successfully
2025-07-23 19:14:01,662 - test_etl - INFO - Processing patient 7/10: Зайцева Полина (ID: 4471/A25)
2025-07-23 19:14:01,663 - test_etl - INFO -   ✓ Patient 4471/A25 inserted successfully
2025-07-23 19:14:01,663 - test_etl - INFO - Processing patient 8/10: Полторак Артем (ID: 24026/A22)
2025-07-23 19:14:01,665 - test_etl - INFO -   ✓ Patient 24026/A22 inserted successfully
2025-07-23 19:14:01,665 - test_etl - INFO - Processing patient 9/10: Будаева Дарья (ID: 25128/A25)
2025-07-23 19:14:01,666 - test_etl - INFO -   ✓ Patient 25128/A25 inserted successfully
2025-07-23 19:14:01,666 - test_etl - INFO - Processing patient 10/10: Мугина Ульяна (ID: 191105/A21)
2025-07-23 19:14:01,667 - test_etl - INFO -   ✓ Patient 191105/A21 inserted successfully
2025-07-23 19:14:01,668 - test_etl - INFO - YottaDB ETL test completed: 10 successful, 0 errors
2025-07-23 19:14:01,668 - test_etl - INFO - Total patients in YottaDB: 409987
2025-07-23 19:14:01,668 - test_etl - INFO - Test batch processed: 10
2025-07-23 19:14:01,668 - test_etl - INFO - Success rate: 100.0%
2025-07-23 19:14:01,785 - test_etl - INFO - 
Test Results Summary:
2025-07-23 19:14:01,785 - test_etl - INFO - PostgreSQL Connection: ✓
2025-07-23 19:14:01,785 - test_etl - INFO - Firebird Connection: ✓
2025-07-23 19:14:01,786 - test_etl - INFO - YottaDB Connection: ✓
2025-07-23 19:14:01,786 - test_etl - INFO - PostgreSQL Schema: ✓
2025-07-23 19:14:01,786 - test_etl - INFO - Document Type Handling: ✓
2025-07-23 19:14:01,786 - test_etl - INFO - Firebird ETL Process: ✓
2025-07-23 19:14:01,786 - test_etl - INFO - YottaDB ETL Process: ✓
2025-07-23 19:14:01,786 - test_etl - INFO - 
Tests completed.
2025-07-23 19:21:00,519 - test_etl - INFO - Starting tests...
2025-07-23 19:21:00,519 - test_etl - INFO - Testing PostgreSQL connection...
2025-07-23 19:21:00,537 - test_etl - INFO - PostgreSQL connection successful
2025-07-23 19:21:00,538 - test_etl - INFO - PostgreSQL version: PostgreSQL 15.13 (Debian 15.13-0+deb12u1) on x86_64-pc-linux-gnu, compiled by gcc (Debian 12.2.0-14+deb12u1) 12.2.0, 64-bit
2025-07-23 19:21:00,539 - test_etl - INFO - Testing Firebird connection...
2025-07-23 19:21:00,539 - test_etl - INFO - Firebird config: {'host': '192.168.160.168', 'port': 3050, 'database': '099-1', 'user': 'SYSDBA', 'password': 'masterkey', 'charset': 'UTF-8', 'debug': False}
2025-07-23 19:21:00,591 - test_etl - INFO - Firebird connection successful
2025-07-23 19:21:00,595 - test_etl - INFO - Firebird current time: 2025-07-23 19:21:00.588000
2025-07-23 19:21:00,607 - test_etl - INFO - Retrieved 3 patients from Firebird through repository
2025-07-23 19:21:00,607 - test_etl - INFO - Patient 1: Проверочный Иван
2025-07-23 19:21:00,608 - test_etl - INFO - Patient 2: Проверочныйюр Наличный
2025-07-23 19:21:00,613 - test_etl - INFO - Testing YottaDB connection...
2025-07-23 19:21:00,625 - test_etl - INFO - YottaDB connectivity test successful
2025-07-23 19:21:00,625 - test_etl - INFO - Testing PostgreSQL schema...
2025-07-23 19:21:00,667 - test_etl - INFO - All essential tables exist
2025-07-23 19:21:00,668 - test_etl - INFO - Found 2 HIS systems in hislist table
2025-07-23 19:21:00,668 - test_etl - INFO -   hislist entry: (1, 'qMS')
2025-07-23 19:21:00,668 - test_etl - INFO -   hislist entry: (2, 'Инфоклиника')
2025-07-23 19:21:00,669 - test_etl - INFO - Found 3 business units in businessunits table
2025-07-23 19:21:00,669 - test_etl - INFO -   businessunits entry: (1, 'ОО ФК "Хадасса Медикал ЛТД"')
2025-07-23 19:21:00,669 - test_etl - INFO -   businessunits entry: (2, 'ООО "Медскан"')
2025-07-23 19:21:00,669 - test_etl - INFO -   businessunits entry: (3, 'ООО "Клинический госпиталь на Яузе"')
2025-07-23 19:21:00,670 - test_etl - INFO - Found 17 document types in documenttypes table
2025-07-23 19:21:00,670 - test_etl - INFO -   documenttypes entry: (1, 'Паспорт')
2025-07-23 19:21:00,670 - test_etl - INFO -   documenttypes entry: (2, 'Паспорт СССР')
2025-07-23 19:21:00,670 - test_etl - INFO -   documenttypes entry: (3, 'Заграничный паспорт РФ')
2025-07-23 19:21:00,670 - test_etl - INFO -   documenttypes entry: (4, 'Заграничный паспорт СССР')
2025-07-23 19:21:00,670 - test_etl - INFO -   documenttypes entry: (5, 'Свидетельство о рождении')
2025-07-23 19:21:00,671 - test_etl - INFO - Testing document type handling...
2025-07-23 19:21:00,695 - test_etl - INFO - Inserted qMS patient with Паспорт (ID: 1), number: 9689688783
2025-07-23 19:21:00,697 - test_etl - INFO - Inserted Инфоклиника patient with Паспорт (ID: 1), number: 6717818261
2025-07-23 19:21:00,699 - test_etl - INFO - Inserted qMS patient with Заграничный паспорт РФ (ID: 3), number: 753887570
2025-07-23 19:21:00,700 - test_etl - INFO - Inserted Инфоклиника patient with Заграничный паспорт РФ (ID: 3), number: 868252034
2025-07-23 19:21:00,703 - test_etl - INFO - Inserted qMS patient with Свидетельство о рождении (ID: 5), number: 163795197808
2025-07-23 19:21:00,704 - test_etl - INFO - Inserted Инфоклиника patient with Свидетельство о рождении (ID: 5), number: 769034623815
2025-07-23 19:21:00,706 - test_etl - INFO - Inserted qMS patient with Иностранный паспорт (ID: 10), number: 876612192
2025-07-23 19:21:00,707 - test_etl - INFO - Inserted Инфоклиника patient with Иностранный паспорт (ID: 10), number: 810933001
2025-07-23 19:21:00,709 - test_etl - INFO - Inserted qMS patient with Временное удостоверение (ID: 14), number: 45450873
2025-07-23 19:21:00,710 - test_etl - INFO - Inserted Инфоклиника patient with Временное удостоверение (ID: 14), number: 27395943
2025-07-23 19:21:00,712 - test_etl - INFO - Inserted qMS patient with Иные документы (ID: 17), number: 50920967
2025-07-23 19:21:00,713 - test_etl - INFO - Inserted Инфоклиника patient with Иные документы (ID: 17), number: 50084755
2025-07-23 19:21:00,714 - test_etl - INFO - Successfully inserted 12 out of 12 test patients with different document types
2025-07-23 19:21:00,714 - test_etl - INFO - Testing Firebird ETL process...
2025-07-23 19:21:00,805 - test_etl - INFO - Processing 10 patients through Firebird ETL
2025-07-23 19:21:00,842 - test_etl - INFO - Firebird ETL processed 0 patients successfully
2025-07-23 19:21:00,842 - test_etl - WARNING - Firebird ETL process test completed but no records were processed
2025-07-23 19:21:00,847 - test_etl - INFO - Testing YottaDB ETL process...
2025-07-23 19:21:00,847 - test_etl - INFO - WARNING: This will fetch all data from YottaDB API (takes 2-3 minutes)
2025-07-23 19:21:04,876 - test_etl - INFO - YottaDB ETL test skipped by user
2025-07-23 19:21:04,876 - test_etl - INFO - 
Test Results Summary:
2025-07-23 19:21:04,877 - test_etl - INFO - PostgreSQL Connection: ✓
2025-07-23 19:21:04,877 - test_etl - INFO - Firebird Connection: ✓
2025-07-23 19:21:04,877 - test_etl - INFO - YottaDB Connection: ✓
2025-07-23 19:21:04,877 - test_etl - INFO - PostgreSQL Schema: ✓
2025-07-23 19:21:04,878 - test_etl - INFO - Document Type Handling: ✓
2025-07-23 19:21:04,878 - test_etl - INFO - Firebird ETL Process: ✗
2025-07-23 19:21:04,878 - test_etl - INFO - YottaDB ETL Process: Skipped
2025-07-23 19:21:04,878 - test_etl - INFO - 
Tests completed.
2025-07-23 19:29:07,342 - test_etl - INFO - Starting tests...
2025-07-23 19:29:07,342 - test_etl - INFO - Testing PostgreSQL connection...
2025-07-23 19:29:07,359 - test_etl - INFO - PostgreSQL connection successful
2025-07-23 19:29:07,361 - test_etl - INFO - PostgreSQL version: PostgreSQL 15.13 (Debian 15.13-0+deb12u1) on x86_64-pc-linux-gnu, compiled by gcc (Debian 12.2.0-14+deb12u1) 12.2.0, 64-bit
2025-07-23 19:29:07,361 - test_etl - INFO - Testing Firebird connection...
2025-07-23 19:29:07,361 - test_etl - INFO - Firebird config: {'host': '192.168.160.168', 'port': 3050, 'database': '099-1', 'user': 'SYSDBA', 'password': 'masterkey', 'charset': 'UTF-8', 'debug': False}
2025-07-23 19:29:07,405 - test_etl - INFO - Firebird connection successful
2025-07-23 19:29:07,409 - test_etl - INFO - Firebird current time: 2025-07-23 19:29:07.393000
2025-07-23 19:29:07,422 - test_etl - INFO - Retrieved 3 patients from Firebird through repository
2025-07-23 19:29:07,422 - test_etl - INFO - Patient 1: Проверочный Иван
2025-07-23 19:29:07,423 - test_etl - INFO - Patient 2: Проверочныйюр Наличный
2025-07-23 19:29:07,435 - test_etl - INFO - Testing YottaDB connection...
2025-07-23 19:29:07,449 - test_etl - INFO - YottaDB connectivity test successful
2025-07-23 19:29:07,449 - test_etl - INFO - Testing PostgreSQL schema...
2025-07-23 19:29:07,480 - test_etl - INFO - All essential tables exist
2025-07-23 19:29:07,481 - test_etl - INFO - Found 2 HIS systems in hislist table
2025-07-23 19:29:07,482 - test_etl - INFO -   hislist entry: (1, 'qMS')
2025-07-23 19:29:07,482 - test_etl - INFO -   hislist entry: (2, 'Инфоклиника')
2025-07-23 19:29:07,482 - test_etl - INFO - Found 3 business units in businessunits table
2025-07-23 19:29:07,483 - test_etl - INFO -   businessunits entry: (1, 'ОО ФК "Хадасса Медикал ЛТД"')
2025-07-23 19:29:07,483 - test_etl - INFO -   businessunits entry: (2, 'ООО "Медскан"')
2025-07-23 19:29:07,483 - test_etl - INFO -   businessunits entry: (3, 'ООО "Клинический госпиталь на Яузе"')
2025-07-23 19:29:07,483 - test_etl - INFO - Found 17 document types in documenttypes table
2025-07-23 19:29:07,484 - test_etl - INFO -   documenttypes entry: (1, 'Паспорт')
2025-07-23 19:29:07,484 - test_etl - INFO -   documenttypes entry: (2, 'Паспорт СССР')
2025-07-23 19:29:07,484 - test_etl - INFO -   documenttypes entry: (3, 'Заграничный паспорт РФ')
2025-07-23 19:29:07,484 - test_etl - INFO -   documenttypes entry: (4, 'Заграничный паспорт СССР')
2025-07-23 19:29:07,484 - test_etl - INFO -   documenttypes entry: (5, 'Свидетельство о рождении')
2025-07-23 19:29:07,485 - test_etl - INFO - Testing document type handling...
2025-07-23 19:29:07,536 - test_etl - INFO - Inserted qMS patient with Паспорт (ID: 1), number: 6892629212
2025-07-23 19:29:07,539 - test_etl - INFO - Inserted Инфоклиника patient with Паспорт (ID: 1), number: 2952007651
2025-07-23 19:29:07,541 - test_etl - INFO - Inserted qMS patient with Заграничный паспорт РФ (ID: 3), number: 527072773
2025-07-23 19:29:07,542 - test_etl - INFO - Inserted Инфоклиника patient with Заграничный паспорт РФ (ID: 3), number: 184685621
2025-07-23 19:29:07,544 - test_etl - INFO - Inserted qMS patient with Свидетельство о рождении (ID: 5), number: 668372340281
2025-07-23 19:29:07,545 - test_etl - INFO - Inserted Инфоклиника patient with Свидетельство о рождении (ID: 5), number: 773143583317
2025-07-23 19:29:07,547 - test_etl - INFO - Inserted qMS patient with Иностранный паспорт (ID: 10), number: 444457484
2025-07-23 19:29:07,548 - test_etl - INFO - Inserted Инфоклиника patient with Иностранный паспорт (ID: 10), number: 315012859
2025-07-23 19:29:07,549 - test_etl - INFO - Inserted qMS patient with Временное удостоверение (ID: 14), number: 80945037
2025-07-23 19:29:07,550 - test_etl - INFO - Inserted Инфоклиника patient with Временное удостоверение (ID: 14), number: 86566851
2025-07-23 19:29:07,552 - test_etl - INFO - Inserted qMS patient with Иные документы (ID: 17), number: 57608726
2025-07-23 19:29:07,554 - test_etl - INFO - Inserted Инфоклиника patient with Иные документы (ID: 17), number: 49023602
2025-07-23 19:29:07,554 - test_etl - INFO - Successfully inserted 12 out of 12 test patients with different document types
2025-07-23 19:29:07,554 - test_etl - INFO - Testing Firebird ETL process...
2025-07-23 19:29:07,628 - test_etl - INFO - Processing 10 patients through Firebird ETL
2025-07-23 19:29:07,674 - test_etl - INFO - Firebird ETL processed 10 patients successfully
2025-07-23 19:29:07,674 - test_etl - INFO - Firebird ETL process test successful
2025-07-23 19:29:07,679 - test_etl - INFO - Testing YottaDB ETL process...
2025-07-23 19:29:07,679 - test_etl - INFO - WARNING: This will fetch all data from YottaDB API (takes 2-3 minutes)
2025-07-23 19:29:12,882 - test_etl - INFO - Fetching all patients from YottaDB API...
2025-07-23 19:31:18,422 - test_etl - INFO - Retrieved 409987 patients from YottaDB
2025-07-23 19:31:18,422 - test_etl - INFO - Testing ETL process with 10 random patients...
2025-07-23 19:31:18,422 - test_etl - INFO - Processing patient 1/10: Долматов Кирилл (ID: 24745/A25)
2025-07-23 19:31:18,432 - test_etl - INFO -   ✓ Patient 24745/A25 inserted successfully
2025-07-23 19:31:18,434 - test_etl - INFO - Processing patient 2/10: Величенков Виктор (ID: 147324/A21)
2025-07-23 19:31:18,440 - test_etl - INFO -   ✓ Patient 147324/A21 inserted successfully
2025-07-23 19:31:18,441 - test_etl - INFO - Processing patient 3/10: Бородина Елена (ID: 111710/A21)
2025-07-23 19:31:18,443 - test_etl - INFO -   ✓ Patient 111710/A21 inserted successfully
2025-07-23 19:31:18,444 - test_etl - INFO - Processing patient 4/10: Ярмонов Виктор (ID: 8786/A23)
2025-07-23 19:31:18,447 - test_etl - INFO -   ✓ Patient 8786/A23 inserted successfully
2025-07-23 19:31:18,447 - test_etl - INFO - Processing patient 5/10: Рощина Людмила (ID: 2031/A22)
2025-07-23 19:31:18,449 - test_etl - INFO -   ✓ Patient 2031/A22 inserted successfully
2025-07-23 19:31:18,449 - test_etl - INFO - Processing patient 6/10: Королёв Сергей (ID: 1744/A24)
2025-07-23 19:31:18,450 - test_etl - INFO -   ✓ Patient 1744/A24 inserted successfully
2025-07-23 19:31:18,451 - test_etl - INFO - Processing patient 7/10: Яковлев Михаил (ID: 15400/A25)
2025-07-23 19:31:18,452 - test_etl - INFO -   ✓ Patient 15400/A25 inserted successfully
2025-07-23 19:31:18,452 - test_etl - INFO - Processing patient 8/10: Двегубская Анастасия (ID: 38891/A23)
2025-07-23 19:31:18,454 - test_etl - INFO -   ✓ Patient 38891/A23 inserted successfully
2025-07-23 19:31:18,454 - test_etl - INFO - Processing patient 9/10: Гордич Анна (ID: 23132/A25)
2025-07-23 19:31:18,456 - test_etl - INFO -   ✓ Patient 23132/A25 inserted successfully
2025-07-23 19:31:18,456 - test_etl - INFO - Processing patient 10/10: Лопаткин Денис (ID: 138251/A21)
2025-07-23 19:31:18,457 - test_etl - INFO -   ✓ Patient 138251/A21 inserted successfully
2025-07-23 19:31:18,458 - test_etl - INFO - YottaDB ETL test completed: 10 successful, 0 errors
2025-07-23 19:31:18,458 - test_etl - INFO - Total patients in YottaDB: 409987
2025-07-23 19:31:18,458 - test_etl - INFO - Test batch processed: 10
2025-07-23 19:31:18,458 - test_etl - INFO - Success rate: 100.0%
2025-07-23 19:31:18,699 - test_etl - INFO - 
Test Results Summary:
2025-07-23 19:31:18,699 - test_etl - INFO - PostgreSQL Connection: ✓
2025-07-23 19:31:18,699 - test_etl - INFO - Firebird Connection: ✓
2025-07-23 19:31:18,699 - test_etl - INFO - YottaDB Connection: ✓
2025-07-23 19:31:18,699 - test_etl - INFO - PostgreSQL Schema: ✓
2025-07-23 19:31:18,699 - test_etl - INFO - Document Type Handling: ✓
2025-07-23 19:31:18,699 - test_etl - INFO - Firebird ETL Process: ✓
2025-07-23 19:31:18,699 - test_etl - INFO - YottaDB ETL Process: ✓
2025-07-23 19:31:18,700 - test_etl - INFO - 
Tests completed.
2025-07-23 19:46:43,795 - test_etl - INFO - Starting tests...
2025-07-23 19:46:43,795 - test_etl - INFO - Testing PostgreSQL connection...
2025-07-23 19:46:43,814 - test_etl - INFO - PostgreSQL connection successful
2025-07-23 19:46:43,816 - test_etl - INFO - PostgreSQL version: PostgreSQL 15.13 (Debian 15.13-0+deb12u1) on x86_64-pc-linux-gnu, compiled by gcc (Debian 12.2.0-14+deb12u1) 12.2.0, 64-bit
2025-07-23 19:46:43,816 - test_etl - INFO - Testing Firebird connection...
2025-07-23 19:46:43,816 - test_etl - INFO - Firebird config: {'host': '192.168.160.168', 'port': 3050, 'database': '099-1', 'user': 'SYSDBA', 'password': 'masterkey', 'charset': 'UTF-8', 'debug': False}
2025-07-23 19:46:43,867 - test_etl - INFO - Firebird connection successful
2025-07-23 19:46:43,871 - test_etl - INFO - Firebird current time: 2025-07-23 19:46:43.865000
2025-07-23 19:46:43,881 - test_etl - INFO - Retrieved 3 patients from Firebird through repository
2025-07-23 19:46:43,882 - test_etl - INFO - Patient 1: Проверочный Иван
2025-07-23 19:46:43,882 - test_etl - INFO - Patient 2: Проверочныйюр Наличный
2025-07-23 19:46:43,886 - test_etl - INFO - Testing YottaDB connection...
2025-07-23 19:46:43,896 - test_etl - INFO - YottaDB connectivity test successful
2025-07-23 19:46:43,896 - test_etl - INFO - Testing PostgreSQL schema...
2025-07-23 19:46:43,928 - test_etl - INFO - All essential tables exist
2025-07-23 19:46:43,929 - test_etl - INFO - Found 2 HIS systems in hislist table
2025-07-23 19:46:43,929 - test_etl - INFO -   hislist entry: (1, 'qMS')
2025-07-23 19:46:43,930 - test_etl - INFO -   hislist entry: (2, 'Инфоклиника')
2025-07-23 19:46:43,930 - test_etl - INFO - Found 3 business units in businessunits table
2025-07-23 19:46:43,931 - test_etl - INFO -   businessunits entry: (1, 'ОО ФК "Хадасса Медикал ЛТД"')
2025-07-23 19:46:43,931 - test_etl - INFO -   businessunits entry: (2, 'ООО "Медскан"')
2025-07-23 19:46:43,931 - test_etl - INFO -   businessunits entry: (3, 'ООО "Клинический госпиталь на Яузе"')
2025-07-23 19:46:43,932 - test_etl - INFO - Found 17 document types in documenttypes table
2025-07-23 19:46:43,932 - test_etl - INFO -   documenttypes entry: (1, 'Паспорт')
2025-07-23 19:46:43,933 - test_etl - INFO -   documenttypes entry: (2, 'Паспорт СССР')
2025-07-23 19:46:43,933 - test_etl - INFO -   documenttypes entry: (3, 'Заграничный паспорт РФ')
2025-07-23 19:46:43,933 - test_etl - INFO -   documenttypes entry: (4, 'Заграничный паспорт СССР')
2025-07-23 19:46:43,933 - test_etl - INFO -   documenttypes entry: (5, 'Свидетельство о рождении')
2025-07-23 19:46:43,933 - test_etl - INFO - Testing document type handling...
2025-07-23 19:46:43,959 - test_etl - INFO - Inserted qMS patient with Паспорт (ID: 1), number: 2316446787
2025-07-23 19:46:43,962 - test_etl - INFO - Inserted Инфоклиника patient with Паспорт (ID: 1), number: 7765686709
2025-07-23 19:46:43,965 - test_etl - INFO - Inserted qMS patient with Заграничный паспорт РФ (ID: 3), number: 757462576
2025-07-23 19:46:43,967 - test_etl - INFO - Inserted Инфоклиника patient with Заграничный паспорт РФ (ID: 3), number: 996284346
2025-07-23 19:46:43,969 - test_etl - INFO - Inserted qMS patient with Свидетельство о рождении (ID: 5), number: 718035465259
2025-07-23 19:46:43,971 - test_etl - INFO - Inserted Инфоклиника patient with Свидетельство о рождении (ID: 5), number: 954283075209
2025-07-23 19:46:43,973 - test_etl - INFO - Inserted qMS patient with Иностранный паспорт (ID: 10), number: 824966408
2025-07-23 19:46:43,974 - test_etl - INFO - Inserted Инфоклиника patient with Иностранный паспорт (ID: 10), number: 379848697
2025-07-23 19:46:43,975 - test_etl - INFO - Inserted qMS patient with Временное удостоверение (ID: 14), number: 36599488
2025-07-23 19:46:43,976 - test_etl - INFO - Inserted Инфоклиника patient with Временное удостоверение (ID: 14), number: 12608661
2025-07-23 19:46:43,977 - test_etl - INFO - Inserted qMS patient with Иные документы (ID: 17), number: 54289680
2025-07-23 19:46:43,978 - test_etl - INFO - Inserted Инфоклиника patient with Иные документы (ID: 17), number: 59956794
2025-07-23 19:46:43,978 - test_etl - INFO - Successfully inserted 12 out of 12 test patients with different document types
2025-07-23 19:46:43,978 - test_etl - INFO - Testing Firebird ETL process...
2025-07-23 19:46:44,046 - test_etl - INFO - Processing 10 patients through Firebird ETL
2025-07-23 19:46:44,091 - test_etl - INFO - Firebird ETL processed 10 patients successfully
2025-07-23 19:46:44,091 - test_etl - INFO - Firebird ETL process test successful
2025-07-23 19:46:44,096 - test_etl - INFO - Testing YottaDB ETL process...
2025-07-23 19:46:44,097 - test_etl - INFO - WARNING: This will fetch all data from YottaDB API (takes 2-3 minutes)
2025-07-23 19:46:46,217 - test_etl - INFO - Fetching all patients from YottaDB API...
2025-07-23 19:48:47,817 - test_etl - INFO - Retrieved 409987 patients from YottaDB
2025-07-23 19:48:47,817 - test_etl - INFO - Testing ETL process with 10 random patients...
2025-07-23 19:48:47,817 - test_etl - INFO - Processing patient 1/10: Ершов Владимир (ID: 3030/A23)
2025-07-23 19:48:47,826 - test_etl - INFO -   ✓ Patient 3030/A23 inserted successfully
2025-07-23 19:48:47,826 - test_etl - INFO - Processing patient 2/10: Монахова Мелания (ID: 17459/A25)
2025-07-23 19:48:47,828 - test_etl - INFO -   ✓ Patient 17459/A25 inserted successfully
2025-07-23 19:48:47,828 - test_etl - INFO - Processing patient 3/10: Садуртдинова Эльвира (ID: 72048/A21)
2025-07-23 19:48:47,830 - test_etl - INFO -   ✓ Patient 72048/A21 inserted successfully
2025-07-23 19:48:47,830 - test_etl - INFO - Processing patient 4/10: Москаленко Владимир (ID: 117201/A21)
2025-07-23 19:48:47,832 - test_etl - INFO -   ✓ Patient 117201/A21 inserted successfully
2025-07-23 19:48:47,832 - test_etl - INFO - Processing patient 5/10: Матяш Александра (ID: 201718/A21)
2025-07-23 19:48:47,834 - test_etl - INFO -   ✓ Patient 201718/A21 inserted successfully
2025-07-23 19:48:47,834 - test_etl - INFO - Processing patient 6/10: Меркулова Вероника (ID: 15893/A21)
2025-07-23 19:48:47,836 - test_etl - INFO -   ✓ Patient 15893/A21 inserted successfully
2025-07-23 19:48:47,836 - test_etl - INFO - Processing patient 7/10: Матюшенко Анна (ID: 5186/A23)
2025-07-23 19:48:47,837 - test_etl - INFO -   ✓ Patient 5186/A23 inserted successfully
2025-07-23 19:48:47,837 - test_etl - INFO - Processing patient 8/10: Петросян Наргиз (ID: 120366/A21)
2025-07-23 19:48:47,839 - test_etl - INFO -   ✓ Patient 120366/A21 inserted successfully
2025-07-23 19:48:47,840 - test_etl - INFO - Processing patient 9/10: Филько Кристина (ID: 2945/A21)
2025-07-23 19:48:47,842 - test_etl - INFO -   ✓ Patient 2945/A21 inserted successfully
2025-07-23 19:48:47,842 - test_etl - INFO - Processing patient 10/10: Сумина Екатерина (ID: 1752/A25)
2025-07-23 19:48:47,844 - test_etl - INFO -   ✓ Patient 1752/A25 inserted successfully
2025-07-23 19:48:47,844 - test_etl - INFO - YottaDB ETL test completed: 10 successful, 0 errors
2025-07-23 19:48:47,844 - test_etl - INFO - Total patients in YottaDB: 409987
2025-07-23 19:48:47,844 - test_etl - INFO - Test batch processed: 10
2025-07-23 19:48:47,845 - test_etl - INFO - Success rate: 100.0%
2025-07-23 19:48:47,992 - test_etl - INFO - 
Test Results Summary:
2025-07-23 19:48:47,992 - test_etl - INFO - PostgreSQL Connection: ✓
2025-07-23 19:48:47,993 - test_etl - INFO - Firebird Connection: ✓
2025-07-23 19:48:47,993 - test_etl - INFO - YottaDB Connection: ✓
2025-07-23 19:48:47,993 - test_etl - INFO - PostgreSQL Schema: ✓
2025-07-23 19:48:47,993 - test_etl - INFO - Document Type Handling: ✓
2025-07-23 19:48:47,993 - test_etl - INFO - Firebird ETL Process: ✓
2025-07-23 19:48:47,993 - test_etl - INFO - YottaDB ETL Process: ✓
2025-07-23 19:48:47,993 - test_etl - INFO - 
Tests completed.
2025-07-24 00:18:32,522 - test_etl - INFO - Testing PostgreSQL connection...
2025-07-24 00:18:32,541 - test_etl - INFO - PostgreSQL version: PostgreSQL 15.13 (Debian 15.13-0+deb12u1) on x86_64-pc-linux-gnu, compiled by gcc (Debian 12.2.0-14+deb12u1) 12.2.0, 64-bit
2025-07-24 00:18:32,543 - test_etl - INFO - Testing Firebird connection...
2025-07-24 00:18:32,556 - test_etl - INFO - Testing YottaDB connection...
2025-07-24 00:18:32,565 - test_etl - INFO - YottaDB connectivity test successful
2025-07-24 00:18:32,567 - test_etl - INFO - Testing PostgreSQL schema...
2025-07-24 00:18:32,595 - test_etl - INFO - All essential tables exist
2025-07-24 00:18:32,596 - test_etl - INFO - Found 2 HIS systems in hislist table
2025-07-24 00:18:32,596 - test_etl - INFO -   hislist entry: (1, 'qMS')
2025-07-24 00:18:32,596 - test_etl - INFO -   hislist entry: (2, 'Инфоклиника')
2025-07-24 00:18:32,597 - test_etl - INFO - Found 3 business units in businessunits table
2025-07-24 00:18:32,597 - test_etl - INFO -   businessunits entry: (1, 'ОО ФК "Хадасса Медикал ЛТД"')
2025-07-24 00:18:32,597 - test_etl - INFO -   businessunits entry: (2, 'ООО "Медскан"')
2025-07-24 00:18:32,598 - test_etl - INFO -   businessunits entry: (3, 'ООО "Клинический госпиталь на Яузе"')
2025-07-24 00:18:32,598 - test_etl - INFO - Found 17 document types in documenttypes table
2025-07-24 00:18:32,598 - test_etl - INFO -   documenttypes entry: (1, 'Паспорт')
2025-07-24 00:18:32,598 - test_etl - INFO -   documenttypes entry: (2, 'Паспорт СССР')
2025-07-24 00:18:32,599 - test_etl - INFO -   documenttypes entry: (3, 'Заграничный паспорт РФ')
2025-07-24 00:18:32,599 - test_etl - INFO -   documenttypes entry: (4, 'Заграничный паспорт СССР')
2025-07-24 00:18:32,599 - test_etl - INFO -   documenttypes entry: (5, 'Свидетельство о рождении')
2025-07-24 00:18:32,600 - test_etl - INFO - Testing document type handling...
2025-07-24 00:18:32,637 - test_etl - INFO - Inserted qMS patient with Паспорт (ID: 1), number: 3212558402
2025-07-24 00:18:32,640 - test_etl - INFO - Inserted Инфоклиника patient with Паспорт (ID: 1), number: 3287359976
2025-07-24 00:18:32,642 - test_etl - INFO - Inserted qMS patient with Заграничный паспорт РФ (ID: 3), number: 101384776
2025-07-24 00:18:32,643 - test_etl - INFO - Inserted Инфоклиника patient with Заграничный паспорт РФ (ID: 3), number: 255760715
2025-07-24 00:18:32,645 - test_etl - INFO - Inserted qMS patient with Свидетельство о рождении (ID: 5), number: 716169984254
2025-07-24 00:18:32,647 - test_etl - INFO - Inserted Инфоклиника patient with Свидетельство о рождении (ID: 5), number: 882811677836
2025-07-24 00:18:32,648 - test_etl - INFO - Inserted qMS patient with Иностранный паспорт (ID: 10), number: 386443001
2025-07-24 00:18:32,650 - test_etl - INFO - Inserted Инфоклиника patient with Иностранный паспорт (ID: 10), number: 289193955
2025-07-24 00:18:32,652 - test_etl - INFO - Inserted qMS patient with Временное удостоверение (ID: 14), number: 24375262
2025-07-24 00:18:32,654 - test_etl - INFO - Inserted Инфоклиника patient with Временное удостоверение (ID: 14), number: 67371011
2025-07-24 00:18:32,655 - test_etl - INFO - Inserted qMS patient with Иные документы (ID: 17), number: 63644947
2025-07-24 00:18:32,656 - test_etl - INFO - Inserted Инфоклиника patient with Иные документы (ID: 17), number: 95763114
2025-07-24 00:18:32,656 - test_etl - INFO - Successfully inserted 12 out of 12 test patients with different document types
2025-07-24 00:18:32,658 - test_etl - INFO - Testing Firebird ETL process...
2025-07-24 00:18:32,666 - test_etl - INFO - Testing password encryption integration...
2025-07-24 00:18:32,689 - test_etl - INFO - Firebird connection not available (expected in some environments)
2025-07-24 00:18:32,698 - test_etl - INFO - YottaDB connection successful with decrypted config
2025-07-24 00:18:32,731 - test_etl_components - INFO - Found 17 document types in configuration
2025-07-24 00:22:47,334 - test_etl - INFO - Testing PostgreSQL connection...
2025-07-24 00:22:47,353 - test_etl - INFO - PostgreSQL version: PostgreSQL 15.13 (Debian 15.13-0+deb12u1) on x86_64-pc-linux-gnu, compiled by gcc (Debian 12.2.0-14+deb12u1) 12.2.0, 64-bit
2025-07-24 00:22:47,355 - test_etl - INFO - Testing Firebird connection...
2025-07-24 00:22:47,369 - test_etl - INFO - Testing YottaDB connection...
2025-07-24 00:22:47,377 - test_etl - INFO - YottaDB connectivity test successful
2025-07-24 00:22:47,379 - test_etl - INFO - Testing PostgreSQL schema...
2025-07-24 00:22:47,404 - test_etl - INFO - All essential tables exist
2025-07-24 00:22:47,405 - test_etl - INFO - Found 2 HIS systems in hislist table
2025-07-24 00:22:47,405 - test_etl - INFO -   hislist entry: (1, 'qMS')
2025-07-24 00:22:47,405 - test_etl - INFO -   hislist entry: (2, 'Инфоклиника')
2025-07-24 00:22:47,406 - test_etl - INFO - Found 3 business units in businessunits table
2025-07-24 00:22:47,406 - test_etl - INFO -   businessunits entry: (1, 'ОО ФК "Хадасса Медикал ЛТД"')
2025-07-24 00:22:47,406 - test_etl - INFO -   businessunits entry: (2, 'ООО "Медскан"')
2025-07-24 00:22:47,406 - test_etl - INFO -   businessunits entry: (3, 'ООО "Клинический госпиталь на Яузе"')
2025-07-24 00:22:47,407 - test_etl - INFO - Found 17 document types in documenttypes table
2025-07-24 00:22:47,407 - test_etl - INFO -   documenttypes entry: (1, 'Паспорт')
2025-07-24 00:22:47,407 - test_etl - INFO -   documenttypes entry: (2, 'Паспорт СССР')
2025-07-24 00:22:47,407 - test_etl - INFO -   documenttypes entry: (3, 'Заграничный паспорт РФ')
2025-07-24 00:22:47,407 - test_etl - INFO -   documenttypes entry: (4, 'Заграничный паспорт СССР')
2025-07-24 00:22:47,407 - test_etl - INFO -   documenttypes entry: (5, 'Свидетельство о рождении')
2025-07-24 00:22:47,410 - test_etl - INFO - Testing document type handling...
2025-07-24 00:22:47,435 - test_etl - INFO - Inserted qMS patient with Паспорт (ID: 1), number: 4544496493
2025-07-24 00:22:47,438 - test_etl - INFO - Inserted Инфоклиника patient with Паспорт (ID: 1), number: 5206324439
2025-07-24 00:22:47,440 - test_etl - INFO - Inserted qMS patient with Заграничный паспорт РФ (ID: 3), number: 144758604
2025-07-24 00:22:47,442 - test_etl - INFO - Inserted Инфоклиника patient with Заграничный паспорт РФ (ID: 3), number: 255306746
2025-07-24 00:22:47,444 - test_etl - INFO - Inserted qMS patient with Свидетельство о рождении (ID: 5), number: 940135370759
2025-07-24 00:22:47,446 - test_etl - INFO - Inserted Инфоклиника patient with Свидетельство о рождении (ID: 5), number: 249425587365
2025-07-24 00:22:47,447 - test_etl - INFO - Inserted qMS patient with Иностранный паспорт (ID: 10), number: 129810466
2025-07-24 00:22:47,448 - test_etl - INFO - Inserted Инфоклиника patient with Иностранный паспорт (ID: 10), number: 980142791
2025-07-24 00:22:47,449 - test_etl - INFO - Inserted qMS patient with Временное удостоверение (ID: 14), number: 24239947
2025-07-24 00:22:47,451 - test_etl - INFO - Inserted Инфоклиника patient with Временное удостоверение (ID: 14), number: 26826335
2025-07-24 00:22:47,452 - test_etl - INFO - Inserted qMS patient with Иные документы (ID: 17), number: 66129070
2025-07-24 00:22:47,453 - test_etl - INFO - Inserted Инфоклиника patient with Иные документы (ID: 17), number: 56664721
2025-07-24 00:22:47,453 - test_etl - INFO - Successfully inserted 12 out of 12 test patients with different document types
2025-07-24 00:22:47,456 - test_etl - INFO - Testing Firebird ETL process...
2025-07-24 00:22:47,464 - test_etl - INFO - Testing password encryption integration...
2025-07-24 00:22:47,487 - test_etl - INFO - Firebird connection not available (expected in some environments)
2025-07-24 00:22:47,496 - test_etl - INFO - YottaDB connection successful with decrypted config
2025-07-24 00:22:47,502 - test_etl_components - INFO - Found 17 document types in configuration
