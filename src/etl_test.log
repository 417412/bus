2025-05-12 06:28:28,785 - main - INFO - Starting tests...
2025-05-12 06:28:28,786 - main - INFO - Testing PostgreSQL connection...
2025-05-12 06:28:28,786 - src.connectors.postgres_connector - ERROR - Failed to connect to PostgreSQL: connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?

2025-05-12 06:28:28,787 - main - ERROR - PostgreSQL connection failed
2025-05-12 06:28:28,787 - main - INFO - Testing Firebird connection...
2025-05-12 06:28:28,788 - src.connectors.firebird_connector - ERROR - Failed to connect to Firebird (Инфоклиника): ('01000', "[01000] [unixODBC][Driver Manager]Can't open lib 'Firebird/InterBase(r) driver' : file not found (0) (SQLDriverConnect)")
2025-05-12 06:28:28,788 - main - ERROR - Firebird connection failed
2025-05-12 06:28:28,788 - main - INFO - Testing YottaDB connection...
2025-05-12 06:28:28,789 - main - ERROR - YottaDB connection failed
2025-05-12 06:28:28,789 - main - INFO - Testing PostgreSQL schema...
2025-05-12 06:28:28,789 - src.connectors.postgres_connector - ERROR - Failed to connect to PostgreSQL: connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?

2025-05-12 06:28:28,789 - main - WARNING - Skipping patient insertion test due to schema issues
2025-05-12 06:28:28,789 - main - INFO - 
Test Results Summary:
2025-05-12 06:28:28,790 - main - INFO - PostgreSQL Connection: ✗
2025-05-12 06:28:28,790 - main - INFO - Firebird Connection: ✗
2025-05-12 06:28:28,790 - main - INFO - YottaDB Connection: ✗
2025-05-12 06:28:28,790 - main - INFO - PostgreSQL Schema: ✗
2025-05-12 06:28:28,790 - main - INFO - Patient Insertion: ✗
2025-05-12 06:28:28,790 - main - INFO - 
Tests completed.
2025-05-12 08:31:24,649 - main - INFO - Starting tests...
2025-05-12 08:31:24,649 - main - INFO - Testing PostgreSQL connection...
2025-05-12 08:31:24,650 - src.connectors.postgres_connector - ERROR - Failed to connect to PostgreSQL: connection to server at "localhost" (::1), port 5432 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?
connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?

2025-05-12 08:31:24,650 - main - ERROR - PostgreSQL connection failed
2025-05-12 08:31:24,651 - main - INFO - Testing Firebird connection...
2025-05-12 08:31:24,652 - src.connectors.firebird_connector - ERROR - Failed to connect to Firebird (Инфоклиника): ('01000', "[01000] [unixODBC][Driver Manager]Can't open lib 'Firebird/InterBase(r) driver' : file not found (0) (SQLDriverConnect)")
2025-05-12 08:31:24,652 - main - ERROR - Firebird connection failed
2025-05-12 08:31:24,653 - main - INFO - Testing YottaDB connection...
2025-05-12 08:31:24,653 - main - ERROR - YottaDB connection failed
2025-05-12 08:31:24,653 - main - INFO - Testing PostgreSQL schema...
2025-05-12 08:31:24,653 - src.connectors.postgres_connector - ERROR - Failed to connect to PostgreSQL: connection to server at "localhost" (::1), port 5432 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?
connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?

2025-05-12 08:31:24,653 - main - WARNING - Skipping patient insertion test due to schema issues
2025-05-12 08:31:24,653 - main - INFO - 
Test Results Summary:
2025-05-12 08:31:24,653 - main - INFO - PostgreSQL Connection: ✗
2025-05-12 08:31:24,654 - main - INFO - Firebird Connection: ✗
2025-05-12 08:31:24,654 - main - INFO - YottaDB Connection: ✗
2025-05-12 08:31:24,654 - main - INFO - PostgreSQL Schema: ✗
2025-05-12 08:31:24,654 - main - INFO - Patient Insertion: ✗
2025-05-12 08:31:24,654 - main - INFO - 
Tests completed.
2025-05-12 08:58:11,194 - main - INFO - Starting tests...
2025-05-12 08:58:11,194 - main - INFO - Testing PostgreSQL connection...
2025-05-12 08:58:11,195 - src.connectors.postgres_connector - ERROR - Failed to connect to PostgreSQL: connection to server at "localhost" (::1), port 5432 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?
connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?

2025-05-12 08:58:11,195 - main - ERROR - PostgreSQL connection failed
2025-05-12 08:58:11,195 - main - INFO - Testing Firebird connection...
2025-05-12 08:58:11,197 - src.connectors.firebird_connector - ERROR - Failed to connect to Firebird (Инфоклиника): No module named 'fdb'
2025-05-12 08:58:11,197 - main - ERROR - Firebird connection failed
2025-05-12 08:58:11,197 - main - INFO - Testing YottaDB connection...
2025-05-12 08:58:11,197 - main - ERROR - YottaDB connection failed
2025-05-12 08:58:11,197 - main - INFO - Testing PostgreSQL schema...
2025-05-12 08:58:11,198 - src.connectors.postgres_connector - ERROR - Failed to connect to PostgreSQL: connection to server at "localhost" (::1), port 5432 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?
connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?

2025-05-12 08:58:11,198 - main - WARNING - Skipping patient insertion test due to schema issues
2025-05-12 08:58:11,198 - main - INFO - 
Test Results Summary:
2025-05-12 08:58:11,198 - main - INFO - PostgreSQL Connection: ✗
2025-05-12 08:58:11,198 - main - INFO - Firebird Connection: ✗
2025-05-12 08:58:11,198 - main - INFO - YottaDB Connection: ✗
2025-05-12 08:58:11,198 - main - INFO - PostgreSQL Schema: ✗
2025-05-12 08:58:11,198 - main - INFO - Patient Insertion: ✗
2025-05-12 08:58:11,198 - main - INFO - 
Tests completed.
2025-05-12 08:59:01,581 - main - INFO - Starting tests...
2025-05-12 08:59:01,581 - main - INFO - Testing PostgreSQL connection...
2025-05-12 08:59:01,581 - src.connectors.postgres_connector - ERROR - Failed to connect to PostgreSQL: connection to server at "localhost" (::1), port 5432 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?
connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?

2025-05-12 08:59:01,582 - main - ERROR - PostgreSQL connection failed
2025-05-12 08:59:01,582 - main - INFO - Testing Firebird connection...
2025-05-12 08:59:01,583 - src.connectors.firebird_connector - ERROR - Failed to connect to Firebird (Инфоклиника): No module named 'fdb'
2025-05-12 08:59:01,584 - main - ERROR - Firebird connection failed
2025-05-12 08:59:01,584 - main - INFO - Testing YottaDB connection...
2025-05-12 08:59:01,584 - main - ERROR - YottaDB connection failed
2025-05-12 08:59:01,584 - main - INFO - Testing PostgreSQL schema...
2025-05-12 08:59:01,584 - src.connectors.postgres_connector - ERROR - Failed to connect to PostgreSQL: connection to server at "localhost" (::1), port 5432 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?
connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?

2025-05-12 08:59:01,584 - main - WARNING - Skipping patient insertion test due to schema issues
2025-05-12 08:59:01,584 - main - INFO - 
Test Results Summary:
2025-05-12 08:59:01,584 - main - INFO - PostgreSQL Connection: ✗
2025-05-12 08:59:01,584 - main - INFO - Firebird Connection: ✗
2025-05-12 08:59:01,584 - main - INFO - YottaDB Connection: ✗
2025-05-12 08:59:01,585 - main - INFO - PostgreSQL Schema: ✗
2025-05-12 08:59:01,585 - main - INFO - Patient Insertion: ✗
2025-05-12 08:59:01,585 - main - INFO - 
Tests completed.
2025-05-12 09:01:11,913 - main - INFO - Starting tests...
2025-05-12 09:01:11,913 - main - INFO - Testing PostgreSQL connection...
2025-05-12 09:01:11,913 - src.connectors.postgres_connector - ERROR - Failed to connect to PostgreSQL: connection to server at "localhost" (::1), port 5432 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?
connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?

2025-05-12 09:01:11,913 - main - ERROR - PostgreSQL connection failed
2025-05-12 09:01:11,914 - main - INFO - Testing Firebird connection...
2025-05-12 09:01:11,915 - src.connectors.firebird_connector - ERROR - Failed to connect to Firebird (Инфоклиника): No module named 'fdb'
2025-05-12 09:01:11,916 - main - ERROR - Firebird connection failed
2025-05-12 09:01:11,916 - main - INFO - Testing YottaDB connection...
2025-05-12 09:01:11,916 - main - ERROR - YottaDB connection failed
2025-05-12 09:01:11,916 - main - INFO - Testing PostgreSQL schema...
2025-05-12 09:01:11,916 - src.connectors.postgres_connector - ERROR - Failed to connect to PostgreSQL: connection to server at "localhost" (::1), port 5432 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?
connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?

2025-05-12 09:01:11,916 - main - WARNING - Skipping patient insertion test due to schema issues
2025-05-12 09:01:11,916 - main - INFO - 
Test Results Summary:
2025-05-12 09:01:11,916 - main - INFO - PostgreSQL Connection: ✗
2025-05-12 09:01:11,916 - main - INFO - Firebird Connection: ✗
2025-05-12 09:01:11,916 - main - INFO - YottaDB Connection: ✗
2025-05-12 09:01:11,916 - main - INFO - PostgreSQL Schema: ✗
2025-05-12 09:01:11,917 - main - INFO - Patient Insertion: ✗
2025-05-12 09:01:11,917 - main - INFO - 
Tests completed.
2025-05-12 13:59:20,851 - main - INFO - Starting tests...
2025-05-12 13:59:20,852 - main - INFO - Testing PostgreSQL connection...
2025-05-12 13:59:20,852 - src.connectors.postgres_connector - ERROR - Failed to connect to PostgreSQL: connection to server at "localhost" (::1), port 5432 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?
connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?

2025-05-12 13:59:20,852 - main - ERROR - PostgreSQL connection failed
2025-05-12 13:59:20,852 - main - INFO - Testing Firebird connection...
2025-05-12 13:59:20,855 - src.connectors.firebird_connector - ERROR - Failed to connect to Firebird (Инфоклиника): No module named 'fdb'
2025-05-12 13:59:20,855 - main - ERROR - Firebird connection failed
2025-05-12 13:59:20,855 - main - INFO - Testing YottaDB connection...
2025-05-12 13:59:20,856 - main - ERROR - YottaDB connection failed
2025-05-12 13:59:20,856 - main - INFO - Testing PostgreSQL schema...
2025-05-12 13:59:20,856 - src.connectors.postgres_connector - ERROR - Failed to connect to PostgreSQL: connection to server at "localhost" (::1), port 5432 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?
connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?

2025-05-12 13:59:20,856 - main - WARNING - Skipping patient insertion test due to schema issues
2025-05-12 13:59:20,856 - main - INFO - 
Test Results Summary:
2025-05-12 13:59:20,856 - main - INFO - PostgreSQL Connection: ✗
2025-05-12 13:59:20,856 - main - INFO - Firebird Connection: ✗
2025-05-12 13:59:20,856 - main - INFO - YottaDB Connection: ✗
2025-05-12 13:59:20,856 - main - INFO - PostgreSQL Schema: ✗
2025-05-12 13:59:20,856 - main - INFO - Patient Insertion: ✗
2025-05-12 13:59:20,856 - main - INFO - 
Tests completed.
2025-05-12 14:03:45,747 - main - INFO - Starting tests...
2025-05-12 14:03:45,747 - main - INFO - Testing PostgreSQL connection...
2025-05-12 14:03:45,786 - src.connectors.postgres_connector - ERROR - Failed to connect to PostgreSQL: connection to server at "localhost" (::1), port 5432 failed: ВАЖНО:  пользователь "postgres" не прошёл проверку подлинности (по паролю)
connection to server at "localhost" (::1), port 5432 failed: ВАЖНО:  пользователь "postgres" не прошёл проверку подлинности (по паролю)

2025-05-12 14:03:45,787 - main - ERROR - PostgreSQL connection failed
2025-05-12 14:03:45,787 - main - INFO - Testing Firebird connection...
2025-05-12 14:03:45,790 - src.connectors.firebird_connector - ERROR - Failed to connect to Firebird (Инфоклиника): No module named 'fdb'
2025-05-12 14:03:45,790 - main - ERROR - Firebird connection failed
2025-05-12 14:03:45,790 - main - INFO - Testing YottaDB connection...
2025-05-12 14:03:45,790 - main - ERROR - YottaDB connection failed
2025-05-12 14:03:45,790 - main - INFO - Testing PostgreSQL schema...
2025-05-12 14:03:45,817 - src.connectors.postgres_connector - ERROR - Failed to connect to PostgreSQL: connection to server at "localhost" (::1), port 5432 failed: ВАЖНО:  пользователь "postgres" не прошёл проверку подлинности (по паролю)
connection to server at "localhost" (::1), port 5432 failed: ВАЖНО:  пользователь "postgres" не прошёл проверку подлинности (по паролю)

2025-05-12 14:03:45,817 - main - WARNING - Skipping patient insertion test due to schema issues
2025-05-12 14:03:45,818 - main - INFO - 
Test Results Summary:
2025-05-12 14:03:45,818 - main - INFO - PostgreSQL Connection: ✗
2025-05-12 14:03:45,818 - main - INFO - Firebird Connection: ✗
2025-05-12 14:03:45,818 - main - INFO - YottaDB Connection: ✗
2025-05-12 14:03:45,818 - main - INFO - PostgreSQL Schema: ✗
2025-05-12 14:03:45,818 - main - INFO - Patient Insertion: ✗
2025-05-12 14:03:45,818 - main - INFO - 
Tests completed.
2025-05-12 16:08:35,530 - main - INFO - Starting tests...
2025-05-12 16:08:35,530 - main - INFO - Testing PostgreSQL connection...
2025-05-12 16:08:35,559 - src.connectors.postgres_connector - ERROR - Failed to connect to PostgreSQL: connection to server at "localhost" (::1), port 5432 failed: ВАЖНО:  пользователь "medapp_user" не прошёл проверку подлинности (по паролю)
connection to server at "localhost" (::1), port 5432 failed: ВАЖНО:  пользователь "medapp_user" не прошёл проверку подлинности (по паролю)

2025-05-12 16:08:35,559 - main - ERROR - PostgreSQL connection failed
2025-05-12 16:08:35,560 - main - INFO - Testing Firebird connection...
2025-05-12 16:08:35,563 - src.connectors.firebird_connector - ERROR - Failed to connect to Firebird (Инфоклиника): No module named 'fdb'
2025-05-12 16:08:35,563 - main - ERROR - Firebird connection failed
2025-05-12 16:08:35,563 - main - INFO - Testing YottaDB connection...
2025-05-12 16:08:35,563 - main - ERROR - YottaDB connection failed
2025-05-12 16:08:35,563 - main - INFO - Testing PostgreSQL schema...
2025-05-12 16:08:35,591 - src.connectors.postgres_connector - ERROR - Failed to connect to PostgreSQL: connection to server at "localhost" (::1), port 5432 failed: ВАЖНО:  пользователь "medapp_user" не прошёл проверку подлинности (по паролю)
connection to server at "localhost" (::1), port 5432 failed: ВАЖНО:  пользователь "medapp_user" не прошёл проверку подлинности (по паролю)

2025-05-12 16:08:35,591 - main - WARNING - Skipping patient insertion test due to schema issues
2025-05-12 16:08:35,591 - main - INFO - 
Test Results Summary:
2025-05-12 16:08:35,591 - main - INFO - PostgreSQL Connection: ✗
2025-05-12 16:08:35,591 - main - INFO - Firebird Connection: ✗
2025-05-12 16:08:35,591 - main - INFO - YottaDB Connection: ✗
2025-05-12 16:08:35,591 - main - INFO - PostgreSQL Schema: ✗
2025-05-12 16:08:35,591 - main - INFO - Patient Insertion: ✗
2025-05-12 16:08:35,591 - main - INFO - 
Tests completed.
2025-05-12 16:09:14,691 - main - INFO - Starting tests...
2025-05-12 16:09:14,691 - main - INFO - Testing PostgreSQL connection...
2025-05-12 16:09:14,721 - src.connectors.postgres_connector - ERROR - Failed to connect to PostgreSQL: connection to server at "localhost" (::1), port 5432 failed: ВАЖНО:  пользователь "medapp_user" не прошёл проверку подлинности (по паролю)
connection to server at "localhost" (::1), port 5432 failed: ВАЖНО:  пользователь "medapp_user" не прошёл проверку подлинности (по паролю)

2025-05-12 16:09:14,721 - main - ERROR - PostgreSQL connection failed
2025-05-12 16:09:14,721 - main - INFO - Testing Firebird connection...
2025-05-12 16:09:14,726 - src.connectors.firebird_connector - ERROR - Failed to connect to Firebird (Инфоклиника): No module named 'fdb'
2025-05-12 16:09:14,726 - main - ERROR - Firebird connection failed
2025-05-12 16:09:14,726 - main - INFO - Testing YottaDB connection...
2025-05-12 16:09:14,726 - main - ERROR - YottaDB connection failed
2025-05-12 16:09:14,727 - main - INFO - Testing PostgreSQL schema...
2025-05-12 16:09:14,754 - src.connectors.postgres_connector - ERROR - Failed to connect to PostgreSQL: connection to server at "localhost" (::1), port 5432 failed: ВАЖНО:  пользователь "medapp_user" не прошёл проверку подлинности (по паролю)
connection to server at "localhost" (::1), port 5432 failed: ВАЖНО:  пользователь "medapp_user" не прошёл проверку подлинности (по паролю)

2025-05-12 16:09:14,755 - main - WARNING - Skipping patient insertion test due to schema issues
2025-05-12 16:09:14,755 - main - INFO - 
Test Results Summary:
2025-05-12 16:09:14,755 - main - INFO - PostgreSQL Connection: ✗
2025-05-12 16:09:14,755 - main - INFO - Firebird Connection: ✗
2025-05-12 16:09:14,755 - main - INFO - YottaDB Connection: ✗
2025-05-12 16:09:14,755 - main - INFO - PostgreSQL Schema: ✗
2025-05-12 16:09:14,755 - main - INFO - Patient Insertion: ✗
2025-05-12 16:09:14,755 - main - INFO - 
Tests completed.
2025-05-12 16:16:18,707 - main - INFO - Starting tests...
2025-05-12 16:16:18,707 - main - INFO - Testing PostgreSQL connection...
2025-05-12 16:16:18,725 - src.connectors.postgres_connector - INFO - Connected to PostgreSQL
2025-05-12 16:16:18,725 - main - INFO - PostgreSQL connection successful
2025-05-12 16:16:18,726 - main - INFO - PostgreSQL version: PostgreSQL 15.12 (Debian 15.12-0+deb12u2) on x86_64-pc-linux-gnu, compiled by gcc (Debian 12.2.0-14) 12.2.0, 64-bit
2025-05-12 16:16:18,726 - src.connectors.postgres_connector - INFO - Disconnected from PostgreSQL
2025-05-12 16:16:18,726 - main - INFO - Testing Firebird connection...
2025-05-12 16:16:18,730 - src.connectors.firebird_connector - ERROR - Failed to connect to Firebird (Инфоклиника): No module named 'fdb'
2025-05-12 16:16:18,730 - main - ERROR - Firebird connection failed
2025-05-12 16:16:18,730 - main - INFO - Testing YottaDB connection...
2025-05-12 16:16:18,730 - main - ERROR - YottaDB connection failed
2025-05-12 16:16:18,730 - main - INFO - Testing PostgreSQL schema...
2025-05-12 16:16:18,749 - src.connectors.postgres_connector - INFO - Connected to PostgreSQL
2025-05-12 16:16:18,757 - main - INFO - All essential tables exist
2025-05-12 16:16:18,757 - main - INFO - Found 2 HIS entries:
2025-05-12 16:16:18,757 - main - INFO -   ID: 1, Name: qMS
2025-05-12 16:16:18,757 - main - INFO -   ID: 2, Name: Инфоклиника
2025-05-12 16:16:18,758 - main - INFO - Found 3 business units:
2025-05-12 16:16:18,758 - main - INFO -   ID: 1, Name: ОО ФК "Хадасса Медикал ЛТД"
2025-05-12 16:16:18,758 - main - INFO -   ID: 2, Name: ООО "Медскан"
2025-05-12 16:16:18,758 - main - INFO -   ID: 3, Name: ООО "Клинический госпиталь на Яузе"
2025-05-12 16:16:18,758 - src.connectors.postgres_connector - INFO - Disconnected from PostgreSQL
2025-05-12 16:16:18,758 - main - INFO - Testing patient insertion...
2025-05-12 16:16:18,777 - src.connectors.postgres_connector - INFO - Connected to PostgreSQL
2025-05-12 16:16:18,786 - src.connectors.postgres_connector - INFO - Inserted/updated patient 1 with UUID 0be25355-6961-4d18-87ef-ca876ccb3721
2025-05-12 16:16:18,786 - main - INFO - Sample patient inserted successfully
2025-05-12 16:16:18,787 - main - INFO - Verified patient in database: ID=1, UUID=0be25355-6961-4d18-87ef-ca876ccb3721, Passport=4512345678
2025-05-12 16:16:18,788 - src.connectors.postgres_connector - INFO - Disconnected from PostgreSQL
2025-05-12 16:16:18,788 - main - INFO - 
Test Results Summary:
2025-05-12 16:16:18,788 - main - INFO - PostgreSQL Connection: ✓
2025-05-12 16:16:18,788 - main - INFO - Firebird Connection: ✗
2025-05-12 16:16:18,788 - main - INFO - YottaDB Connection: ✗
2025-05-12 16:16:18,788 - main - INFO - PostgreSQL Schema: ✓
2025-05-12 16:16:18,788 - main - INFO - Patient Insertion: ✓
2025-05-12 16:16:18,788 - main - INFO - 
Tests completed.
2025-05-14 13:06:31,265 - main - INFO - Starting tests...
2025-05-14 13:06:31,266 - main - INFO - Testing PostgreSQL connection...
2025-05-14 13:06:31,286 - src.connectors.postgres_connector - INFO - Connected to PostgreSQL
2025-05-14 13:06:31,287 - main - INFO - PostgreSQL connection successful
2025-05-14 13:06:31,287 - main - INFO - PostgreSQL version: PostgreSQL 15.12 (Debian 15.12-0+deb12u2) on x86_64-pc-linux-gnu, compiled by gcc (Debian 12.2.0-14) 12.2.0, 64-bit
2025-05-14 13:06:31,287 - src.connectors.postgres_connector - INFO - Disconnected from PostgreSQL
2025-05-14 13:06:31,287 - main - INFO - Testing Firebird connection...
2025-05-14 13:06:31,291 - src.connectors.firebird_connector - ERROR - Failed to connect to Firebird (Инфоклиника): No module named 'fdb'
2025-05-14 13:06:31,291 - main - ERROR - Firebird connection failed
2025-05-14 13:06:31,291 - main - INFO - Testing YottaDB connection...
2025-05-14 13:06:31,292 - main - ERROR - YottaDB connection failed
2025-05-14 13:06:31,292 - main - INFO - Testing PostgreSQL schema...
2025-05-14 13:06:31,303 - src.connectors.postgres_connector - INFO - Connected to PostgreSQL
2025-05-14 13:06:31,309 - main - INFO - All essential tables exist
2025-05-14 13:06:31,310 - main - INFO - Found 2 HIS entries:
2025-05-14 13:06:31,310 - main - INFO -   ID: 1, Name: qMS
2025-05-14 13:06:31,311 - main - INFO -   ID: 2, Name: Инфоклиника
2025-05-14 13:06:31,311 - main - INFO - Found 3 business units:
2025-05-14 13:06:31,311 - main - INFO -   ID: 1, Name: ОО ФК "Хадасса Медикал ЛТД"
2025-05-14 13:06:31,311 - main - INFO -   ID: 2, Name: ООО "Медскан"
2025-05-14 13:06:31,311 - main - INFO -   ID: 3, Name: ООО "Клинический госпиталь на Яузе"
2025-05-14 13:06:31,312 - src.connectors.postgres_connector - INFO - Disconnected from PostgreSQL
2025-05-14 13:06:31,312 - main - INFO - Testing patient insertion...
2025-05-14 13:06:31,324 - src.connectors.postgres_connector - INFO - Connected to PostgreSQL
2025-05-14 13:06:31,339 - src.connectors.postgres_connector - INFO - Inserted/updated patient 2698041 with UUID c07329ba-3a38-44ce-8b79-81324177da05
2025-05-14 13:06:31,339 - main - INFO - Sample patient inserted successfully
2025-05-14 13:06:31,341 - main - INFO - Verified patient in database: ID=2698041, UUID=c07329ba-3a38-44ce-8b79-81324177da05, Passport=4512345678
2025-05-14 13:06:31,341 - src.connectors.postgres_connector - INFO - Disconnected from PostgreSQL
2025-05-14 13:06:31,341 - main - INFO - 
Test Results Summary:
2025-05-14 13:06:31,341 - main - INFO - PostgreSQL Connection: ✓
2025-05-14 13:06:31,341 - main - INFO - Firebird Connection: ✗
2025-05-14 13:06:31,341 - main - INFO - YottaDB Connection: ✗
2025-05-14 13:06:31,341 - main - INFO - PostgreSQL Schema: ✓
2025-05-14 13:06:31,342 - main - INFO - Patient Insertion: ✓
2025-05-14 13:06:31,342 - main - INFO - 
Tests completed.
2025-05-14 13:09:04,637 - main - INFO - Starting tests...
2025-05-14 13:09:04,637 - main - INFO - Testing PostgreSQL connection...
2025-05-14 13:09:04,649 - src.connectors.postgres_connector - INFO - Connected to PostgreSQL
2025-05-14 13:09:04,649 - main - INFO - PostgreSQL connection successful
2025-05-14 13:09:04,650 - main - INFO - PostgreSQL version: PostgreSQL 15.12 (Debian 15.12-0+deb12u2) on x86_64-pc-linux-gnu, compiled by gcc (Debian 12.2.0-14) 12.2.0, 64-bit
2025-05-14 13:09:04,650 - src.connectors.postgres_connector - INFO - Disconnected from PostgreSQL
2025-05-14 13:09:04,650 - main - INFO - Testing Firebird connection...
2025-05-14 13:11:54,962 - main - INFO - Starting tests...
2025-05-14 13:11:54,963 - main - INFO - Testing PostgreSQL connection...
2025-05-14 13:11:54,974 - src.connectors.postgres_connector - INFO - Connected to PostgreSQL
2025-05-14 13:11:54,975 - main - INFO - PostgreSQL connection successful
2025-05-14 13:11:54,975 - main - INFO - PostgreSQL version: PostgreSQL 15.12 (Debian 15.12-0+deb12u2) on x86_64-pc-linux-gnu, compiled by gcc (Debian 12.2.0-14) 12.2.0, 64-bit
2025-05-14 13:11:54,975 - src.connectors.postgres_connector - INFO - Disconnected from PostgreSQL
2025-05-14 13:11:54,976 - main - INFO - Testing Firebird connection...
2025-05-14 13:14:04,772 - src.connectors.firebird_connector - ERROR - Failed to connect to Firebird (Инфоклиника): (fdb.fbcore.DatabaseError) ('Error while connecting to database:\n- SQLCODE: -902\n- Unable to complete network request to host "192.168.160.168".\n- Failed to establish a connection.', -902, 335544721)
(Background on this error at: https://sqlalche.me/e/14/4xp6)
2025-05-14 13:14:04,773 - main - ERROR - Firebird connection failed
2025-05-14 13:14:04,773 - main - INFO - Testing YottaDB connection...
2025-05-14 13:14:04,773 - main - ERROR - YottaDB connection failed
2025-05-14 13:14:04,774 - main - INFO - Testing PostgreSQL schema...
2025-05-14 13:14:04,786 - src.connectors.postgres_connector - INFO - Connected to PostgreSQL
2025-05-14 13:14:04,790 - main - INFO - All essential tables exist
2025-05-14 13:14:04,791 - main - INFO - Found 2 HIS entries:
2025-05-14 13:14:04,791 - main - INFO -   ID: 1, Name: qMS
2025-05-14 13:14:04,791 - main - INFO -   ID: 2, Name: Инфоклиника
2025-05-14 13:14:04,792 - main - INFO - Found 3 business units:
2025-05-14 13:14:04,792 - main - INFO -   ID: 1, Name: ОО ФК "Хадасса Медикал ЛТД"
2025-05-14 13:14:04,792 - main - INFO -   ID: 2, Name: ООО "Медскан"
2025-05-14 13:14:04,792 - main - INFO -   ID: 3, Name: ООО "Клинический госпиталь на Яузе"
2025-05-14 13:14:04,792 - src.connectors.postgres_connector - INFO - Disconnected from PostgreSQL
2025-05-14 13:14:04,793 - main - INFO - Testing patient insertion...
2025-05-14 13:14:04,807 - src.connectors.postgres_connector - INFO - Connected to PostgreSQL
2025-05-14 13:14:04,812 - src.connectors.postgres_connector - INFO - Inserted/updated patient 2698041 with UUID c07329ba-3a38-44ce-8b79-81324177da05
2025-05-14 13:14:04,813 - main - INFO - Sample patient inserted successfully
2025-05-14 13:14:04,815 - main - INFO - Verified patient in database: ID=2698041, UUID=c07329ba-3a38-44ce-8b79-81324177da05, Passport=4512345678
2025-05-14 13:14:04,815 - src.connectors.postgres_connector - INFO - Disconnected from PostgreSQL
2025-05-14 13:14:04,815 - main - INFO - 
Test Results Summary:
2025-05-14 13:14:04,816 - main - INFO - PostgreSQL Connection: ✓
2025-05-14 13:14:04,816 - main - INFO - Firebird Connection: ✗
2025-05-14 13:14:04,816 - main - INFO - YottaDB Connection: ✗
2025-05-14 13:14:04,816 - main - INFO - PostgreSQL Schema: ✓
2025-05-14 13:14:04,816 - main - INFO - Patient Insertion: ✓
2025-05-14 13:14:04,816 - main - INFO - 
Tests completed.
2025-05-14 14:15:51,173 - main - INFO - Starting tests...
2025-05-14 14:15:51,173 - main - INFO - Testing PostgreSQL connection...
2025-05-14 14:15:51,184 - src.connectors.postgres_connector - INFO - Connected to PostgreSQL
2025-05-14 14:15:51,185 - main - INFO - PostgreSQL connection successful
2025-05-14 14:15:51,185 - main - INFO - PostgreSQL version: PostgreSQL 15.12 (Debian 15.12-0+deb12u2) on x86_64-pc-linux-gnu, compiled by gcc (Debian 12.2.0-14) 12.2.0, 64-bit
2025-05-14 14:15:51,186 - src.connectors.postgres_connector - INFO - Disconnected from PostgreSQL
2025-05-14 14:15:51,186 - main - INFO - Testing Firebird connection...
2025-05-14 14:15:51,186 - src.connectors.firebird_connector - ERROR - Failed to connect to Firebird (Инфоклиника): 'DriverConfig' object has no attribute 'DriverConfig'
2025-05-14 14:15:51,186 - main - ERROR - Firebird connection failed
2025-05-14 14:15:51,186 - main - INFO - Testing YottaDB connection...
2025-05-14 14:15:51,186 - main - ERROR - YottaDB connection failed
2025-05-14 14:15:51,186 - main - INFO - Testing PostgreSQL schema...
2025-05-14 14:15:51,197 - src.connectors.postgres_connector - INFO - Connected to PostgreSQL
2025-05-14 14:15:51,201 - main - INFO - All essential tables exist
2025-05-14 14:15:51,202 - main - INFO - Found 2 HIS entries:
2025-05-14 14:15:51,202 - main - INFO -   ID: 1, Name: qMS
2025-05-14 14:15:51,202 - main - INFO -   ID: 2, Name: Инфоклиника
2025-05-14 14:15:51,202 - main - INFO - Found 3 business units:
2025-05-14 14:15:51,202 - main - INFO -   ID: 1, Name: ОО ФК "Хадасса Медикал ЛТД"
2025-05-14 14:15:51,202 - main - INFO -   ID: 2, Name: ООО "Медскан"
2025-05-14 14:15:51,202 - main - INFO -   ID: 3, Name: ООО "Клинический госпиталь на Яузе"
2025-05-14 14:15:51,202 - src.connectors.postgres_connector - INFO - Disconnected from PostgreSQL
2025-05-14 14:15:51,202 - main - INFO - Testing patient insertion...
2025-05-14 14:15:51,213 - src.connectors.postgres_connector - INFO - Connected to PostgreSQL
2025-05-14 14:15:51,221 - src.connectors.postgres_connector - INFO - Inserted/updated patient 2698041 with UUID c07329ba-3a38-44ce-8b79-81324177da05
2025-05-14 14:15:51,221 - main - INFO - Sample patient inserted successfully
2025-05-14 14:15:51,223 - main - INFO - Verified patient in database: ID=2698041, UUID=c07329ba-3a38-44ce-8b79-81324177da05, Passport=4512345678
2025-05-14 14:15:51,223 - src.connectors.postgres_connector - INFO - Disconnected from PostgreSQL
2025-05-14 14:15:51,223 - main - INFO - 
Test Results Summary:
2025-05-14 14:15:51,223 - main - INFO - PostgreSQL Connection: ✓
2025-05-14 14:15:51,223 - main - INFO - Firebird Connection: ✗
2025-05-14 14:15:51,223 - main - INFO - YottaDB Connection: ✗
2025-05-14 14:15:51,223 - main - INFO - PostgreSQL Schema: ✓
2025-05-14 14:15:51,223 - main - INFO - Patient Insertion: ✓
2025-05-14 14:15:51,223 - main - INFO - 
Tests completed.
2025-05-14 14:27:20,993 - main - INFO - Starting tests...
2025-05-14 14:27:20,994 - main - INFO - Testing PostgreSQL connection...
2025-05-14 14:27:21,010 - src.connectors.postgres_connector - INFO - Connected to PostgreSQL
2025-05-14 14:27:21,010 - main - INFO - PostgreSQL connection successful
2025-05-14 14:27:21,011 - main - INFO - PostgreSQL version: PostgreSQL 15.12 (Debian 15.12-0+deb12u2) on x86_64-pc-linux-gnu, compiled by gcc (Debian 12.2.0-14) 12.2.0, 64-bit
2025-05-14 14:27:21,012 - src.connectors.postgres_connector - INFO - Disconnected from PostgreSQL
2025-05-14 14:27:21,012 - main - INFO - Testing Firebird connection...
2025-05-14 14:29:30,848 - src.connectors.firebird_connector - ERROR - Failed to connect to Firebird (Инфоклиника): Unable to complete network request to host "192.168.160.168".
-Failed to establish a connection.
2025-05-14 14:29:30,849 - main - ERROR - Firebird connection failed
2025-05-14 14:29:30,849 - main - INFO - Testing YottaDB connection...
2025-05-14 14:29:30,849 - main - ERROR - YottaDB connection failed
2025-05-14 14:29:30,849 - main - INFO - Testing PostgreSQL schema...
2025-05-14 14:29:30,892 - src.connectors.postgres_connector - INFO - Connected to PostgreSQL
2025-05-14 14:29:30,899 - main - INFO - All essential tables exist
2025-05-14 14:29:30,900 - main - INFO - Found 2 HIS entries:
2025-05-14 14:29:30,900 - main - INFO -   ID: 1, Name: qMS
2025-05-14 14:29:30,900 - main - INFO -   ID: 2, Name: Инфоклиника
2025-05-14 14:29:30,900 - main - INFO - Found 3 business units:
2025-05-14 14:29:30,901 - main - INFO -   ID: 1, Name: ОО ФК "Хадасса Медикал ЛТД"
2025-05-14 14:29:30,901 - main - INFO -   ID: 2, Name: ООО "Медскан"
2025-05-14 14:29:30,901 - main - INFO -   ID: 3, Name: ООО "Клинический госпиталь на Яузе"
2025-05-14 14:29:30,901 - src.connectors.postgres_connector - INFO - Disconnected from PostgreSQL
2025-05-14 14:29:30,901 - main - INFO - Testing patient insertion...
2025-05-14 14:29:30,918 - src.connectors.postgres_connector - INFO - Connected to PostgreSQL
2025-05-14 14:29:30,925 - src.connectors.postgres_connector - INFO - Inserted/updated patient 2698044 with UUID c07329ba-3a38-44ce-8b79-81324177da05
2025-05-14 14:29:30,925 - main - INFO - Sample patient inserted successfully
2025-05-14 14:29:30,927 - main - INFO - Verified patient in database: ID=2698044, UUID=c07329ba-3a38-44ce-8b79-81324177da05, Passport=4512345678
2025-05-14 14:29:30,927 - src.connectors.postgres_connector - INFO - Disconnected from PostgreSQL
2025-05-14 14:29:30,927 - main - WARNING - Skipping Firebird import test due to connection or schema issues
2025-05-14 14:29:30,927 - main - INFO - 
Test Results Summary:
2025-05-14 14:29:30,927 - main - INFO - PostgreSQL Connection: ✓
2025-05-14 14:29:30,928 - main - INFO - Firebird Connection: ✗
2025-05-14 14:29:30,928 - main - INFO - YottaDB Connection: ✗
2025-05-14 14:29:30,928 - main - INFO - PostgreSQL Schema: ✓
2025-05-14 14:29:30,928 - main - INFO - Patient Insertion: ✓
2025-05-14 14:29:30,928 - main - INFO - Firebird Import: ✗
2025-05-14 14:29:30,928 - main - INFO - 
Tests completed.
2025-05-14 14:35:13,713 - main - INFO - Starting tests...
2025-05-14 14:35:13,713 - main - INFO - Testing PostgreSQL connection...
2025-05-14 14:35:13,728 - src.connectors.postgres_connector - INFO - Connected to PostgreSQL
2025-05-14 14:35:13,728 - main - INFO - PostgreSQL connection successful
2025-05-14 14:35:13,729 - main - INFO - PostgreSQL version: PostgreSQL 15.12 (Debian 15.12-0+deb12u2) on x86_64-pc-linux-gnu, compiled by gcc (Debian 12.2.0-14) 12.2.0, 64-bit
2025-05-14 14:35:13,729 - src.connectors.postgres_connector - INFO - Disconnected from PostgreSQL
2025-05-14 14:35:13,730 - main - INFO - Testing Firebird connection...
2025-05-14 14:37:23,940 - src.connectors.firebird_connector - ERROR - Failed to connect to Firebird (Инфоклиника): Unable to complete network request to host "192.168.160.168".
-Failed to establish a connection.
2025-05-14 14:37:23,941 - main - ERROR - Firebird connection failed
2025-05-14 14:37:23,941 - main - INFO - Testing YottaDB connection...
2025-05-14 14:37:23,941 - main - ERROR - YottaDB connection failed
2025-05-14 14:37:23,941 - main - INFO - Testing PostgreSQL schema...
2025-05-14 14:37:23,965 - src.connectors.postgres_connector - INFO - Connected to PostgreSQL
2025-05-14 14:37:23,969 - main - INFO - All essential tables exist
2025-05-14 14:37:23,970 - main - INFO - Found 2 HIS entries:
2025-05-14 14:37:23,970 - main - INFO -   ID: 1, Name: qMS
2025-05-14 14:37:23,970 - main - INFO -   ID: 2, Name: Инфоклиника
2025-05-14 14:37:23,971 - main - INFO - Found 3 business units:
2025-05-14 14:37:23,971 - main - INFO -   ID: 1, Name: ОО ФК "Хадасса Медикал ЛТД"
2025-05-14 14:37:23,971 - main - INFO -   ID: 2, Name: ООО "Медскан"
2025-05-14 14:37:23,971 - main - INFO -   ID: 3, Name: ООО "Клинический госпиталь на Яузе"
2025-05-14 14:37:23,971 - src.connectors.postgres_connector - INFO - Disconnected from PostgreSQL
2025-05-14 14:37:23,971 - main - INFO - Testing patient insertion...
2025-05-14 14:37:23,989 - src.connectors.postgres_connector - INFO - Connected to PostgreSQL
2025-05-14 14:37:24,003 - src.connectors.postgres_connector - INFO - Inserted/updated patient 2698045 with UUID c07329ba-3a38-44ce-8b79-81324177da05
2025-05-14 14:37:24,003 - main - INFO - Sample patient inserted successfully
2025-05-14 14:37:24,006 - main - INFO - Verified patient in database: ID=2698045, UUID=c07329ba-3a38-44ce-8b79-81324177da05, Passport=4512345678
2025-05-14 14:37:24,007 - src.connectors.postgres_connector - INFO - Disconnected from PostgreSQL
2025-05-14 14:37:24,008 - main - WARNING - Skipping Firebird import test due to connection or schema issues
2025-05-14 14:37:24,008 - main - INFO - 
Test Results Summary:
2025-05-14 14:37:24,008 - main - INFO - PostgreSQL Connection: ✓
2025-05-14 14:37:24,008 - main - INFO - Firebird Connection: ✗
2025-05-14 14:37:24,008 - main - INFO - YottaDB Connection: ✗
2025-05-14 14:37:24,008 - main - INFO - PostgreSQL Schema: ✓
2025-05-14 14:37:24,008 - main - INFO - Patient Insertion: ✓
2025-05-14 14:37:24,008 - main - INFO - Firebird Import: ✗
2025-05-14 14:37:24,008 - main - INFO - 
Tests completed.
2025-05-14 14:47:40,577 - main - INFO - Starting tests...
2025-05-14 14:47:40,577 - main - INFO - Testing PostgreSQL connection...
2025-05-14 14:47:40,589 - src.connectors.postgres_connector - INFO - Connected to PostgreSQL
2025-05-14 14:47:40,590 - main - INFO - PostgreSQL connection successful
2025-05-14 14:47:40,590 - main - INFO - PostgreSQL version: PostgreSQL 15.12 (Debian 15.12-0+deb12u2) on x86_64-pc-linux-gnu, compiled by gcc (Debian 12.2.0-14) 12.2.0, 64-bit
2025-05-14 14:47:40,590 - src.connectors.postgres_connector - INFO - Disconnected from PostgreSQL
2025-05-14 14:47:40,591 - main - INFO - Testing Firebird connection...
2025-05-14 14:49:51,456 - src.connectors.firebird_connector - ERROR - Failed to connect to Firebird (Инфоклиника): Unable to complete network request to host "192.168.160.168".
-Failed to establish a connection.
2025-05-14 14:49:51,457 - main - ERROR - Firebird connection failed
2025-05-14 14:49:51,457 - main - INFO - Testing YottaDB connection...
2025-05-14 14:49:51,457 - main - ERROR - YottaDB connection failed
2025-05-14 14:49:51,457 - main - INFO - Testing PostgreSQL schema...
2025-05-14 14:49:51,501 - src.connectors.postgres_connector - INFO - Connected to PostgreSQL
2025-05-14 14:49:51,512 - main - INFO - All essential tables exist
2025-05-14 14:49:51,512 - main - INFO - Found 2 HIS entries:
2025-05-14 14:49:51,512 - main - INFO -   ID: 1, Name: qMS
2025-05-14 14:49:51,512 - main - INFO -   ID: 2, Name: Инфоклиника
2025-05-14 14:49:51,513 - main - INFO - Found 3 business units:
2025-05-14 14:49:51,513 - main - INFO -   ID: 1, Name: ОО ФК "Хадасса Медикал ЛТД"
2025-05-14 14:49:51,513 - main - INFO -   ID: 2, Name: ООО "Медскан"
2025-05-14 14:49:51,513 - main - INFO -   ID: 3, Name: ООО "Клинический госпиталь на Яузе"
2025-05-14 14:49:51,513 - src.connectors.postgres_connector - INFO - Disconnected from PostgreSQL
2025-05-14 14:49:51,514 - main - INFO - Testing patient insertion...
2025-05-14 14:49:51,538 - src.connectors.postgres_connector - INFO - Connected to PostgreSQL
2025-05-14 14:49:51,548 - src.connectors.postgres_connector - INFO - Inserted/updated patient 2698046 with UUID c07329ba-3a38-44ce-8b79-81324177da05
2025-05-14 14:49:51,548 - main - INFO - Sample patient inserted successfully
2025-05-14 14:49:51,549 - main - INFO - Verified patient in database: ID=2698046, UUID=c07329ba-3a38-44ce-8b79-81324177da05, Passport=4512345678
2025-05-14 14:49:51,549 - src.connectors.postgres_connector - INFO - Disconnected from PostgreSQL
2025-05-14 14:49:51,549 - main - WARNING - Skipping Firebird import test due to connection or schema issues
2025-05-14 14:49:51,549 - main - INFO - 
Test Results Summary:
2025-05-14 14:49:51,549 - main - INFO - PostgreSQL Connection: ✓
2025-05-14 14:49:51,549 - main - INFO - Firebird Connection: ✗
2025-05-14 14:49:51,549 - main - INFO - YottaDB Connection: ✗
2025-05-14 14:49:51,549 - main - INFO - PostgreSQL Schema: ✓
2025-05-14 14:49:51,550 - main - INFO - Patient Insertion: ✓
2025-05-14 14:49:51,550 - main - INFO - Firebird Import: ✗
2025-05-14 14:49:51,550 - main - INFO - 
Tests completed.
2025-05-14 14:50:09,292 - main - INFO - Starting tests...
2025-05-14 14:50:09,293 - main - INFO - Testing PostgreSQL connection...
2025-05-14 14:50:09,305 - src.connectors.postgres_connector - INFO - Connected to PostgreSQL
2025-05-14 14:50:09,306 - main - INFO - PostgreSQL connection successful
2025-05-14 14:50:09,306 - main - INFO - PostgreSQL version: PostgreSQL 15.12 (Debian 15.12-0+deb12u2) on x86_64-pc-linux-gnu, compiled by gcc (Debian 12.2.0-14) 12.2.0, 64-bit
2025-05-14 14:50:09,307 - src.connectors.postgres_connector - INFO - Disconnected from PostgreSQL
2025-05-14 14:50:09,307 - main - INFO - Testing Firebird connection...
2025-05-14 14:52:18,912 - src.connectors.firebird_connector - ERROR - Failed to connect to Firebird (Инфоклиника): Unable to complete network request to host "192.168.160.168".
-Failed to establish a connection.
2025-05-14 14:52:18,913 - main - ERROR - Firebird connection failed
2025-05-14 14:52:18,913 - main - INFO - Testing YottaDB connection...
2025-05-14 14:52:18,913 - main - ERROR - YottaDB connection failed
2025-05-14 14:52:18,913 - main - INFO - Testing PostgreSQL schema...
2025-05-14 14:52:18,933 - src.connectors.postgres_connector - INFO - Connected to PostgreSQL
2025-05-14 14:52:18,937 - main - INFO - All essential tables exist
2025-05-14 14:52:18,938 - main - INFO - Found 2 HIS entries:
2025-05-14 14:52:18,938 - main - INFO -   ID: 1, Name: qMS
2025-05-14 14:52:18,938 - main - INFO -   ID: 2, Name: Инфоклиника
2025-05-14 14:52:18,938 - main - INFO - Found 3 business units:
2025-05-14 14:52:18,938 - main - INFO -   ID: 1, Name: ОО ФК "Хадасса Медикал ЛТД"
2025-05-14 14:52:18,938 - main - INFO -   ID: 2, Name: ООО "Медскан"
2025-05-14 14:52:18,938 - main - INFO -   ID: 3, Name: ООО "Клинический госпиталь на Яузе"
2025-05-14 14:52:18,938 - src.connectors.postgres_connector - INFO - Disconnected from PostgreSQL
2025-05-14 14:52:18,938 - main - INFO - Testing patient insertion...
2025-05-14 14:52:18,951 - src.connectors.postgres_connector - INFO - Connected to PostgreSQL
2025-05-14 14:52:18,958 - src.connectors.postgres_connector - INFO - Inserted/updated patient 2698047 with UUID c07329ba-3a38-44ce-8b79-81324177da05
2025-05-14 14:52:18,958 - main - INFO - Sample patient inserted successfully
2025-05-14 14:52:18,959 - main - INFO - Verified patient in database: ID=2698047, UUID=c07329ba-3a38-44ce-8b79-81324177da05, Passport=4512345678
2025-05-14 14:52:18,959 - src.connectors.postgres_connector - INFO - Disconnected from PostgreSQL
2025-05-14 14:52:18,959 - main - WARNING - Skipping Firebird import test due to connection or schema issues
2025-05-14 14:52:18,959 - main - INFO - 
Test Results Summary:
2025-05-14 14:52:18,959 - main - INFO - PostgreSQL Connection: ✓
2025-05-14 14:52:18,959 - main - INFO - Firebird Connection: ✗
2025-05-14 14:52:18,959 - main - INFO - YottaDB Connection: ✗
2025-05-14 14:52:18,959 - main - INFO - PostgreSQL Schema: ✓
2025-05-14 14:52:18,960 - main - INFO - Patient Insertion: ✓
2025-05-14 14:52:18,960 - main - INFO - Firebird Import: ✗
2025-05-14 14:52:18,960 - main - INFO - 
Tests completed.
2025-05-14 15:10:10,729 - main - INFO - Starting tests...
2025-05-14 15:10:10,729 - main - INFO - Testing PostgreSQL connection...
2025-05-14 15:10:10,743 - src.connectors.postgres_connector - INFO - Connected to PostgreSQL
2025-05-14 15:10:10,744 - main - INFO - PostgreSQL connection successful
2025-05-14 15:10:10,744 - main - INFO - PostgreSQL version: PostgreSQL 15.12 (Debian 15.12-0+deb12u2) on x86_64-pc-linux-gnu, compiled by gcc (Debian 12.2.0-14) 12.2.0, 64-bit
2025-05-14 15:10:10,745 - src.connectors.postgres_connector - INFO - Disconnected from PostgreSQL
2025-05-14 15:10:10,745 - main - INFO - Testing Firebird connection...
2025-05-14 15:10:10,745 - main - INFO - Firebird config: {'host': '192.168.160.168:3050', 'database': '099-1', 'user': 'SYSDBA', 'password': 'masterkey', 'charset': 'cp1251', 'debug': True}
2025-05-14 15:10:10,745 - src.connectors.firebird_connector - INFO - Testing TCP connectivity to 192.168.160.168:3050
2025-05-14 15:10:15,747 - src.connectors.firebird_connector - WARNING - TCP connection to 192.168.160.168:3050 failed with error code 11
2025-05-14 15:10:15,748 - src.connectors.firebird_connector - INFO - Attempting to ping 192.168.160.168
2025-05-14 15:10:15,753 - src.connectors.firebird_connector - INFO - Ping result: rtt min/avg/max/mdev = 1.318/1.318/1.318/0.000 ms
2025-05-14 15:10:15,756 - src.connectors.firebird_connector - INFO - Attempting to connect to Firebird at 192.168.160.168:3050, database: /099-1
2025-05-14 15:12:25,184 - src.connectors.firebird_connector - ERROR - Failed to connect to Firebird (Инфоклиника): Unable to complete network request to host "192.168.160.168".
-Failed to establish a connection.
2025-05-14 15:12:25,184 - main - ERROR - Firebird connection failed
2025-05-14 15:12:25,184 - main - INFO - Testing YottaDB connection...
2025-05-14 15:12:25,184 - main - ERROR - YottaDB connection failed
2025-05-14 15:12:25,184 - main - INFO - Testing PostgreSQL schema...
2025-05-14 15:12:25,202 - src.connectors.postgres_connector - INFO - Connected to PostgreSQL
2025-05-14 15:12:25,210 - main - INFO - All essential tables exist
2025-05-14 15:12:25,211 - main - INFO - Found 2 HIS entries:
2025-05-14 15:12:25,212 - main - INFO -   ID: 1, Name: qMS
2025-05-14 15:12:25,212 - main - INFO -   ID: 2, Name: Инфоклиника
2025-05-14 15:12:25,212 - main - INFO - Found 3 business units:
2025-05-14 15:12:25,212 - main - INFO -   ID: 1, Name: ОО ФК "Хадасса Медикал ЛТД"
2025-05-14 15:12:25,212 - main - INFO -   ID: 2, Name: ООО "Медскан"
2025-05-14 15:12:25,212 - main - INFO -   ID: 3, Name: ООО "Клинический госпиталь на Яузе"
2025-05-14 15:12:25,213 - src.connectors.postgres_connector - INFO - Disconnected from PostgreSQL
2025-05-14 15:12:25,213 - main - INFO - Testing patient insertion...
2025-05-14 15:12:25,235 - src.connectors.postgres_connector - INFO - Connected to PostgreSQL
2025-05-14 15:12:25,248 - src.connectors.postgres_connector - INFO - Inserted/updated patient 2698048 with UUID c07329ba-3a38-44ce-8b79-81324177da05
2025-05-14 15:12:25,248 - main - INFO - Sample patient inserted successfully
2025-05-14 15:12:25,249 - main - INFO - Verified patient in database: ID=2698048, UUID=c07329ba-3a38-44ce-8b79-81324177da05, Passport=4512345678
2025-05-14 15:12:25,250 - src.connectors.postgres_connector - INFO - Disconnected from PostgreSQL
2025-05-14 15:12:25,250 - main - WARNING - Skipping Firebird import test due to connection or schema issues
2025-05-14 15:12:25,250 - main - INFO - 
Test Results Summary:
2025-05-14 15:12:25,250 - main - INFO - PostgreSQL Connection: ✓
2025-05-14 15:12:25,250 - main - INFO - Firebird Connection: ✗
2025-05-14 15:12:25,250 - main - INFO - YottaDB Connection: ✗
2025-05-14 15:12:25,250 - main - INFO - PostgreSQL Schema: ✓
2025-05-14 15:12:25,250 - main - INFO - Patient Insertion: ✓
2025-05-14 15:12:25,250 - main - INFO - Firebird Import: ✗
2025-05-14 15:12:25,250 - main - INFO - 
Tests completed.
2025-05-14 15:59:49,775 - main - INFO - Starting tests...
2025-05-14 15:59:49,775 - main - INFO - Testing PostgreSQL connection...
2025-05-14 15:59:49,789 - src.connectors.postgres_connector - INFO - Connected to PostgreSQL
2025-05-14 15:59:49,789 - main - INFO - PostgreSQL connection successful
2025-05-14 15:59:49,789 - main - INFO - PostgreSQL version: PostgreSQL 15.12 (Debian 15.12-0+deb12u2) on x86_64-pc-linux-gnu, compiled by gcc (Debian 12.2.0-14) 12.2.0, 64-bit
2025-05-14 15:59:49,790 - src.connectors.postgres_connector - INFO - Disconnected from PostgreSQL
2025-05-14 15:59:49,790 - main - INFO - Testing Firebird connection...
2025-05-14 15:59:49,790 - main - INFO - Firebird config: {'host': '192.168.160.168:3050', 'database': '099-1', 'user': 'SYSDBA', 'password': 'masterkey', 'charset': 'cp1251', 'debug': True}
2025-05-14 15:59:49,790 - src.connectors.firebird_connector - INFO - Testing TCP connectivity to 192.168.160.168:3050
2025-05-14 15:59:54,791 - src.connectors.firebird_connector - WARNING - TCP connection to 192.168.160.168:3050 failed with error code 11
2025-05-14 15:59:54,792 - src.connectors.firebird_connector - INFO - Attempting to ping 192.168.160.168
2025-05-14 15:59:54,796 - src.connectors.firebird_connector - INFO - Ping result: rtt min/avg/max/mdev = 0.325/0.325/0.325/0.000 ms
2025-05-14 15:59:54,799 - src.connectors.firebird_connector - INFO - Attempting to connect to Firebird at 192.168.160.168:3050, database: /099-1
2025-05-14 16:02:05,024 - src.connectors.firebird_connector - ERROR - Failed to connect to Firebird (Инфоклиника): Unable to complete network request to host "192.168.160.168".
-Failed to establish a connection.
2025-05-14 16:02:05,024 - main - ERROR - Firebird connection failed
2025-05-14 16:02:05,025 - main - INFO - Testing YottaDB connection...
2025-05-14 16:02:05,025 - main - ERROR - YottaDB connection failed
2025-05-14 16:02:05,025 - main - INFO - Testing PostgreSQL schema...
2025-05-14 16:02:05,048 - src.connectors.postgres_connector - INFO - Connected to PostgreSQL
2025-05-14 16:02:05,056 - main - INFO - All essential tables exist
2025-05-14 16:02:05,058 - main - INFO - Found 2 HIS entries:
2025-05-14 16:02:05,058 - main - INFO -   ID: 1, Name: qMS
2025-05-14 16:02:05,058 - main - INFO -   ID: 2, Name: Инфоклиника
2025-05-14 16:02:05,058 - main - INFO - Found 3 business units:
2025-05-14 16:02:05,059 - main - INFO -   ID: 1, Name: ОО ФК "Хадасса Медикал ЛТД"
2025-05-14 16:02:05,059 - main - INFO -   ID: 2, Name: ООО "Медскан"
2025-05-14 16:02:05,059 - main - INFO -   ID: 3, Name: ООО "Клинический госпиталь на Яузе"
2025-05-14 16:02:05,059 - src.connectors.postgres_connector - INFO - Disconnected from PostgreSQL
2025-05-14 16:02:05,060 - main - INFO - Testing patient insertion...
2025-05-14 16:02:05,083 - src.connectors.postgres_connector - INFO - Connected to PostgreSQL
2025-05-14 16:02:05,096 - src.connectors.postgres_connector - INFO - Inserted/updated patient 2698049 with UUID c07329ba-3a38-44ce-8b79-81324177da05
2025-05-14 16:02:05,096 - main - INFO - Sample patient inserted successfully
2025-05-14 16:02:05,099 - main - INFO - Verified patient in database: ID=2698049, UUID=c07329ba-3a38-44ce-8b79-81324177da05, Passport=4512345678
2025-05-14 16:02:05,100 - src.connectors.postgres_connector - INFO - Disconnected from PostgreSQL
2025-05-14 16:02:05,100 - main - WARNING - Skipping Firebird import test due to connection or schema issues
2025-05-14 16:02:05,100 - main - INFO - 
Test Results Summary:
2025-05-14 16:02:05,100 - main - INFO - PostgreSQL Connection: ✓
2025-05-14 16:02:05,100 - main - INFO - Firebird Connection: ✗
2025-05-14 16:02:05,100 - main - INFO - YottaDB Connection: ✗
2025-05-14 16:02:05,100 - main - INFO - PostgreSQL Schema: ✓
2025-05-14 16:02:05,100 - main - INFO - Patient Insertion: ✓
2025-05-14 16:02:05,100 - main - INFO - Firebird Import: ✗
2025-05-14 16:02:05,100 - main - INFO - 
Tests completed.
2025-05-14 16:52:39,250 - main - INFO - Starting tests...
2025-05-14 16:52:39,250 - main - INFO - Testing PostgreSQL connection...
2025-05-14 16:52:39,263 - src.connectors.postgres_connector - INFO - Connected to PostgreSQL
2025-05-14 16:52:39,263 - main - INFO - PostgreSQL connection successful
2025-05-14 16:52:39,263 - main - INFO - PostgreSQL version: PostgreSQL 15.12 (Debian 15.12-0+deb12u2) on x86_64-pc-linux-gnu, compiled by gcc (Debian 12.2.0-14) 12.2.0, 64-bit
2025-05-14 16:52:39,264 - src.connectors.postgres_connector - INFO - Disconnected from PostgreSQL
2025-05-14 16:52:39,264 - main - INFO - Testing Firebird connection...
2025-05-14 16:52:39,264 - main - INFO - Firebird config: {'host': '192.168.160.40:3050', 'database': 'somebase', 'user': 'SYSDBA', 'password': 'masterkey', 'charset': 'cp1251', 'debug': True}
2025-05-14 16:52:39,264 - src.connectors.firebird_connector - INFO - Testing TCP connectivity to 192.168.160.40:3050
2025-05-14 16:52:39,265 - src.connectors.firebird_connector - INFO - TCP connection to 192.168.160.40:3050 successful
2025-05-14 16:52:39,266 - src.connectors.firebird_connector - INFO - Attempting to connect to Firebird at 192.168.160.40:3050, database: /somebase
2025-05-14 16:52:39,374 - src.connectors.firebird_connector - ERROR - Failed to connect to Firebird (Инфоклиника): I/O error during "CreateFile (open)" operation for file "/somebase"
-Error while trying to open file
-�� ������� ����� ��������� ����. 
2025-05-14 16:52:39,374 - main - ERROR - Firebird connection failed
2025-05-14 16:52:39,375 - main - INFO - Testing YottaDB connection...
2025-05-14 16:52:39,375 - main - ERROR - YottaDB connection failed
2025-05-14 16:52:39,375 - main - INFO - Testing PostgreSQL schema...
2025-05-14 16:52:39,416 - src.connectors.postgres_connector - INFO - Connected to PostgreSQL
2025-05-14 16:52:39,423 - main - INFO - All essential tables exist
2025-05-14 16:52:39,424 - main - INFO - Found 2 HIS entries:
2025-05-14 16:52:39,424 - main - INFO -   ID: 1, Name: qMS
2025-05-14 16:52:39,424 - main - INFO -   ID: 2, Name: Инфоклиника
2025-05-14 16:52:39,424 - main - INFO - Found 3 business units:
2025-05-14 16:52:39,424 - main - INFO -   ID: 1, Name: ОО ФК "Хадасса Медикал ЛТД"
2025-05-14 16:52:39,424 - main - INFO -   ID: 2, Name: ООО "Медскан"
2025-05-14 16:52:39,425 - main - INFO -   ID: 3, Name: ООО "Клинический госпиталь на Яузе"
2025-05-14 16:52:39,425 - src.connectors.postgres_connector - INFO - Disconnected from PostgreSQL
2025-05-14 16:52:39,425 - main - INFO - Testing patient insertion...
2025-05-14 16:52:39,445 - src.connectors.postgres_connector - INFO - Connected to PostgreSQL
2025-05-14 16:52:39,453 - src.connectors.postgres_connector - INFO - Inserted/updated patient 2698050 with UUID c07329ba-3a38-44ce-8b79-81324177da05
2025-05-14 16:52:39,454 - main - INFO - Sample patient inserted successfully
2025-05-14 16:52:39,456 - main - INFO - Verified patient in database: ID=2698050, UUID=c07329ba-3a38-44ce-8b79-81324177da05, Passport=4512345678
2025-05-14 16:52:39,457 - src.connectors.postgres_connector - INFO - Disconnected from PostgreSQL
2025-05-14 16:52:39,457 - main - WARNING - Skipping Firebird import test due to connection or schema issues
2025-05-14 16:52:39,457 - main - INFO - 
Test Results Summary:
2025-05-14 16:52:39,457 - main - INFO - PostgreSQL Connection: ✓
2025-05-14 16:52:39,457 - main - INFO - Firebird Connection: ✗
2025-05-14 16:52:39,457 - main - INFO - YottaDB Connection: ✗
2025-05-14 16:52:39,458 - main - INFO - PostgreSQL Schema: ✓
2025-05-14 16:52:39,458 - main - INFO - Patient Insertion: ✓
2025-05-14 16:52:39,458 - main - INFO - Firebird Import: ✗
2025-05-14 16:52:39,458 - main - INFO - 
Tests completed.
2025-05-14 17:01:43,552 - main - INFO - Starting tests...
2025-05-14 17:01:43,552 - main - INFO - Testing PostgreSQL connection...
2025-05-14 17:01:43,565 - src.connectors.postgres_connector - INFO - Connected to PostgreSQL
2025-05-14 17:01:43,565 - main - INFO - PostgreSQL connection successful
2025-05-14 17:01:43,566 - main - INFO - PostgreSQL version: PostgreSQL 15.12 (Debian 15.12-0+deb12u2) on x86_64-pc-linux-gnu, compiled by gcc (Debian 12.2.0-14) 12.2.0, 64-bit
2025-05-14 17:01:43,566 - src.connectors.postgres_connector - INFO - Disconnected from PostgreSQL
2025-05-14 17:01:43,566 - main - INFO - Testing Firebird connection...
2025-05-14 17:01:43,566 - main - INFO - Firebird config: {'host': '192.168.160.168:3050', 'database': '099-1', 'user': 'SYSDBA', 'password': 'masterkey', 'charset': 'cp1251', 'debug': True}
2025-05-14 17:01:43,566 - src.connectors.firebird_connector - INFO - Testing TCP connectivity to 192.168.160.168:3050
2025-05-14 17:01:43,567 - src.connectors.firebird_connector - INFO - TCP connection to 192.168.160.168:3050 successful
2025-05-14 17:01:43,568 - src.connectors.firebird_connector - INFO - Attempting to connect to Firebird at 192.168.160.168:3050, database: /099-1
2025-05-14 17:01:43,600 - src.connectors.firebird_connector - ERROR - Failed to connect to Firebird (Инфоклиника): I/O error during "CreateFile (open)" operation for file "/099-1"
-Error while trying to open file
-�� ������� ����� ��������� ����. 
2025-05-14 17:01:43,601 - main - ERROR - Firebird connection failed
2025-05-14 17:01:43,601 - main - INFO - Testing YottaDB connection...
2025-05-14 17:01:43,601 - main - ERROR - YottaDB connection failed
2025-05-14 17:01:43,601 - main - INFO - Testing PostgreSQL schema...
2025-05-14 17:01:43,616 - src.connectors.postgres_connector - INFO - Connected to PostgreSQL
2025-05-14 17:01:43,622 - main - INFO - All essential tables exist
2025-05-14 17:01:43,622 - main - INFO - Found 2 HIS entries:
2025-05-14 17:01:43,622 - main - INFO -   ID: 1, Name: qMS
2025-05-14 17:01:43,622 - main - INFO -   ID: 2, Name: Инфоклиника
2025-05-14 17:01:43,623 - main - INFO - Found 3 business units:
2025-05-14 17:01:43,623 - main - INFO -   ID: 1, Name: ОО ФК "Хадасса Медикал ЛТД"
2025-05-14 17:01:43,623 - main - INFO -   ID: 2, Name: ООО "Медскан"
2025-05-14 17:01:43,623 - main - INFO -   ID: 3, Name: ООО "Клинический госпиталь на Яузе"
2025-05-14 17:01:43,623 - src.connectors.postgres_connector - INFO - Disconnected from PostgreSQL
2025-05-14 17:01:43,623 - main - INFO - Testing patient insertion...
2025-05-14 17:01:43,639 - src.connectors.postgres_connector - INFO - Connected to PostgreSQL
2025-05-14 17:01:43,648 - src.connectors.postgres_connector - INFO - Inserted/updated patient 2698051 with UUID c07329ba-3a38-44ce-8b79-81324177da05
2025-05-14 17:01:43,648 - main - INFO - Sample patient inserted successfully
2025-05-14 17:01:43,649 - main - INFO - Verified patient in database: ID=2698051, UUID=c07329ba-3a38-44ce-8b79-81324177da05, Passport=4512345678
2025-05-14 17:01:43,649 - src.connectors.postgres_connector - INFO - Disconnected from PostgreSQL
2025-05-14 17:01:43,649 - main - WARNING - Skipping Firebird import test due to connection or schema issues
2025-05-14 17:01:43,649 - main - INFO - 
Test Results Summary:
2025-05-14 17:01:43,649 - main - INFO - PostgreSQL Connection: ✓
2025-05-14 17:01:43,649 - main - INFO - Firebird Connection: ✗
2025-05-14 17:01:43,649 - main - INFO - YottaDB Connection: ✗
2025-05-14 17:01:43,649 - main - INFO - PostgreSQL Schema: ✓
2025-05-14 17:01:43,649 - main - INFO - Patient Insertion: ✓
2025-05-14 17:01:43,649 - main - INFO - Firebird Import: ✗
2025-05-14 17:01:43,650 - main - INFO - 
Tests completed.
2025-05-14 17:06:22,615 - main - INFO - Starting tests...
2025-05-14 17:06:22,615 - main - INFO - Testing PostgreSQL connection...
2025-05-14 17:06:22,628 - src.connectors.postgres_connector - INFO - Connected to PostgreSQL
2025-05-14 17:06:22,629 - main - INFO - PostgreSQL connection successful
2025-05-14 17:06:22,629 - main - INFO - PostgreSQL version: PostgreSQL 15.12 (Debian 15.12-0+deb12u2) on x86_64-pc-linux-gnu, compiled by gcc (Debian 12.2.0-14) 12.2.0, 64-bit
2025-05-14 17:06:22,630 - src.connectors.postgres_connector - INFO - Disconnected from PostgreSQL
2025-05-14 17:06:22,630 - main - INFO - Testing Firebird connection...
2025-05-14 17:06:22,630 - main - INFO - Firebird config: {'host': '192.168.160.168:3050', 'database': '099-1', 'user': 'SYSDBA', 'password': 'masterkey', 'charset': 'cp1251', 'debug': True}
2025-05-14 17:06:22,630 - src.connectors.firebird_connector - INFO - Testing TCP connectivity to 192.168.160.168:3050
2025-05-14 17:06:22,631 - src.connectors.firebird_connector - INFO - TCP connection to 192.168.160.168:3050 successful
2025-05-14 17:06:22,632 - src.connectors.firebird_connector - INFO - Attempting to connect to Firebird at 192.168.160.168:3050, database: /099-1
2025-05-14 17:06:22,667 - src.connectors.firebird_connector - ERROR - Failed to connect to Firebird (Инфоклиника): I/O error during "CreateFile (open)" operation for file "/099-1"
-Error while trying to open file
-�� ������� ����� ��������� ����. 
2025-05-14 17:06:22,667 - main - ERROR - Firebird connection failed
2025-05-14 17:06:22,667 - main - INFO - Testing YottaDB connection...
2025-05-14 17:06:22,667 - main - ERROR - YottaDB connection failed
2025-05-14 17:06:22,667 - main - INFO - Testing PostgreSQL schema...
2025-05-14 17:06:22,680 - src.connectors.postgres_connector - INFO - Connected to PostgreSQL
2025-05-14 17:06:22,685 - main - INFO - All essential tables exist
2025-05-14 17:06:22,685 - main - INFO - Found 2 HIS entries:
2025-05-14 17:06:22,686 - main - INFO -   ID: 1, Name: qMS
2025-05-14 17:06:22,686 - main - INFO -   ID: 2, Name: Инфоклиника
2025-05-14 17:06:22,686 - main - INFO - Found 3 business units:
2025-05-14 17:06:22,686 - main - INFO -   ID: 1, Name: ОО ФК "Хадасса Медикал ЛТД"
2025-05-14 17:06:22,686 - main - INFO -   ID: 2, Name: ООО "Медскан"
2025-05-14 17:06:22,686 - main - INFO -   ID: 3, Name: ООО "Клинический госпиталь на Яузе"
2025-05-14 17:06:22,686 - src.connectors.postgres_connector - INFO - Disconnected from PostgreSQL
2025-05-14 17:06:22,686 - main - INFO - Testing patient insertion...
2025-05-14 17:06:22,703 - src.connectors.postgres_connector - INFO - Connected to PostgreSQL
2025-05-14 17:06:22,711 - src.connectors.postgres_connector - INFO - Inserted/updated patient 2698052 with UUID c07329ba-3a38-44ce-8b79-81324177da05
2025-05-14 17:06:22,712 - main - INFO - Sample patient inserted successfully
2025-05-14 17:06:22,713 - main - INFO - Verified patient in database: ID=2698052, UUID=c07329ba-3a38-44ce-8b79-81324177da05, Passport=4512345678
2025-05-14 17:06:22,713 - src.connectors.postgres_connector - INFO - Disconnected from PostgreSQL
2025-05-14 17:06:22,713 - main - WARNING - Skipping Firebird import test due to connection or schema issues
2025-05-14 17:06:22,713 - main - INFO - 
Test Results Summary:
2025-05-14 17:06:22,713 - main - INFO - PostgreSQL Connection: ✓
2025-05-14 17:06:22,713 - main - INFO - Firebird Connection: ✗
2025-05-14 17:06:22,713 - main - INFO - YottaDB Connection: ✗
2025-05-14 17:06:22,713 - main - INFO - PostgreSQL Schema: ✓
2025-05-14 17:06:22,713 - main - INFO - Patient Insertion: ✓
2025-05-14 17:06:22,713 - main - INFO - Firebird Import: ✗
2025-05-14 17:06:22,713 - main - INFO - 
Tests completed.
2025-05-14 18:06:05,066 - main - INFO - Starting tests...
2025-05-14 18:06:05,066 - main - INFO - Testing PostgreSQL connection...
2025-05-14 18:06:05,080 - src.connectors.postgres_connector - INFO - Connected to PostgreSQL
2025-05-14 18:06:05,080 - main - INFO - PostgreSQL connection successful
2025-05-14 18:06:05,081 - main - INFO - PostgreSQL version: PostgreSQL 15.12 (Debian 15.12-0+deb12u2) on x86_64-pc-linux-gnu, compiled by gcc (Debian 12.2.0-14) 12.2.0, 64-bit
2025-05-14 18:06:05,082 - src.connectors.postgres_connector - INFO - Disconnected from PostgreSQL
2025-05-14 18:06:05,082 - main - INFO - Testing Firebird connection...
2025-05-14 18:06:05,082 - main - INFO - Firebird config: {'host': '192.168.160.168:3050', 'database': '099-1', 'user': 'SYSDBA', 'password': 'masterkey', 'charset': 'cp1251', 'debug': True}
2025-05-14 18:06:05,082 - src.connectors.firebird_connector - INFO - Testing TCP connectivity to 192.168.160.168:3050
2025-05-14 18:06:05,083 - src.connectors.firebird_connector - INFO - TCP connection to 192.168.160.168:3050 successful
2025-05-14 18:06:05,087 - src.connectors.firebird_connector - INFO - Attempting to connect to Firebird at 192.168.160.168:3050, database: /099-1
2025-05-14 18:06:05,131 - src.connectors.firebird_connector - ERROR - Failed to connect to Firebird (Инфоклиника): I/O error during "CreateFile (open)" operation for file "/099-1"
-Error while trying to open file
-�� ������� ����� ��������� ����. 
2025-05-14 18:06:05,132 - main - ERROR - Firebird connection failed
2025-05-14 18:06:05,132 - main - INFO - Testing YottaDB connection...
2025-05-14 18:06:05,132 - main - ERROR - YottaDB connection failed
2025-05-14 18:06:05,132 - main - INFO - Testing PostgreSQL schema...
2025-05-14 18:06:05,164 - src.connectors.postgres_connector - INFO - Connected to PostgreSQL
2025-05-14 18:06:05,170 - main - INFO - All essential tables exist
2025-05-14 18:06:05,170 - main - INFO - Found 2 HIS entries:
2025-05-14 18:06:05,170 - main - INFO -   ID: 1, Name: qMS
2025-05-14 18:06:05,170 - main - INFO -   ID: 2, Name: Инфоклиника
2025-05-14 18:06:05,171 - main - INFO - Found 3 business units:
2025-05-14 18:06:05,171 - main - INFO -   ID: 1, Name: ОО ФК "Хадасса Медикал ЛТД"
2025-05-14 18:06:05,171 - main - INFO -   ID: 2, Name: ООО "Медскан"
2025-05-14 18:06:05,171 - main - INFO -   ID: 3, Name: ООО "Клинический госпиталь на Яузе"
2025-05-14 18:06:05,171 - src.connectors.postgres_connector - INFO - Disconnected from PostgreSQL
2025-05-14 18:06:05,171 - main - INFO - Testing patient insertion...
2025-05-14 18:06:05,191 - src.connectors.postgres_connector - INFO - Connected to PostgreSQL
2025-05-14 18:06:05,201 - src.connectors.postgres_connector - INFO - Inserted/updated patient 2698053 with UUID c07329ba-3a38-44ce-8b79-81324177da05
2025-05-14 18:06:05,201 - main - INFO - Sample patient inserted successfully
2025-05-14 18:06:05,202 - main - INFO - Verified patient in database: ID=2698053, UUID=c07329ba-3a38-44ce-8b79-81324177da05, Passport=4512345678
2025-05-14 18:06:05,202 - src.connectors.postgres_connector - INFO - Disconnected from PostgreSQL
2025-05-14 18:06:05,202 - main - WARNING - Skipping Firebird import test due to connection or schema issues
2025-05-14 18:06:05,202 - main - INFO - 
Test Results Summary:
2025-05-14 18:06:05,203 - main - INFO - PostgreSQL Connection: ✓
2025-05-14 18:06:05,203 - main - INFO - Firebird Connection: ✗
2025-05-14 18:06:05,203 - main - INFO - YottaDB Connection: ✗
2025-05-14 18:06:05,203 - main - INFO - PostgreSQL Schema: ✓
2025-05-14 18:06:05,203 - main - INFO - Patient Insertion: ✓
2025-05-14 18:06:05,203 - main - INFO - Firebird Import: ✗
2025-05-14 18:06:05,203 - main - INFO - 
Tests completed.
2025-05-14 18:07:40,640 - main - INFO - Starting tests...
2025-05-14 18:07:40,640 - main - INFO - Testing PostgreSQL connection...
2025-05-14 18:07:40,653 - src.connectors.postgres_connector - INFO - Connected to PostgreSQL
2025-05-14 18:07:40,653 - main - INFO - PostgreSQL connection successful
2025-05-14 18:07:40,654 - main - INFO - PostgreSQL version: PostgreSQL 15.12 (Debian 15.12-0+deb12u2) on x86_64-pc-linux-gnu, compiled by gcc (Debian 12.2.0-14) 12.2.0, 64-bit
2025-05-14 18:07:40,654 - src.connectors.postgres_connector - INFO - Disconnected from PostgreSQL
2025-05-14 18:07:40,655 - main - INFO - Testing Firebird connection...
2025-05-14 18:07:40,655 - main - INFO - Firebird config: {'host': '192.168.160.168:3050', 'database': 'C:\\Firebird_DB\x0099-1.fdb', 'user': 'SYSDBA', 'password': 'masterkey', 'charset': 'cp1251', 'debug': True}
2025-05-14 18:07:40,655 - src.connectors.firebird_connector - INFO - Testing TCP connectivity to 192.168.160.168:3050
2025-05-14 18:07:40,656 - src.connectors.firebird_connector - INFO - TCP connection to 192.168.160.168:3050 successful
2025-05-14 18:07:40,657 - src.connectors.firebird_connector - INFO - Attempting to connect to Firebird at 192.168.160.168:3050, database: /C:\Firebird_DB 99-1.fdb
2025-05-14 18:07:40,683 - src.connectors.firebird_connector - ERROR - Failed to connect to Firebird (Инфоклиника): unavailable database
2025-05-14 18:07:40,683 - main - ERROR - Firebird connection failed
2025-05-14 18:07:40,683 - main - INFO - Testing YottaDB connection...
2025-05-14 18:07:40,683 - main - ERROR - YottaDB connection failed
2025-05-14 18:07:40,683 - main - INFO - Testing PostgreSQL schema...
2025-05-14 18:07:40,698 - src.connectors.postgres_connector - INFO - Connected to PostgreSQL
2025-05-14 18:07:40,704 - main - INFO - All essential tables exist
2025-05-14 18:07:40,704 - main - INFO - Found 2 HIS entries:
2025-05-14 18:07:40,704 - main - INFO -   ID: 1, Name: qMS
2025-05-14 18:07:40,704 - main - INFO -   ID: 2, Name: Инфоклиника
2025-05-14 18:07:40,704 - main - INFO - Found 3 business units:
2025-05-14 18:07:40,704 - main - INFO -   ID: 1, Name: ОО ФК "Хадасса Медикал ЛТД"
2025-05-14 18:07:40,704 - main - INFO -   ID: 2, Name: ООО "Медскан"
2025-05-14 18:07:40,704 - main - INFO -   ID: 3, Name: ООО "Клинический госпиталь на Яузе"
2025-05-14 18:07:40,705 - src.connectors.postgres_connector - INFO - Disconnected from PostgreSQL
2025-05-14 18:07:40,705 - main - INFO - Testing patient insertion...
2025-05-14 18:07:40,720 - src.connectors.postgres_connector - INFO - Connected to PostgreSQL
2025-05-14 18:07:40,737 - src.connectors.postgres_connector - INFO - Inserted/updated patient 2698054 with UUID c07329ba-3a38-44ce-8b79-81324177da05
2025-05-14 18:07:40,737 - main - INFO - Sample patient inserted successfully
2025-05-14 18:07:40,738 - main - INFO - Verified patient in database: ID=2698054, UUID=c07329ba-3a38-44ce-8b79-81324177da05, Passport=4512345678
2025-05-14 18:07:40,738 - src.connectors.postgres_connector - INFO - Disconnected from PostgreSQL
2025-05-14 18:07:40,738 - main - WARNING - Skipping Firebird import test due to connection or schema issues
2025-05-14 18:07:40,738 - main - INFO - 
Test Results Summary:
2025-05-14 18:07:40,738 - main - INFO - PostgreSQL Connection: ✓
2025-05-14 18:07:40,738 - main - INFO - Firebird Connection: ✗
2025-05-14 18:07:40,738 - main - INFO - YottaDB Connection: ✗
2025-05-14 18:07:40,738 - main - INFO - PostgreSQL Schema: ✓
2025-05-14 18:07:40,739 - main - INFO - Patient Insertion: ✓
2025-05-14 18:07:40,739 - main - INFO - Firebird Import: ✗
2025-05-14 18:07:40,739 - main - INFO - 
Tests completed.
2025-05-14 18:07:50,771 - main - INFO - Starting tests...
2025-05-14 18:07:50,771 - main - INFO - Testing PostgreSQL connection...
2025-05-14 18:07:50,783 - src.connectors.postgres_connector - INFO - Connected to PostgreSQL
2025-05-14 18:07:50,784 - main - INFO - PostgreSQL connection successful
2025-05-14 18:07:50,784 - main - INFO - PostgreSQL version: PostgreSQL 15.12 (Debian 15.12-0+deb12u2) on x86_64-pc-linux-gnu, compiled by gcc (Debian 12.2.0-14) 12.2.0, 64-bit
2025-05-14 18:07:50,785 - src.connectors.postgres_connector - INFO - Disconnected from PostgreSQL
2025-05-14 18:07:50,785 - main - INFO - Testing Firebird connection...
2025-05-14 18:07:50,785 - main - INFO - Firebird config: {'host': '192.168.160.168:3050', 'database': 'C:\\Firebird_DB\x0099-1.fdb', 'user': 'SYSDBA', 'password': 'masterkey', 'charset': 'cp1251', 'debug': True}
2025-05-14 18:07:50,785 - src.connectors.firebird_connector - INFO - Testing TCP connectivity to 192.168.160.168:3050
2025-05-14 18:07:50,786 - src.connectors.firebird_connector - INFO - TCP connection to 192.168.160.168:3050 successful
2025-05-14 18:07:50,787 - src.connectors.firebird_connector - INFO - Attempting to connect to Firebird at 192.168.160.168:3050, database: /C:\Firebird_DB 99-1.fdb
2025-05-14 18:07:50,835 - src.connectors.firebird_connector - ERROR - Failed to connect to Firebird (Инфоклиника): unavailable database
2025-05-14 18:07:50,835 - main - ERROR - Firebird connection failed
2025-05-14 18:07:50,835 - main - INFO - Testing YottaDB connection...
2025-05-14 18:07:50,836 - main - ERROR - YottaDB connection failed
2025-05-14 18:07:50,836 - main - INFO - Testing PostgreSQL schema...
2025-05-14 18:07:50,871 - src.connectors.postgres_connector - INFO - Connected to PostgreSQL
2025-05-14 18:07:50,880 - main - INFO - All essential tables exist
2025-05-14 18:07:50,881 - main - INFO - Found 2 HIS entries:
2025-05-14 18:07:50,881 - main - INFO -   ID: 1, Name: qMS
2025-05-14 18:07:50,881 - main - INFO -   ID: 2, Name: Инфоклиника
2025-05-14 18:07:50,881 - main - INFO - Found 3 business units:
2025-05-14 18:07:50,882 - main - INFO -   ID: 1, Name: ОО ФК "Хадасса Медикал ЛТД"
2025-05-14 18:07:50,882 - main - INFO -   ID: 2, Name: ООО "Медскан"
2025-05-14 18:07:50,882 - main - INFO -   ID: 3, Name: ООО "Клинический госпиталь на Яузе"
2025-05-14 18:07:50,882 - src.connectors.postgres_connector - INFO - Disconnected from PostgreSQL
2025-05-14 18:07:50,882 - main - INFO - Testing patient insertion...
2025-05-14 18:07:50,911 - src.connectors.postgres_connector - INFO - Connected to PostgreSQL
2025-05-14 18:07:50,920 - src.connectors.postgres_connector - INFO - Inserted/updated patient 2698055 with UUID c07329ba-3a38-44ce-8b79-81324177da05
2025-05-14 18:07:50,920 - main - INFO - Sample patient inserted successfully
2025-05-14 18:07:50,921 - main - INFO - Verified patient in database: ID=2698055, UUID=c07329ba-3a38-44ce-8b79-81324177da05, Passport=4512345678
2025-05-14 18:07:50,921 - src.connectors.postgres_connector - INFO - Disconnected from PostgreSQL
2025-05-14 18:07:50,921 - main - WARNING - Skipping Firebird import test due to connection or schema issues
2025-05-14 18:07:50,921 - main - INFO - 
Test Results Summary:
2025-05-14 18:07:50,922 - main - INFO - PostgreSQL Connection: ✓
2025-05-14 18:07:50,922 - main - INFO - Firebird Connection: ✗
2025-05-14 18:07:50,922 - main - INFO - YottaDB Connection: ✗
2025-05-14 18:07:50,922 - main - INFO - PostgreSQL Schema: ✓
2025-05-14 18:07:50,922 - main - INFO - Patient Insertion: ✓
2025-05-14 18:07:50,922 - main - INFO - Firebird Import: ✗
2025-05-14 18:07:50,922 - main - INFO - 
Tests completed.
2025-05-14 18:08:18,427 - main - INFO - Starting tests...
2025-05-14 18:08:18,427 - main - INFO - Testing PostgreSQL connection...
2025-05-14 18:08:18,441 - src.connectors.postgres_connector - INFO - Connected to PostgreSQL
2025-05-14 18:08:18,441 - main - INFO - PostgreSQL connection successful
2025-05-14 18:08:18,442 - main - INFO - PostgreSQL version: PostgreSQL 15.12 (Debian 15.12-0+deb12u2) on x86_64-pc-linux-gnu, compiled by gcc (Debian 12.2.0-14) 12.2.0, 64-bit
2025-05-14 18:08:18,442 - src.connectors.postgres_connector - INFO - Disconnected from PostgreSQL
2025-05-14 18:08:18,442 - main - INFO - Testing Firebird connection...
2025-05-14 18:08:18,442 - main - INFO - Firebird config: {'host': '192.168.160.168:3050', 'database': 'C:\\Firebird_DB\\099-1.fdb', 'user': 'SYSDBA', 'password': 'masterkey', 'charset': 'cp1251', 'debug': True}
2025-05-14 18:08:18,442 - src.connectors.firebird_connector - INFO - Testing TCP connectivity to 192.168.160.168:3050
2025-05-14 18:08:18,443 - src.connectors.firebird_connector - INFO - TCP connection to 192.168.160.168:3050 successful
2025-05-14 18:08:18,444 - src.connectors.firebird_connector - INFO - Attempting to connect to Firebird at 192.168.160.168:3050, database: /C:\Firebird_DB\099-1.fdb
2025-05-14 18:08:18,487 - src.connectors.firebird_connector - ERROR - Failed to connect to Firebird (Инфоклиника): unavailable database
2025-05-14 18:08:18,487 - main - ERROR - Firebird connection failed
2025-05-14 18:08:18,488 - main - INFO - Testing YottaDB connection...
2025-05-14 18:08:18,488 - main - ERROR - YottaDB connection failed
2025-05-14 18:08:18,488 - main - INFO - Testing PostgreSQL schema...
2025-05-14 18:08:18,502 - src.connectors.postgres_connector - INFO - Connected to PostgreSQL
2025-05-14 18:08:18,507 - main - INFO - All essential tables exist
2025-05-14 18:08:18,508 - main - INFO - Found 2 HIS entries:
2025-05-14 18:08:18,508 - main - INFO -   ID: 1, Name: qMS
2025-05-14 18:08:18,508 - main - INFO -   ID: 2, Name: Инфоклиника
2025-05-14 18:08:18,508 - main - INFO - Found 3 business units:
2025-05-14 18:08:18,508 - main - INFO -   ID: 1, Name: ОО ФК "Хадасса Медикал ЛТД"
2025-05-14 18:08:18,508 - main - INFO -   ID: 2, Name: ООО "Медскан"
2025-05-14 18:08:18,508 - main - INFO -   ID: 3, Name: ООО "Клинический госпиталь на Яузе"
2025-05-14 18:08:18,509 - src.connectors.postgres_connector - INFO - Disconnected from PostgreSQL
2025-05-14 18:08:18,509 - main - INFO - Testing patient insertion...
2025-05-14 18:08:18,524 - src.connectors.postgres_connector - INFO - Connected to PostgreSQL
2025-05-14 18:08:18,534 - src.connectors.postgres_connector - INFO - Inserted/updated patient 2698056 with UUID c07329ba-3a38-44ce-8b79-81324177da05
2025-05-14 18:08:18,535 - main - INFO - Sample patient inserted successfully
2025-05-14 18:08:18,536 - main - INFO - Verified patient in database: ID=2698056, UUID=c07329ba-3a38-44ce-8b79-81324177da05, Passport=4512345678
2025-05-14 18:08:18,536 - src.connectors.postgres_connector - INFO - Disconnected from PostgreSQL
2025-05-14 18:08:18,536 - main - WARNING - Skipping Firebird import test due to connection or schema issues
2025-05-14 18:08:18,536 - main - INFO - 
Test Results Summary:
2025-05-14 18:08:18,536 - main - INFO - PostgreSQL Connection: ✓
2025-05-14 18:08:18,536 - main - INFO - Firebird Connection: ✗
2025-05-14 18:08:18,536 - main - INFO - YottaDB Connection: ✗
2025-05-14 18:08:18,536 - main - INFO - PostgreSQL Schema: ✓
2025-05-14 18:08:18,536 - main - INFO - Patient Insertion: ✓
2025-05-14 18:08:18,536 - main - INFO - Firebird Import: ✗
2025-05-14 18:08:18,537 - main - INFO - 
Tests completed.
2025-05-14 18:08:56,356 - main - INFO - Starting tests...
2025-05-14 18:08:56,356 - main - INFO - Testing PostgreSQL connection...
2025-05-14 18:08:56,368 - src.connectors.postgres_connector - INFO - Connected to PostgreSQL
2025-05-14 18:08:56,369 - main - INFO - PostgreSQL connection successful
2025-05-14 18:08:56,369 - main - INFO - PostgreSQL version: PostgreSQL 15.12 (Debian 15.12-0+deb12u2) on x86_64-pc-linux-gnu, compiled by gcc (Debian 12.2.0-14) 12.2.0, 64-bit
2025-05-14 18:08:56,370 - src.connectors.postgres_connector - INFO - Disconnected from PostgreSQL
2025-05-14 18:08:56,370 - main - INFO - Testing Firebird connection...
2025-05-14 18:08:56,370 - main - INFO - Firebird config: {'host': '192.168.160.40:3050', 'database': '099', 'user': 'SYSDBA', 'password': 'masterkey', 'charset': 'cp1251', 'debug': True}
2025-05-14 18:08:56,370 - src.connectors.firebird_connector - INFO - Testing TCP connectivity to 192.168.160.40:3050
2025-05-14 18:08:56,371 - src.connectors.firebird_connector - INFO - TCP connection to 192.168.160.40:3050 successful
2025-05-14 18:08:56,372 - src.connectors.firebird_connector - INFO - Attempting to connect to Firebird at 192.168.160.40:3050, database: /099
2025-05-14 18:08:56,436 - src.connectors.firebird_connector - ERROR - Failed to connect to Firebird (Инфоклиника): I/O error during "CreateFile (open)" operation for file "/099"
-Error while trying to open file
-�� ������� ����� ��������� ����. 
2025-05-14 18:08:56,437 - main - ERROR - Firebird connection failed
2025-05-14 18:08:56,437 - main - INFO - Testing YottaDB connection...
2025-05-14 18:08:56,437 - main - ERROR - YottaDB connection failed
2025-05-14 18:08:56,437 - main - INFO - Testing PostgreSQL schema...
2025-05-14 18:08:56,456 - src.connectors.postgres_connector - INFO - Connected to PostgreSQL
2025-05-14 18:08:56,462 - main - INFO - All essential tables exist
2025-05-14 18:08:56,463 - main - INFO - Found 2 HIS entries:
2025-05-14 18:08:56,463 - main - INFO -   ID: 1, Name: qMS
2025-05-14 18:08:56,463 - main - INFO -   ID: 2, Name: Инфоклиника
2025-05-14 18:08:56,463 - main - INFO - Found 3 business units:
2025-05-14 18:08:56,463 - main - INFO -   ID: 1, Name: ОО ФК "Хадасса Медикал ЛТД"
2025-05-14 18:08:56,463 - main - INFO -   ID: 2, Name: ООО "Медскан"
2025-05-14 18:08:56,464 - main - INFO -   ID: 3, Name: ООО "Клинический госпиталь на Яузе"
2025-05-14 18:08:56,464 - src.connectors.postgres_connector - INFO - Disconnected from PostgreSQL
2025-05-14 18:08:56,464 - main - INFO - Testing patient insertion...
2025-05-14 18:08:56,485 - src.connectors.postgres_connector - INFO - Connected to PostgreSQL
2025-05-14 18:08:56,496 - src.connectors.postgres_connector - INFO - Inserted/updated patient 2698057 with UUID c07329ba-3a38-44ce-8b79-81324177da05
2025-05-14 18:08:56,496 - main - INFO - Sample patient inserted successfully
2025-05-14 18:08:56,498 - main - INFO - Verified patient in database: ID=2698057, UUID=c07329ba-3a38-44ce-8b79-81324177da05, Passport=4512345678
2025-05-14 18:08:56,498 - src.connectors.postgres_connector - INFO - Disconnected from PostgreSQL
2025-05-14 18:08:56,498 - main - WARNING - Skipping Firebird import test due to connection or schema issues
2025-05-14 18:08:56,498 - main - INFO - 
Test Results Summary:
2025-05-14 18:08:56,499 - main - INFO - PostgreSQL Connection: ✓
2025-05-14 18:08:56,499 - main - INFO - Firebird Connection: ✗
2025-05-14 18:08:56,499 - main - INFO - YottaDB Connection: ✗
2025-05-14 18:08:56,499 - main - INFO - PostgreSQL Schema: ✓
2025-05-14 18:08:56,499 - main - INFO - Patient Insertion: ✓
2025-05-14 18:08:56,499 - main - INFO - Firebird Import: ✗
2025-05-14 18:08:56,499 - main - INFO - 
Tests completed.
2025-05-14 18:11:27,333 - main - INFO - Starting tests...
2025-05-14 18:11:27,334 - main - INFO - Testing PostgreSQL connection...
2025-05-14 18:11:27,347 - src.connectors.postgres_connector - INFO - Connected to PostgreSQL
2025-05-14 18:11:27,347 - main - INFO - PostgreSQL connection successful
2025-05-14 18:11:27,348 - main - INFO - PostgreSQL version: PostgreSQL 15.12 (Debian 15.12-0+deb12u2) on x86_64-pc-linux-gnu, compiled by gcc (Debian 12.2.0-14) 12.2.0, 64-bit
2025-05-14 18:11:27,348 - src.connectors.postgres_connector - INFO - Disconnected from PostgreSQL
2025-05-14 18:11:27,348 - main - INFO - Testing Firebird connection...
2025-05-14 18:11:27,348 - main - INFO - Firebird config: {'host': '192.168.160.168:3050', 'database': '099-1', 'user': 'SYSDBA', 'password': 'masterkey', 'charset': 'cp1251', 'debug': True}
2025-05-14 18:11:27,348 - src.connectors.firebird_connector - INFO - Testing TCP connectivity to 192.168.160.168:3050
2025-05-14 18:11:27,350 - src.connectors.firebird_connector - INFO - TCP connection to 192.168.160.168:3050 successful
2025-05-14 18:11:27,351 - src.connectors.firebird_connector - INFO - Attempting to connect to Firebird at 192.168.160.168:3050, database: /099-1
2025-05-14 18:11:27,386 - src.connectors.firebird_connector - ERROR - Failed to connect to Firebird (Инфоклиника): I/O error during "CreateFile (open)" operation for file "/099-1"
-Error while trying to open file
-�� ������� ����� ��������� ����. 
2025-05-14 18:11:27,386 - main - ERROR - Firebird connection failed
2025-05-14 18:11:27,386 - main - INFO - Testing YottaDB connection...
2025-05-14 18:11:27,386 - main - ERROR - YottaDB connection failed
2025-05-14 18:11:27,387 - main - INFO - Testing PostgreSQL schema...
2025-05-14 18:11:27,401 - src.connectors.postgres_connector - INFO - Connected to PostgreSQL
2025-05-14 18:11:27,406 - main - INFO - All essential tables exist
2025-05-14 18:11:27,406 - main - INFO - Found 2 HIS entries:
2025-05-14 18:11:27,406 - main - INFO -   ID: 1, Name: qMS
2025-05-14 18:11:27,406 - main - INFO -   ID: 2, Name: Инфоклиника
2025-05-14 18:11:27,406 - main - INFO - Found 3 business units:
2025-05-14 18:11:27,406 - main - INFO -   ID: 1, Name: ОО ФК "Хадасса Медикал ЛТД"
2025-05-14 18:11:27,406 - main - INFO -   ID: 2, Name: ООО "Медскан"
2025-05-14 18:11:27,406 - main - INFO -   ID: 3, Name: ООО "Клинический госпиталь на Яузе"
2025-05-14 18:11:27,407 - src.connectors.postgres_connector - INFO - Disconnected from PostgreSQL
2025-05-14 18:11:27,407 - main - INFO - Testing patient insertion...
2025-05-14 18:11:27,424 - src.connectors.postgres_connector - INFO - Connected to PostgreSQL
2025-05-14 18:11:27,431 - src.connectors.postgres_connector - INFO - Inserted/updated patient 2698058 with UUID c07329ba-3a38-44ce-8b79-81324177da05
2025-05-14 18:11:27,432 - main - INFO - Sample patient inserted successfully
2025-05-14 18:11:27,433 - main - INFO - Verified patient in database: ID=2698058, UUID=c07329ba-3a38-44ce-8b79-81324177da05, Passport=4512345678
2025-05-14 18:11:27,433 - src.connectors.postgres_connector - INFO - Disconnected from PostgreSQL
2025-05-14 18:11:27,433 - main - WARNING - Skipping Firebird import test due to connection or schema issues
2025-05-14 18:11:27,433 - main - INFO - 
Test Results Summary:
2025-05-14 18:11:27,433 - main - INFO - PostgreSQL Connection: ✓
2025-05-14 18:11:27,433 - main - INFO - Firebird Connection: ✗
2025-05-14 18:11:27,433 - main - INFO - YottaDB Connection: ✗
2025-05-14 18:11:27,433 - main - INFO - PostgreSQL Schema: ✓
2025-05-14 18:11:27,433 - main - INFO - Patient Insertion: ✓
2025-05-14 18:11:27,433 - main - INFO - Firebird Import: ✗
2025-05-14 18:11:27,434 - main - INFO - 
Tests completed.
2025-05-14 18:13:12,134 - main - INFO - Starting tests...
2025-05-14 18:13:12,134 - main - INFO - Testing PostgreSQL connection...
2025-05-14 18:13:12,148 - src.connectors.postgres_connector - INFO - Connected to PostgreSQL
2025-05-14 18:13:12,148 - main - INFO - PostgreSQL connection successful
2025-05-14 18:13:12,149 - main - INFO - PostgreSQL version: PostgreSQL 15.12 (Debian 15.12-0+deb12u2) on x86_64-pc-linux-gnu, compiled by gcc (Debian 12.2.0-14) 12.2.0, 64-bit
2025-05-14 18:13:12,149 - src.connectors.postgres_connector - INFO - Disconnected from PostgreSQL
2025-05-14 18:13:12,149 - main - INFO - Testing Firebird connection...
2025-05-14 18:13:12,149 - main - INFO - Firebird config: {'host': '192.168.160.168:3050', 'database': '099-1', 'user': 'SYSDBA', 'password': 'masterkey', 'charset': 'cp1251', 'debug': True}
2025-05-14 18:13:12,149 - src.connectors.firebird_connector - INFO - Testing TCP connectivity to 192.168.160.168:3050
2025-05-14 18:13:12,150 - src.connectors.firebird_connector - INFO - TCP connection to 192.168.160.168:3050 successful
2025-05-14 18:13:12,151 - src.connectors.firebird_connector - INFO - Attempting to connect to Firebird at 192.168.160.168:3050, database: /099-1
2025-05-14 18:13:12,284 - src.connectors.firebird_connector - ERROR - Failed to connect to Firebird (Инфоклиника): I/O error during "CreateFile (open)" operation for file "/099-1"
-Error while trying to open file
-�� ������� ����� ��������� ����. 
2025-05-14 18:13:12,285 - main - ERROR - Firebird connection failed
2025-05-14 18:13:12,285 - main - INFO - Testing YottaDB connection...
2025-05-14 18:13:12,285 - main - ERROR - YottaDB connection failed
2025-05-14 18:13:12,285 - main - INFO - Testing PostgreSQL schema...
2025-05-14 18:13:12,306 - src.connectors.postgres_connector - INFO - Connected to PostgreSQL
2025-05-14 18:13:12,311 - main - INFO - All essential tables exist
2025-05-14 18:13:12,312 - main - INFO - Found 2 HIS entries:
2025-05-14 18:13:12,312 - main - INFO -   ID: 1, Name: qMS
2025-05-14 18:13:12,312 - main - INFO -   ID: 2, Name: Инфоклиника
2025-05-14 18:13:12,312 - main - INFO - Found 3 business units:
2025-05-14 18:13:12,312 - main - INFO -   ID: 1, Name: ОО ФК "Хадасса Медикал ЛТД"
2025-05-14 18:13:12,312 - main - INFO -   ID: 2, Name: ООО "Медскан"
2025-05-14 18:13:12,312 - main - INFO -   ID: 3, Name: ООО "Клинический госпиталь на Яузе"
2025-05-14 18:13:12,313 - src.connectors.postgres_connector - INFO - Disconnected from PostgreSQL
2025-05-14 18:13:12,313 - main - INFO - Testing patient insertion...
2025-05-14 18:13:12,332 - src.connectors.postgres_connector - INFO - Connected to PostgreSQL
2025-05-14 18:13:12,342 - src.connectors.postgres_connector - INFO - Inserted/updated patient 2698059 with UUID c07329ba-3a38-44ce-8b79-81324177da05
2025-05-14 18:13:12,342 - main - INFO - Sample patient inserted successfully
2025-05-14 18:13:12,344 - main - INFO - Verified patient in database: ID=2698059, UUID=c07329ba-3a38-44ce-8b79-81324177da05, Passport=4512345678
2025-05-14 18:13:12,344 - src.connectors.postgres_connector - INFO - Disconnected from PostgreSQL
2025-05-14 18:13:12,344 - main - WARNING - Skipping Firebird import test due to connection or schema issues
2025-05-14 18:13:12,344 - main - INFO - 
Test Results Summary:
2025-05-14 18:13:12,344 - main - INFO - PostgreSQL Connection: ✓
2025-05-14 18:13:12,344 - main - INFO - Firebird Connection: ✗
2025-05-14 18:13:12,344 - main - INFO - YottaDB Connection: ✗
2025-05-14 18:13:12,344 - main - INFO - PostgreSQL Schema: ✓
2025-05-14 18:13:12,344 - main - INFO - Patient Insertion: ✓
2025-05-14 18:13:12,344 - main - INFO - Firebird Import: ✗
2025-05-14 18:13:12,344 - main - INFO - 
Tests completed.
2025-05-14 18:15:24,997 - main - INFO - Starting tests...
2025-05-14 18:15:24,997 - main - INFO - Testing PostgreSQL connection...
2025-05-14 18:15:25,009 - src.connectors.postgres_connector - INFO - Connected to PostgreSQL
2025-05-14 18:15:25,009 - main - INFO - PostgreSQL connection successful
2025-05-14 18:15:25,010 - main - INFO - PostgreSQL version: PostgreSQL 15.12 (Debian 15.12-0+deb12u2) on x86_64-pc-linux-gnu, compiled by gcc (Debian 12.2.0-14) 12.2.0, 64-bit
2025-05-14 18:15:25,010 - src.connectors.postgres_connector - INFO - Disconnected from PostgreSQL
2025-05-14 18:15:25,010 - main - INFO - Testing Firebird connection...
2025-05-14 18:15:25,010 - main - INFO - Firebird config: {'host': '192.168.160.168:3050', 'database': '099-1', 'user': 'SYSDBA', 'password': 'masterkey', 'charset': 'WINDOWS-1251', 'debug': True}
2025-05-14 18:15:25,011 - src.connectors.firebird_connector - INFO - Testing TCP connectivity to 192.168.160.168:3050
2025-05-14 18:15:25,011 - src.connectors.firebird_connector - INFO - TCP connection to 192.168.160.168:3050 successful
2025-05-14 18:15:25,012 - src.connectors.firebird_connector - INFO - Attempting to connect to Firebird at 192.168.160.168:3050, database: /099-1
2025-05-14 18:15:25,045 - src.connectors.firebird_connector - ERROR - Failed to connect to Firebird (Инфоклиника): I/O error during "CreateFile (open)" operation for file "/099-1"
-Error while trying to open file
-�� ������� ����� ��������� ����. 
2025-05-14 18:15:25,045 - main - ERROR - Firebird connection failed
2025-05-14 18:15:25,045 - main - INFO - Testing YottaDB connection...
2025-05-14 18:15:25,045 - main - ERROR - YottaDB connection failed
2025-05-14 18:15:25,045 - main - INFO - Testing PostgreSQL schema...
2025-05-14 18:15:25,059 - src.connectors.postgres_connector - INFO - Connected to PostgreSQL
2025-05-14 18:15:25,064 - main - INFO - All essential tables exist
2025-05-14 18:15:25,064 - main - INFO - Found 2 HIS entries:
2025-05-14 18:15:25,065 - main - INFO -   ID: 1, Name: qMS
2025-05-14 18:15:25,065 - main - INFO -   ID: 2, Name: Инфоклиника
2025-05-14 18:15:25,065 - main - INFO - Found 3 business units:
2025-05-14 18:15:25,065 - main - INFO -   ID: 1, Name: ОО ФК "Хадасса Медикал ЛТД"
2025-05-14 18:15:25,065 - main - INFO -   ID: 2, Name: ООО "Медскан"
2025-05-14 18:15:25,065 - main - INFO -   ID: 3, Name: ООО "Клинический госпиталь на Яузе"
2025-05-14 18:15:25,065 - src.connectors.postgres_connector - INFO - Disconnected from PostgreSQL
2025-05-14 18:15:25,066 - main - INFO - Testing patient insertion...
2025-05-14 18:15:25,085 - src.connectors.postgres_connector - INFO - Connected to PostgreSQL
2025-05-14 18:15:25,098 - src.connectors.postgres_connector - INFO - Inserted/updated patient 2698060 with UUID c07329ba-3a38-44ce-8b79-81324177da05
2025-05-14 18:15:25,098 - main - INFO - Sample patient inserted successfully
2025-05-14 18:15:25,099 - main - INFO - Verified patient in database: ID=2698060, UUID=c07329ba-3a38-44ce-8b79-81324177da05, Passport=4512345678
2025-05-14 18:15:25,100 - src.connectors.postgres_connector - INFO - Disconnected from PostgreSQL
2025-05-14 18:15:25,100 - main - WARNING - Skipping Firebird import test due to connection or schema issues
2025-05-14 18:15:25,100 - main - INFO - 
Test Results Summary:
2025-05-14 18:15:25,100 - main - INFO - PostgreSQL Connection: ✓
2025-05-14 18:15:25,100 - main - INFO - Firebird Connection: ✗
2025-05-14 18:15:25,100 - main - INFO - YottaDB Connection: ✗
2025-05-14 18:15:25,100 - main - INFO - PostgreSQL Schema: ✓
2025-05-14 18:15:25,100 - main - INFO - Patient Insertion: ✓
2025-05-14 18:15:25,100 - main - INFO - Firebird Import: ✗
2025-05-14 18:15:25,100 - main - INFO - 
Tests completed.
2025-05-14 18:19:45,969 - main - INFO - Starting tests...
2025-05-14 18:19:45,969 - main - INFO - Testing PostgreSQL connection...
2025-05-14 18:19:45,982 - src.connectors.postgres_connector - INFO - Connected to PostgreSQL
2025-05-14 18:19:45,983 - main - INFO - PostgreSQL connection successful
2025-05-14 18:19:45,983 - main - INFO - PostgreSQL version: PostgreSQL 15.12 (Debian 15.12-0+deb12u2) on x86_64-pc-linux-gnu, compiled by gcc (Debian 12.2.0-14) 12.2.0, 64-bit
2025-05-14 18:19:45,984 - src.connectors.postgres_connector - INFO - Disconnected from PostgreSQL
2025-05-14 18:19:45,984 - main - INFO - Testing Firebird connection...
2025-05-14 18:19:45,984 - main - INFO - Firebird config: {'host': '192.168.160.168:3050', 'database': 'C:\\Firebird_DB\x0099-1.fdb', 'user': 'SYSDBA', 'password': 'masterkey', 'charset': 'WINDOWS-1251', 'debug': True}
2025-05-14 18:19:45,984 - src.connectors.firebird_connector - INFO - Testing TCP connectivity to 192.168.160.168:3050
2025-05-14 18:19:45,985 - src.connectors.firebird_connector - INFO - TCP connection to 192.168.160.168:3050 successful
2025-05-14 18:19:45,986 - src.connectors.firebird_connector - INFO - Attempting to connect to Firebird at 192.168.160.168:3050, database: /C:\Firebird_DB 99-1.fdb
2025-05-14 18:19:46,011 - src.connectors.firebird_connector - ERROR - Failed to connect to Firebird (Инфоклиника): unavailable database
2025-05-14 18:19:46,011 - main - ERROR - Firebird connection failed
2025-05-14 18:19:46,011 - main - INFO - Testing YottaDB connection...
2025-05-14 18:19:46,011 - main - ERROR - YottaDB connection failed
2025-05-14 18:19:46,012 - main - INFO - Testing PostgreSQL schema...
2025-05-14 18:19:46,028 - src.connectors.postgres_connector - INFO - Connected to PostgreSQL
2025-05-14 18:19:46,038 - main - INFO - All essential tables exist
2025-05-14 18:19:46,039 - main - INFO - Found 2 HIS entries:
2025-05-14 18:19:46,039 - main - INFO -   ID: 1, Name: qMS
2025-05-14 18:19:46,039 - main - INFO -   ID: 2, Name: Инфоклиника
2025-05-14 18:19:46,039 - main - INFO - Found 3 business units:
2025-05-14 18:19:46,039 - main - INFO -   ID: 1, Name: ОО ФК "Хадасса Медикал ЛТД"
2025-05-14 18:19:46,040 - main - INFO -   ID: 2, Name: ООО "Медскан"
2025-05-14 18:19:46,040 - main - INFO -   ID: 3, Name: ООО "Клинический госпиталь на Яузе"
2025-05-14 18:19:46,040 - src.connectors.postgres_connector - INFO - Disconnected from PostgreSQL
2025-05-14 18:19:46,040 - main - INFO - Testing patient insertion...
2025-05-14 18:19:46,059 - src.connectors.postgres_connector - INFO - Connected to PostgreSQL
2025-05-14 18:19:46,067 - src.connectors.postgres_connector - INFO - Inserted/updated patient 2698061 with UUID c07329ba-3a38-44ce-8b79-81324177da05
2025-05-14 18:19:46,067 - main - INFO - Sample patient inserted successfully
2025-05-14 18:19:46,068 - main - INFO - Verified patient in database: ID=2698061, UUID=c07329ba-3a38-44ce-8b79-81324177da05, Passport=4512345678
2025-05-14 18:19:46,068 - src.connectors.postgres_connector - INFO - Disconnected from PostgreSQL
2025-05-14 18:19:46,069 - main - WARNING - Skipping Firebird import test due to connection or schema issues
2025-05-14 18:19:46,069 - main - INFO - 
Test Results Summary:
2025-05-14 18:19:46,069 - main - INFO - PostgreSQL Connection: ✓
2025-05-14 18:19:46,069 - main - INFO - Firebird Connection: ✗
2025-05-14 18:19:46,069 - main - INFO - YottaDB Connection: ✗
2025-05-14 18:19:46,069 - main - INFO - PostgreSQL Schema: ✓
2025-05-14 18:19:46,069 - main - INFO - Patient Insertion: ✓
2025-05-14 18:19:46,069 - main - INFO - Firebird Import: ✗
2025-05-14 18:19:46,069 - main - INFO - 
Tests completed.
2025-05-14 18:30:26,946 - main - INFO - Starting tests...
2025-05-14 18:30:26,946 - main - INFO - Testing PostgreSQL connection...
2025-05-14 18:30:26,960 - src.connectors.postgres_connector - INFO - Connected to PostgreSQL
2025-05-14 18:30:26,960 - main - INFO - PostgreSQL connection successful
2025-05-14 18:30:26,961 - main - INFO - PostgreSQL version: PostgreSQL 15.12 (Debian 15.12-0+deb12u2) on x86_64-pc-linux-gnu, compiled by gcc (Debian 12.2.0-14) 12.2.0, 64-bit
2025-05-14 18:30:26,961 - src.connectors.postgres_connector - INFO - Disconnected from PostgreSQL
2025-05-14 18:30:26,961 - main - INFO - Testing Firebird connection...
2025-05-14 18:30:26,961 - main - INFO - Firebird config: {'host': '192.168.160.168:3050', 'database': 'C:\\Firebird_DB\x0099-1.fdb', 'user': 'SYSDBA', 'password': 'masterkey', 'charset': 'WINDOWS-1251', 'debug': True}
2025-05-14 18:30:26,961 - src.connectors.firebird_connector - INFO - Testing TCP connectivity to 192.168.160.168:3050
2025-05-14 18:30:26,962 - src.connectors.firebird_connector - INFO - TCP connection to 192.168.160.168:3050 successful
2025-05-14 18:30:26,963 - src.connectors.firebird_connector - INFO - Attempting to connect to Firebird at 192.168.160.168:3050, database: /C:\Firebird_DB 99-1.fdb
2025-05-14 18:30:26,998 - src.connectors.firebird_connector - ERROR - Failed to connect to Firebird (Инфоклиника): unavailable database
2025-05-14 18:30:26,998 - main - ERROR - Firebird connection failed
2025-05-14 18:30:26,998 - main - INFO - Testing YottaDB connection...
2025-05-14 18:30:26,998 - main - ERROR - YottaDB connection failed
2025-05-14 18:30:26,999 - main - INFO - Testing PostgreSQL schema...
2025-05-14 18:30:27,026 - src.connectors.postgres_connector - INFO - Connected to PostgreSQL
2025-05-14 18:30:27,032 - main - INFO - All essential tables exist
2025-05-14 18:30:27,033 - main - INFO - Found 2 HIS entries:
2025-05-14 18:30:27,034 - main - INFO -   ID: 1, Name: qMS
2025-05-14 18:30:27,034 - main - INFO -   ID: 2, Name: Инфоклиника
2025-05-14 18:30:27,034 - main - INFO - Found 3 business units:
2025-05-14 18:30:27,034 - main - INFO -   ID: 1, Name: ОО ФК "Хадасса Медикал ЛТД"
2025-05-14 18:30:27,034 - main - INFO -   ID: 2, Name: ООО "Медскан"
2025-05-14 18:30:27,035 - main - INFO -   ID: 3, Name: ООО "Клинический госпиталь на Яузе"
2025-05-14 18:30:27,035 - src.connectors.postgres_connector - INFO - Disconnected from PostgreSQL
2025-05-14 18:30:27,035 - main - INFO - Testing patient insertion...
2025-05-14 18:30:27,050 - src.connectors.postgres_connector - INFO - Connected to PostgreSQL
2025-05-14 18:30:27,060 - src.connectors.postgres_connector - INFO - Inserted/updated patient 2698062 with UUID c07329ba-3a38-44ce-8b79-81324177da05
2025-05-14 18:30:27,060 - main - INFO - Sample patient inserted successfully
2025-05-14 18:30:27,061 - main - INFO - Verified patient in database: ID=2698062, UUID=c07329ba-3a38-44ce-8b79-81324177da05, Passport=4512345678
2025-05-14 18:30:27,061 - src.connectors.postgres_connector - INFO - Disconnected from PostgreSQL
2025-05-14 18:30:27,062 - main - WARNING - Skipping Firebird import test due to connection or schema issues
2025-05-14 18:30:27,062 - main - INFO - 
Test Results Summary:
2025-05-14 18:30:27,062 - main - INFO - PostgreSQL Connection: ✓
2025-05-14 18:30:27,062 - main - INFO - Firebird Connection: ✗
2025-05-14 18:30:27,062 - main - INFO - YottaDB Connection: ✗
2025-05-14 18:30:27,062 - main - INFO - PostgreSQL Schema: ✓
2025-05-14 18:30:27,062 - main - INFO - Patient Insertion: ✓
2025-05-14 18:30:27,062 - main - INFO - Firebird Import: ✗
2025-05-14 18:30:27,062 - main - INFO - 
Tests completed.
2025-05-14 18:31:38,977 - main - INFO - Starting tests...
2025-05-14 18:31:38,977 - main - INFO - Testing PostgreSQL connection...
2025-05-14 18:31:38,989 - src.connectors.postgres_connector - INFO - Connected to PostgreSQL
2025-05-14 18:31:38,989 - main - INFO - PostgreSQL connection successful
2025-05-14 18:31:38,990 - main - INFO - PostgreSQL version: PostgreSQL 15.12 (Debian 15.12-0+deb12u2) on x86_64-pc-linux-gnu, compiled by gcc (Debian 12.2.0-14) 12.2.0, 64-bit
2025-05-14 18:31:38,990 - src.connectors.postgres_connector - INFO - Disconnected from PostgreSQL
2025-05-14 18:31:38,990 - main - INFO - Testing Firebird connection...
2025-05-14 18:31:38,990 - main - INFO - Firebird config: {'host': '192.168.160.168:3050', 'database': '099-1', 'user': 'SYSDBA', 'password': 'masterkey', 'charset': 'WINDOWS-1251', 'debug': True}
2025-05-14 18:31:38,990 - src.connectors.firebird_connector - INFO - Testing TCP connectivity to 192.168.160.168:3050
2025-05-14 18:31:38,991 - src.connectors.firebird_connector - INFO - TCP connection to 192.168.160.168:3050 successful
2025-05-14 18:31:38,992 - src.connectors.firebird_connector - INFO - Attempting to connect to Firebird at 192.168.160.168:3050, database: /099-1
2025-05-14 18:31:39,028 - src.connectors.firebird_connector - ERROR - Failed to connect to Firebird (Инфоклиника): I/O error during "CreateFile (open)" operation for file "/099-1"
-Error while trying to open file
-�� ������� ����� ��������� ����. 
2025-05-14 18:31:39,028 - main - ERROR - Firebird connection failed
2025-05-14 18:31:39,028 - main - INFO - Testing YottaDB connection...
2025-05-14 18:31:39,028 - main - ERROR - YottaDB connection failed
2025-05-14 18:31:39,028 - main - INFO - Testing PostgreSQL schema...
2025-05-14 18:31:39,043 - src.connectors.postgres_connector - INFO - Connected to PostgreSQL
2025-05-14 18:31:39,047 - main - INFO - All essential tables exist
2025-05-14 18:31:39,048 - main - INFO - Found 2 HIS entries:
2025-05-14 18:31:39,048 - main - INFO -   ID: 1, Name: qMS
2025-05-14 18:31:39,048 - main - INFO -   ID: 2, Name: Инфоклиника
2025-05-14 18:31:39,048 - main - INFO - Found 3 business units:
2025-05-14 18:31:39,048 - main - INFO -   ID: 1, Name: ОО ФК "Хадасса Медикал ЛТД"
2025-05-14 18:31:39,048 - main - INFO -   ID: 2, Name: ООО "Медскан"
2025-05-14 18:31:39,048 - main - INFO -   ID: 3, Name: ООО "Клинический госпиталь на Яузе"
2025-05-14 18:31:39,048 - src.connectors.postgres_connector - INFO - Disconnected from PostgreSQL
2025-05-14 18:31:39,048 - main - INFO - Testing patient insertion...
2025-05-14 18:31:39,069 - src.connectors.postgres_connector - INFO - Connected to PostgreSQL
2025-05-14 18:31:39,081 - src.connectors.postgres_connector - INFO - Inserted/updated patient 2698063 with UUID c07329ba-3a38-44ce-8b79-81324177da05
2025-05-14 18:31:39,082 - main - INFO - Sample patient inserted successfully
2025-05-14 18:31:39,084 - main - INFO - Verified patient in database: ID=2698063, UUID=c07329ba-3a38-44ce-8b79-81324177da05, Passport=4512345678
2025-05-14 18:31:39,084 - src.connectors.postgres_connector - INFO - Disconnected from PostgreSQL
2025-05-14 18:31:39,084 - main - WARNING - Skipping Firebird import test due to connection or schema issues
2025-05-14 18:31:39,085 - main - INFO - 
Test Results Summary:
2025-05-14 18:31:39,085 - main - INFO - PostgreSQL Connection: ✓
2025-05-14 18:31:39,085 - main - INFO - Firebird Connection: ✗
2025-05-14 18:31:39,085 - main - INFO - YottaDB Connection: ✗
2025-05-14 18:31:39,085 - main - INFO - PostgreSQL Schema: ✓
2025-05-14 18:31:39,085 - main - INFO - Patient Insertion: ✓
2025-05-14 18:31:39,085 - main - INFO - Firebird Import: ✗
2025-05-14 18:31:39,085 - main - INFO - 
Tests completed.
2025-05-14 18:34:04,602 - main - INFO - Starting tests...
2025-05-14 18:34:04,602 - main - INFO - Testing PostgreSQL connection...
2025-05-14 18:34:04,617 - src.connectors.postgres_connector - INFO - Connected to PostgreSQL
2025-05-14 18:34:04,617 - main - INFO - PostgreSQL connection successful
2025-05-14 18:34:04,618 - main - INFO - PostgreSQL version: PostgreSQL 15.12 (Debian 15.12-0+deb12u2) on x86_64-pc-linux-gnu, compiled by gcc (Debian 12.2.0-14) 12.2.0, 64-bit
2025-05-14 18:34:04,618 - src.connectors.postgres_connector - INFO - Disconnected from PostgreSQL
2025-05-14 18:34:04,618 - main - INFO - Testing Firebird connection...
2025-05-14 18:34:04,618 - main - INFO - Firebird config: {'host': '192.168.160.168:3050', 'database': '099-1', 'user': 'SYSDBA', 'password': 'masterkey', 'charset': 'WINDOWS-1251', 'debug': True}
2025-05-14 18:34:04,619 - src.connectors.firebird_connector - INFO - Testing TCP connectivity to 192.168.160.168:3050
2025-05-14 18:34:04,619 - src.connectors.firebird_connector - INFO - TCP connection to 192.168.160.168:3050 successful
2025-05-14 18:34:04,620 - src.connectors.firebird_connector - INFO - Attempting to connect to Firebird at 192.168.160.168:3050, database: /099-1
2025-05-14 18:34:04,669 - src.connectors.firebird_connector - ERROR - Failed to connect to Firebird (Инфоклиника): I/O error during "CreateFile (open)" operation for file "/099-1"
-Error while trying to open file
-�� ������� ����� ��������� ����. 
2025-05-14 18:34:04,669 - main - ERROR - Firebird connection failed
2025-05-14 18:34:04,669 - main - INFO - Testing YottaDB connection...
2025-05-14 18:34:04,670 - main - ERROR - YottaDB connection failed
2025-05-14 18:34:04,670 - main - INFO - Testing PostgreSQL schema...
2025-05-14 18:34:04,684 - src.connectors.postgres_connector - INFO - Connected to PostgreSQL
2025-05-14 18:34:04,690 - main - INFO - All essential tables exist
2025-05-14 18:34:04,691 - main - INFO - Found 2 HIS entries:
2025-05-14 18:34:04,691 - main - INFO -   ID: 1, Name: qMS
2025-05-14 18:34:04,691 - main - INFO -   ID: 2, Name: Инфоклиника
2025-05-14 18:34:04,691 - main - INFO - Found 3 business units:
2025-05-14 18:34:04,691 - main - INFO -   ID: 1, Name: ОО ФК "Хадасса Медикал ЛТД"
2025-05-14 18:34:04,691 - main - INFO -   ID: 2, Name: ООО "Медскан"
2025-05-14 18:34:04,692 - main - INFO -   ID: 3, Name: ООО "Клинический госпиталь на Яузе"
2025-05-14 18:34:04,692 - src.connectors.postgres_connector - INFO - Disconnected from PostgreSQL
2025-05-14 18:34:04,692 - main - INFO - Testing patient insertion...
2025-05-14 18:34:04,706 - src.connectors.postgres_connector - INFO - Connected to PostgreSQL
2025-05-14 18:34:04,714 - src.connectors.postgres_connector - INFO - Inserted/updated patient 2698064 with UUID c07329ba-3a38-44ce-8b79-81324177da05
2025-05-14 18:34:04,715 - main - INFO - Sample patient inserted successfully
2025-05-14 18:34:04,716 - main - INFO - Verified patient in database: ID=2698064, UUID=c07329ba-3a38-44ce-8b79-81324177da05, Passport=4512345678
2025-05-14 18:34:04,716 - src.connectors.postgres_connector - INFO - Disconnected from PostgreSQL
2025-05-14 18:34:04,716 - main - WARNING - Skipping Firebird import test due to connection or schema issues
2025-05-14 18:34:04,716 - main - INFO - 
Test Results Summary:
2025-05-14 18:34:04,716 - main - INFO - PostgreSQL Connection: ✓
2025-05-14 18:34:04,716 - main - INFO - Firebird Connection: ✗
2025-05-14 18:34:04,716 - main - INFO - YottaDB Connection: ✗
2025-05-14 18:34:04,716 - main - INFO - PostgreSQL Schema: ✓
2025-05-14 18:34:04,716 - main - INFO - Patient Insertion: ✓
2025-05-14 18:34:04,716 - main - INFO - Firebird Import: ✗
2025-05-14 18:34:04,716 - main - INFO - 
Tests completed.
2025-05-14 18:34:39,670 - main - INFO - Starting tests...
2025-05-14 18:34:39,670 - main - INFO - Testing PostgreSQL connection...
2025-05-14 18:34:39,684 - src.connectors.postgres_connector - INFO - Connected to PostgreSQL
2025-05-14 18:34:39,685 - main - INFO - PostgreSQL connection successful
2025-05-14 18:34:39,685 - main - INFO - PostgreSQL version: PostgreSQL 15.12 (Debian 15.12-0+deb12u2) on x86_64-pc-linux-gnu, compiled by gcc (Debian 12.2.0-14) 12.2.0, 64-bit
2025-05-14 18:34:39,686 - src.connectors.postgres_connector - INFO - Disconnected from PostgreSQL
2025-05-14 18:34:39,686 - main - INFO - Testing Firebird connection...
2025-05-14 18:34:39,686 - main - INFO - Firebird config: {'host': '192.168.160.168:3050', 'database': '099-1', 'user': 'SYSDBA', 'password': 'masterkey', 'charset': 'UTF-8', 'debug': True}
2025-05-14 18:34:39,686 - src.connectors.firebird_connector - INFO - Testing TCP connectivity to 192.168.160.168:3050
2025-05-14 18:34:39,687 - src.connectors.firebird_connector - INFO - TCP connection to 192.168.160.168:3050 successful
2025-05-14 18:34:39,688 - src.connectors.firebird_connector - INFO - Attempting to connect to Firebird at 192.168.160.168:3050, database: /099-1
2025-05-14 18:34:39,718 - src.connectors.firebird_connector - ERROR - Failed to connect to Firebird (Инфоклиника): I/O error during "CreateFile (open)" operation for file "/099-1"
-Error while trying to open file
-�� ������� ����� ��������� ����. 
2025-05-14 18:34:39,718 - main - ERROR - Firebird connection failed
2025-05-14 18:34:39,718 - main - INFO - Testing YottaDB connection...
2025-05-14 18:34:39,718 - main - ERROR - YottaDB connection failed
2025-05-14 18:34:39,718 - main - INFO - Testing PostgreSQL schema...
2025-05-14 18:34:39,733 - src.connectors.postgres_connector - INFO - Connected to PostgreSQL
2025-05-14 18:34:39,738 - main - INFO - All essential tables exist
2025-05-14 18:34:39,738 - main - INFO - Found 2 HIS entries:
2025-05-14 18:34:39,738 - main - INFO -   ID: 1, Name: qMS
2025-05-14 18:34:39,739 - main - INFO -   ID: 2, Name: Инфоклиника
2025-05-14 18:34:39,739 - main - INFO - Found 3 business units:
2025-05-14 18:34:39,739 - main - INFO -   ID: 1, Name: ОО ФК "Хадасса Медикал ЛТД"
2025-05-14 18:34:39,739 - main - INFO -   ID: 2, Name: ООО "Медскан"
2025-05-14 18:34:39,739 - main - INFO -   ID: 3, Name: ООО "Клинический госпиталь на Яузе"
2025-05-14 18:34:39,739 - src.connectors.postgres_connector - INFO - Disconnected from PostgreSQL
2025-05-14 18:34:39,739 - main - INFO - Testing patient insertion...
2025-05-14 18:34:39,756 - src.connectors.postgres_connector - INFO - Connected to PostgreSQL
2025-05-14 18:34:39,765 - src.connectors.postgres_connector - INFO - Inserted/updated patient 2698065 with UUID c07329ba-3a38-44ce-8b79-81324177da05
2025-05-14 18:34:39,765 - main - INFO - Sample patient inserted successfully
2025-05-14 18:34:39,766 - main - INFO - Verified patient in database: ID=2698065, UUID=c07329ba-3a38-44ce-8b79-81324177da05, Passport=4512345678
2025-05-14 18:34:39,766 - src.connectors.postgres_connector - INFO - Disconnected from PostgreSQL
2025-05-14 18:34:39,766 - main - WARNING - Skipping Firebird import test due to connection or schema issues
2025-05-14 18:34:39,766 - main - INFO - 
Test Results Summary:
2025-05-14 18:34:39,766 - main - INFO - PostgreSQL Connection: ✓
2025-05-14 18:34:39,766 - main - INFO - Firebird Connection: ✗
2025-05-14 18:34:39,766 - main - INFO - YottaDB Connection: ✗
2025-05-14 18:34:39,766 - main - INFO - PostgreSQL Schema: ✓
2025-05-14 18:34:39,767 - main - INFO - Patient Insertion: ✓
2025-05-14 18:34:39,767 - main - INFO - Firebird Import: ✗
2025-05-14 18:34:39,767 - main - INFO - 
Tests completed.
2025-05-14 19:03:39,970 - main - INFO - Starting tests...
2025-05-14 19:03:39,970 - main - INFO - Testing PostgreSQL connection...
2025-05-14 19:03:39,983 - src.connectors.postgres_connector - INFO - Connected to PostgreSQL
2025-05-14 19:03:39,983 - main - INFO - PostgreSQL connection successful
2025-05-14 19:03:39,984 - main - INFO - PostgreSQL version: PostgreSQL 15.12 (Debian 15.12-0+deb12u2) on x86_64-pc-linux-gnu, compiled by gcc (Debian 12.2.0-14) 12.2.0, 64-bit
2025-05-14 19:03:39,984 - src.connectors.postgres_connector - INFO - Disconnected from PostgreSQL
2025-05-14 19:03:39,985 - main - INFO - Testing Firebird connection...
2025-05-14 19:03:39,985 - main - INFO - Firebird config: {'host': '192.168.160.168:3050', 'database': '099-1', 'user': 'SYSDBA', 'password': 'masterkey', 'charset': 'UTF-8', 'debug': True}
2025-05-14 19:03:39,985 - src.connectors.firebird_connector - INFO - Testing TCP connectivity to 192.168.160.168:3050
2025-05-14 19:03:39,986 - src.connectors.firebird_connector - INFO - TCP connection to 192.168.160.168:3050 successful
2025-05-14 19:03:39,987 - src.connectors.firebird_connector - INFO - Attempting to connect to Firebird at 192.168.160.168:3050, database: /099-1
2025-05-14 19:03:40,015 - src.connectors.firebird_connector - ERROR - Failed to connect to Firebird (Инфоклиника): I/O error during "CreateFile (open)" operation for file "/099-1"
-Error while trying to open file
-�� ������� ����� ��������� ����. 
2025-05-14 19:03:40,015 - main - ERROR - Firebird connection failed
2025-05-14 19:03:40,015 - main - INFO - Testing YottaDB connection...
2025-05-14 19:03:40,015 - main - ERROR - YottaDB connection failed
2025-05-14 19:03:40,015 - main - INFO - Testing PostgreSQL schema...
2025-05-14 19:03:40,032 - src.connectors.postgres_connector - INFO - Connected to PostgreSQL
2025-05-14 19:03:40,037 - main - INFO - All essential tables exist
2025-05-14 19:03:40,037 - main - INFO - Found 2 HIS entries:
2025-05-14 19:03:40,037 - main - INFO -   ID: 1, Name: qMS
2025-05-14 19:03:40,037 - main - INFO -   ID: 2, Name: Инфоклиника
2025-05-14 19:03:40,038 - main - INFO - Found 3 business units:
2025-05-14 19:03:40,038 - main - INFO -   ID: 1, Name: ОО ФК "Хадасса Медикал ЛТД"
2025-05-14 19:03:40,038 - main - INFO -   ID: 2, Name: ООО "Медскан"
2025-05-14 19:03:40,038 - main - INFO -   ID: 3, Name: ООО "Клинический госпиталь на Яузе"
2025-05-14 19:03:40,038 - src.connectors.postgres_connector - INFO - Disconnected from PostgreSQL
2025-05-14 19:03:40,038 - main - INFO - Testing patient insertion...
2025-05-14 19:03:40,066 - src.connectors.postgres_connector - INFO - Connected to PostgreSQL
2025-05-14 19:03:40,078 - src.connectors.postgres_connector - INFO - Inserted/updated patient 2698066 with UUID c07329ba-3a38-44ce-8b79-81324177da05
2025-05-14 19:03:40,078 - main - INFO - Sample patient inserted successfully
2025-05-14 19:03:40,079 - main - INFO - Verified patient in database: ID=2698066, UUID=c07329ba-3a38-44ce-8b79-81324177da05, Passport=4512345678
2025-05-14 19:03:40,079 - src.connectors.postgres_connector - INFO - Disconnected from PostgreSQL
2025-05-14 19:03:40,079 - main - WARNING - Skipping Firebird import test due to connection or schema issues
2025-05-14 19:03:40,079 - main - INFO - 
Test Results Summary:
2025-05-14 19:03:40,079 - main - INFO - PostgreSQL Connection: ✓
2025-05-14 19:03:40,079 - main - INFO - Firebird Connection: ✗
2025-05-14 19:03:40,079 - main - INFO - YottaDB Connection: ✗
2025-05-14 19:03:40,080 - main - INFO - PostgreSQL Schema: ✓
2025-05-14 19:03:40,080 - main - INFO - Patient Insertion: ✓
2025-05-14 19:03:40,080 - main - INFO - Firebird Import: ✗
2025-05-14 19:03:40,080 - main - INFO - 
Tests completed.
2025-05-14 19:08:13,320 - main - INFO - Starting tests...
2025-05-14 19:08:13,321 - main - INFO - Testing PostgreSQL connection...
2025-05-14 19:08:13,333 - src.connectors.postgres_connector - INFO - Connected to PostgreSQL
2025-05-14 19:08:13,334 - main - INFO - PostgreSQL connection successful
2025-05-14 19:08:13,334 - main - INFO - PostgreSQL version: PostgreSQL 15.12 (Debian 15.12-0+deb12u2) on x86_64-pc-linux-gnu, compiled by gcc (Debian 12.2.0-14) 12.2.0, 64-bit
2025-05-14 19:08:13,335 - src.connectors.postgres_connector - INFO - Disconnected from PostgreSQL
2025-05-14 19:08:13,335 - main - INFO - Testing Firebird connection...
2025-05-14 19:08:13,335 - main - INFO - Firebird config: {'host': '192.168.160.168:3050', 'database': '099-1', 'user': 'SYSDBA', 'password': 'masterkey', 'charset': 'UTF-8', 'debug': True}
2025-05-14 19:08:13,335 - src.connectors.firebird_connector - INFO - Testing TCP connectivity to 192.168.160.168:3050
2025-05-14 19:08:13,336 - src.connectors.firebird_connector - INFO - TCP connection to 192.168.160.168:3050 successful
2025-05-14 19:08:13,337 - src.connectors.firebird_connector - INFO - Attempting to connect to Firebird at 192.168.160.168:3050, database: /099-1
2025-05-14 19:08:13,369 - src.connectors.firebird_connector - ERROR - Failed to connect to Firebird (Инфоклиника): I/O error during "CreateFile (open)" operation for file "/099-1"
-Error while trying to open file
-�� ������� ����� ��������� ����. 
2025-05-14 19:08:13,369 - main - ERROR - Firebird connection failed
2025-05-14 19:08:13,369 - main - INFO - Testing YottaDB connection...
2025-05-14 19:08:13,369 - main - ERROR - YottaDB connection failed
2025-05-14 19:08:13,369 - main - INFO - Testing PostgreSQL schema...
2025-05-14 19:08:13,381 - src.connectors.postgres_connector - INFO - Connected to PostgreSQL
2025-05-14 19:08:13,385 - main - INFO - All essential tables exist
2025-05-14 19:08:13,386 - main - INFO - Found 2 HIS entries:
2025-05-14 19:08:13,386 - main - INFO -   ID: 1, Name: qMS
2025-05-14 19:08:13,386 - main - INFO -   ID: 2, Name: Инфоклиника
2025-05-14 19:08:13,386 - main - INFO - Found 3 business units:
2025-05-14 19:08:13,386 - main - INFO -   ID: 1, Name: ОО ФК "Хадасса Медикал ЛТД"
2025-05-14 19:08:13,386 - main - INFO -   ID: 2, Name: ООО "Медскан"
2025-05-14 19:08:13,386 - main - INFO -   ID: 3, Name: ООО "Клинический госпиталь на Яузе"
2025-05-14 19:08:13,387 - src.connectors.postgres_connector - INFO - Disconnected from PostgreSQL
2025-05-14 19:08:13,387 - main - INFO - Testing patient insertion...
2025-05-14 19:08:13,402 - src.connectors.postgres_connector - INFO - Connected to PostgreSQL
2025-05-14 19:08:13,414 - src.connectors.postgres_connector - INFO - Inserted/updated patient 2698067 with UUID c07329ba-3a38-44ce-8b79-81324177da05
2025-05-14 19:08:13,414 - main - INFO - Sample patient inserted successfully
2025-05-14 19:08:13,415 - main - INFO - Verified patient in database: ID=2698067, UUID=c07329ba-3a38-44ce-8b79-81324177da05, Passport=4512345678
2025-05-14 19:08:13,416 - src.connectors.postgres_connector - INFO - Disconnected from PostgreSQL
2025-05-14 19:08:13,416 - main - WARNING - Skipping Firebird import test due to connection or schema issues
2025-05-14 19:08:13,416 - main - INFO - 
Test Results Summary:
2025-05-14 19:08:13,416 - main - INFO - PostgreSQL Connection: ✓
2025-05-14 19:08:13,416 - main - INFO - Firebird Connection: ✗
2025-05-14 19:08:13,416 - main - INFO - YottaDB Connection: ✗
2025-05-14 19:08:13,416 - main - INFO - PostgreSQL Schema: ✓
2025-05-14 19:08:13,416 - main - INFO - Patient Insertion: ✓
2025-05-14 19:08:13,416 - main - INFO - Firebird Import: ✗
2025-05-14 19:08:13,416 - main - INFO - 
Tests completed.
2025-05-14 19:13:23,497 - main - INFO - Starting tests...
2025-05-14 19:13:23,497 - main - INFO - Testing PostgreSQL connection...
2025-05-14 19:13:23,509 - src.connectors.postgres_connector - INFO - Connected to PostgreSQL
2025-05-14 19:13:23,509 - main - INFO - PostgreSQL connection successful
2025-05-14 19:13:23,510 - main - INFO - PostgreSQL version: PostgreSQL 15.12 (Debian 15.12-0+deb12u2) on x86_64-pc-linux-gnu, compiled by gcc (Debian 12.2.0-14) 12.2.0, 64-bit
2025-05-14 19:13:23,510 - src.connectors.postgres_connector - INFO - Disconnected from PostgreSQL
2025-05-14 19:13:23,510 - main - INFO - Testing Firebird connection...
2025-05-14 19:13:23,510 - main - INFO - Firebird config: {'host': '192.168.160.168:3050', 'database': '099-1', 'user': 'SYSDBA', 'password': 'masterkey', 'charset': 'UTF-8', 'debug': True}
2025-05-14 19:13:23,511 - src.connectors.firebird_connector - INFO - Testing TCP connectivity to 192.168.160.168:3050
2025-05-14 19:13:23,511 - src.connectors.firebird_connector - INFO - TCP connection to 192.168.160.168:3050 successful
2025-05-14 19:13:23,512 - src.connectors.firebird_connector - INFO - Attempting to connect to Firebird at 192.168.160.168:3050, database: 099-1
2025-05-14 19:13:23,543 - src.connectors.firebird_connector - INFO - Connected to Firebird (Инфоклиника) using firebird-driver
2025-05-14 19:13:23,543 - main - INFO - Firebird connection successful
2025-05-14 19:13:23,549 - main - INFO - Firebird current time: 2025-05-14 19:13:23.536000
2025-05-14 19:13:23,567 - src.connectors.firebird_connector - ERROR - Error fetching patients from Firebird (Инфоклиника): Dynamic SQL Error
-SQL error code = -204
-Table unknown
-PATIENTS
-At line 13, column 22
2025-05-14 19:13:23,568 - main - INFO - Retrieved 0 patients from Firebird (Инфоклиника)
2025-05-14 19:13:23,576 - src.connectors.firebird_connector - INFO - Disconnected from Firebird (Инфоклиника)
2025-05-14 19:13:23,576 - main - INFO - Testing YottaDB connection...
2025-05-14 19:13:23,577 - main - ERROR - YottaDB connection failed
2025-05-14 19:13:23,577 - main - INFO - Testing PostgreSQL schema...
2025-05-14 19:13:23,591 - src.connectors.postgres_connector - INFO - Connected to PostgreSQL
2025-05-14 19:13:23,595 - main - INFO - All essential tables exist
2025-05-14 19:13:23,595 - main - INFO - Found 2 HIS entries:
2025-05-14 19:13:23,595 - main - INFO -   ID: 1, Name: qMS
2025-05-14 19:13:23,596 - main - INFO -   ID: 2, Name: Инфоклиника
2025-05-14 19:13:23,596 - main - INFO - Found 3 business units:
2025-05-14 19:13:23,596 - main - INFO -   ID: 1, Name: ОО ФК "Хадасса Медикал ЛТД"
2025-05-14 19:13:23,596 - main - INFO -   ID: 2, Name: ООО "Медскан"
2025-05-14 19:13:23,596 - main - INFO -   ID: 3, Name: ООО "Клинический госпиталь на Яузе"
2025-05-14 19:13:23,596 - src.connectors.postgres_connector - INFO - Disconnected from PostgreSQL
2025-05-14 19:13:23,596 - main - INFO - Testing patient insertion...
2025-05-14 19:13:23,612 - src.connectors.postgres_connector - INFO - Connected to PostgreSQL
2025-05-14 19:13:23,618 - src.connectors.postgres_connector - INFO - Inserted/updated patient 2698068 with UUID c07329ba-3a38-44ce-8b79-81324177da05
2025-05-14 19:13:23,618 - main - INFO - Sample patient inserted successfully
2025-05-14 19:13:23,619 - main - INFO - Verified patient in database: ID=2698068, UUID=c07329ba-3a38-44ce-8b79-81324177da05, Passport=4512345678
2025-05-14 19:13:23,619 - src.connectors.postgres_connector - INFO - Disconnected from PostgreSQL
2025-05-14 19:13:23,619 - main - INFO - Testing patient fetch and import from Firebird to PostgreSQL...
2025-05-14 19:13:23,619 - src.connectors.firebird_connector - INFO - Testing TCP connectivity to 192.168.160.168:3050
2025-05-14 19:13:23,620 - src.connectors.firebird_connector - INFO - TCP connection to 192.168.160.168:3050 successful
2025-05-14 19:13:23,620 - src.connectors.firebird_connector - ERROR - Failed to connect to Firebird (Инфоклиника): Server 'infoclinica_server' already registered.
2025-05-14 19:13:23,620 - main - ERROR - Firebird connection failed
2025-05-14 19:13:23,620 - main - INFO - 
Test Results Summary:
2025-05-14 19:13:23,620 - main - INFO - PostgreSQL Connection: ✓
2025-05-14 19:13:23,620 - main - INFO - Firebird Connection: ✓
2025-05-14 19:13:23,620 - main - INFO - YottaDB Connection: ✗
2025-05-14 19:13:23,620 - main - INFO - PostgreSQL Schema: ✓
2025-05-14 19:13:23,620 - main - INFO - Patient Insertion: ✓
2025-05-14 19:13:23,620 - main - INFO - Firebird Import: ✗
2025-05-14 19:13:23,620 - main - INFO - 
Tests completed.
2025-05-14 19:15:38,591 - main - INFO - Starting tests...
2025-05-14 19:15:38,591 - main - INFO - Testing PostgreSQL connection...
2025-05-14 19:15:38,605 - src.connectors.postgres_connector - INFO - Connected to PostgreSQL
2025-05-14 19:15:38,605 - main - INFO - PostgreSQL connection successful
2025-05-14 19:15:38,606 - main - INFO - PostgreSQL version: PostgreSQL 15.12 (Debian 15.12-0+deb12u2) on x86_64-pc-linux-gnu, compiled by gcc (Debian 12.2.0-14) 12.2.0, 64-bit
2025-05-14 19:15:38,606 - src.connectors.postgres_connector - INFO - Disconnected from PostgreSQL
2025-05-14 19:15:38,606 - main - INFO - Testing Firebird connection...
2025-05-14 19:15:38,607 - main - INFO - Firebird config: {'host': '192.168.160.168:3050', 'database': '099-1', 'user': 'SYSDBA', 'password': 'masterkey', 'charset': 'UTF-8', 'debug': True}
2025-05-14 19:15:38,607 - src.connectors.firebird_connector - INFO - Testing TCP connectivity to 192.168.160.168:3050
2025-05-14 19:15:38,607 - src.connectors.firebird_connector - INFO - TCP connection to 192.168.160.168:3050 successful
2025-05-14 19:15:38,608 - src.connectors.firebird_connector - INFO - Attempting to connect to Firebird at 192.168.160.168:3050, database: 099-1
2025-05-14 19:15:38,665 - src.connectors.firebird_connector - INFO - Connected to Firebird (Инфоклиника) using firebird-driver
2025-05-14 19:15:38,665 - main - INFO - Firebird connection successful
2025-05-14 19:15:38,671 - main - INFO - Firebird current time: 2025-05-14 19:15:38.661000
2025-05-14 19:15:38,676 - src.connectors.firebird_connector - ERROR - Error fetching patients from Firebird (Инфоклиника): Dynamic SQL Error
-SQL error code = -204
-Table unknown
-PATIENTS
-At line 13, column 22
2025-05-14 19:15:38,676 - main - INFO - Retrieved 0 patients from Firebird (Инфоклиника)
2025-05-14 19:15:38,680 - src.connectors.firebird_connector - INFO - Disconnected from Firebird (Инфоклиника)
2025-05-14 19:15:38,681 - main - INFO - Testing YottaDB connection...
2025-05-14 19:15:38,681 - main - ERROR - YottaDB connection failed
2025-05-14 19:15:38,681 - main - INFO - Testing PostgreSQL schema...
2025-05-14 19:15:38,713 - src.connectors.postgres_connector - INFO - Connected to PostgreSQL
2025-05-14 19:15:38,720 - main - INFO - All essential tables exist
2025-05-14 19:15:38,721 - main - INFO - Found 2 HIS entries:
2025-05-14 19:15:38,721 - main - INFO -   ID: 1, Name: qMS
2025-05-14 19:15:38,721 - main - INFO -   ID: 2, Name: Инфоклиника
2025-05-14 19:15:38,722 - main - INFO - Found 3 business units:
2025-05-14 19:15:38,722 - main - INFO -   ID: 1, Name: ОО ФК "Хадасса Медикал ЛТД"
2025-05-14 19:15:38,722 - main - INFO -   ID: 2, Name: ООО "Медскан"
2025-05-14 19:15:38,722 - main - INFO -   ID: 3, Name: ООО "Клинический госпиталь на Яузе"
2025-05-14 19:15:38,723 - src.connectors.postgres_connector - INFO - Disconnected from PostgreSQL
2025-05-14 19:15:38,723 - main - INFO - Testing patient insertion...
2025-05-14 19:15:38,741 - src.connectors.postgres_connector - INFO - Connected to PostgreSQL
2025-05-14 19:15:38,752 - src.connectors.postgres_connector - INFO - Inserted/updated patient 2698069 with UUID c07329ba-3a38-44ce-8b79-81324177da05
2025-05-14 19:15:38,753 - main - INFO - Sample patient inserted successfully
2025-05-14 19:15:38,754 - main - INFO - Verified patient in database: ID=2698069, UUID=c07329ba-3a38-44ce-8b79-81324177da05, Passport=4512345678
2025-05-14 19:15:38,754 - src.connectors.postgres_connector - INFO - Disconnected from PostgreSQL
2025-05-14 19:15:38,754 - main - INFO - Testing patient fetch and import from Firebird to PostgreSQL...
2025-05-14 19:15:38,754 - src.connectors.firebird_connector - INFO - Testing TCP connectivity to 192.168.160.168:3050
2025-05-14 19:15:38,755 - src.connectors.firebird_connector - INFO - TCP connection to 192.168.160.168:3050 successful
2025-05-14 19:15:38,755 - src.connectors.firebird_connector - ERROR - Failed to connect to Firebird (Инфоклиника): Server 'infoclinica_server' already registered.
2025-05-14 19:15:38,755 - main - ERROR - Firebird connection failed
2025-05-14 19:15:38,755 - main - INFO - 
Test Results Summary:
2025-05-14 19:15:38,756 - main - INFO - PostgreSQL Connection: ✓
2025-05-14 19:15:38,756 - main - INFO - Firebird Connection: ✓
2025-05-14 19:15:38,756 - main - INFO - YottaDB Connection: ✗
2025-05-14 19:15:38,756 - main - INFO - PostgreSQL Schema: ✓
2025-05-14 19:15:38,756 - main - INFO - Patient Insertion: ✓
2025-05-14 19:15:38,756 - main - INFO - Firebird Import: ✗
2025-05-14 19:15:38,756 - main - INFO - 
Tests completed.
2025-05-14 20:17:09,157 - main - INFO - Starting tests...
2025-05-14 20:17:09,158 - main - INFO - Testing PostgreSQL connection...
2025-05-14 20:17:09,181 - src.connectors.postgres_connector - INFO - Connected to PostgreSQL
2025-05-14 20:17:09,181 - main - INFO - PostgreSQL connection successful
2025-05-14 20:17:09,191 - main - INFO - PostgreSQL version: PostgreSQL 15.12 (Debian 15.12-0+deb12u2) on x86_64-pc-linux-gnu, compiled by gcc (Debian 12.2.0-14) 12.2.0, 64-bit
2025-05-14 20:17:09,191 - src.connectors.postgres_connector - INFO - Disconnected from PostgreSQL
2025-05-14 20:17:09,191 - main - INFO - Testing Firebird connection...
2025-05-14 20:17:09,191 - main - INFO - Firebird config: {'host': '192.168.160.168:3050', 'database': '099-1', 'user': 'SYSDBA', 'password': 'masterkey', 'charset': 'UTF-8', 'debug': True}
2025-05-14 20:17:09,191 - src.connectors.firebird_connector - INFO - Testing TCP connectivity to 192.168.160.168:3050
2025-05-14 20:17:09,290 - src.connectors.firebird_connector - INFO - TCP connection to 192.168.160.168:3050 successful
2025-05-14 20:17:09,294 - src.connectors.firebird_connector - INFO - Attempting to connect to Firebird at 192.168.160.168:3050, database: 099-1
2025-05-14 20:17:09,753 - src.connectors.firebird_connector - INFO - Connected to Firebird (Инфоклиника) using firebird-driver
2025-05-14 20:17:09,753 - main - INFO - Firebird connection successful
2025-05-14 20:17:10,005 - main - INFO - Firebird current time: 2025-05-14 20:17:09.973000
2025-05-14 20:17:10,198 - src.connectors.firebird_connector - ERROR - Error fetching patients from Firebird (Инфоклиника): Dynamic SQL Error
-SQL error code = -204
-Table unknown
-PATIENTS
-At line 13, column 22
2025-05-14 20:17:10,198 - main - INFO - Retrieved 0 patients from Firebird (Инфоклиника)
2025-05-14 20:17:10,337 - src.connectors.firebird_connector - INFO - Disconnected from Firebird (Инфоклиника)
2025-05-14 20:17:10,337 - main - INFO - Testing YottaDB connection...
2025-05-14 20:17:10,338 - main - ERROR - YottaDB connection failed
2025-05-14 20:17:10,338 - main - INFO - Testing PostgreSQL schema...
2025-05-14 20:17:10,383 - src.connectors.postgres_connector - INFO - Connected to PostgreSQL
2025-05-14 20:17:10,406 - main - INFO - All essential tables exist
2025-05-14 20:17:10,409 - main - INFO - Found 2 HIS entries:
2025-05-14 20:17:10,409 - main - INFO -   ID: 1, Name: qMS
2025-05-14 20:17:10,409 - main - INFO -   ID: 2, Name: Инфоклиника
2025-05-14 20:17:10,410 - main - INFO - Found 3 business units:
2025-05-14 20:17:10,410 - main - INFO -   ID: 1, Name: ОО ФК "Хадасса Медикал ЛТД"
2025-05-14 20:17:10,410 - main - INFO -   ID: 2, Name: ООО "Медскан"
2025-05-14 20:17:10,410 - main - INFO -   ID: 3, Name: ООО "Клинический госпиталь на Яузе"
2025-05-14 20:17:10,410 - src.connectors.postgres_connector - INFO - Disconnected from PostgreSQL
2025-05-14 20:17:10,410 - main - INFO - Testing patient insertion...
2025-05-14 20:17:10,427 - src.connectors.postgres_connector - INFO - Connected to PostgreSQL
2025-05-14 20:17:10,446 - src.connectors.postgres_connector - INFO - Inserted/updated patient 2698070 with UUID c07329ba-3a38-44ce-8b79-81324177da05
2025-05-14 20:17:10,446 - main - INFO - Sample patient inserted successfully
2025-05-14 20:17:10,449 - main - INFO - Verified patient in database: ID=2698070, UUID=c07329ba-3a38-44ce-8b79-81324177da05, Passport=4512345678
2025-05-14 20:17:10,449 - src.connectors.postgres_connector - INFO - Disconnected from PostgreSQL
2025-05-14 20:17:10,449 - main - INFO - Testing patient fetch and import from Firebird to PostgreSQL...
2025-05-14 20:17:10,449 - src.connectors.firebird_connector - INFO - Testing TCP connectivity to 192.168.160.168:3050
2025-05-14 20:17:10,522 - src.connectors.firebird_connector - INFO - TCP connection to 192.168.160.168:3050 successful
2025-05-14 20:17:10,523 - src.connectors.firebird_connector - ERROR - Failed to connect to Firebird (Инфоклиника): Server 'infoclinica_server' already registered.
2025-05-14 20:17:10,523 - main - ERROR - Firebird connection failed
2025-05-14 20:17:10,523 - main - INFO - 
Test Results Summary:
2025-05-14 20:17:10,523 - main - INFO - PostgreSQL Connection: ✓
2025-05-14 20:17:10,524 - main - INFO - Firebird Connection: ✓
2025-05-14 20:17:10,524 - main - INFO - YottaDB Connection: ✗
2025-05-14 20:17:10,524 - main - INFO - PostgreSQL Schema: ✓
2025-05-14 20:17:10,524 - main - INFO - Patient Insertion: ✓
2025-05-14 20:17:10,524 - main - INFO - Firebird Import: ✗
2025-05-14 20:17:10,524 - main - INFO - 
Tests completed.
2025-05-14 20:23:00,374 - main - INFO - Starting tests...
2025-05-14 20:23:00,374 - main - INFO - Testing PostgreSQL connection...
2025-05-14 20:23:00,393 - src.connectors.postgres_connector - INFO - Connected to PostgreSQL
2025-05-14 20:23:00,393 - main - INFO - PostgreSQL connection successful
2025-05-14 20:23:00,394 - main - INFO - PostgreSQL version: PostgreSQL 15.12 (Debian 15.12-0+deb12u2) on x86_64-pc-linux-gnu, compiled by gcc (Debian 12.2.0-14) 12.2.0, 64-bit
2025-05-14 20:23:00,394 - src.connectors.postgres_connector - INFO - Disconnected from PostgreSQL
2025-05-14 20:23:00,394 - main - INFO - Testing Firebird connection...
2025-05-14 20:23:00,394 - main - INFO - Firebird config: {'host': '192.168.160.168:3050', 'database': '099-1', 'user': 'SYSDBA', 'password': 'masterkey', 'charset': 'UTF-8', 'debug': False}
2025-05-14 20:23:00,394 - src.connectors.firebird_connector - INFO - Testing TCP connectivity to 192.168.160.168:3050
2025-05-14 20:23:00,479 - src.connectors.firebird_connector - INFO - TCP connection to 192.168.160.168:3050 successful
2025-05-14 20:23:00,482 - src.connectors.firebird_connector - INFO - Attempting to connect to Firebird at 192.168.160.168:3050, database: 099-1
2025-05-14 20:23:00,890 - src.connectors.firebird_connector - INFO - Connected to Firebird (Инфоклиника) using firebird-driver
2025-05-14 20:23:00,890 - main - INFO - Firebird connection successful
2025-05-14 20:23:01,092 - main - INFO - Firebird current time: 2025-05-14 20:23:01.029000
2025-05-14 20:23:01,174 - src.connectors.firebird_connector - ERROR - Error fetching patients from Firebird (Инфоклиника): Dynamic SQL Error
-SQL error code = -204
-Table unknown
-PATIENTS
-At line 13, column 22
2025-05-14 20:23:01,174 - main - INFO - Retrieved 0 patients from Firebird (Инфоклиника)
2025-05-14 20:23:01,418 - src.connectors.firebird_connector - INFO - Disconnected from Firebird (Инфоклиника)
2025-05-14 20:23:01,419 - main - INFO - Testing YottaDB connection...
2025-05-14 20:23:01,419 - main - ERROR - YottaDB connection failed
2025-05-14 20:23:01,419 - main - INFO - Testing PostgreSQL schema...
2025-05-14 20:23:01,444 - src.connectors.postgres_connector - INFO - Connected to PostgreSQL
2025-05-14 20:23:01,450 - main - INFO - All essential tables exist
2025-05-14 20:23:01,451 - main - INFO - Found 2 HIS entries:
2025-05-14 20:23:01,451 - main - INFO -   ID: 1, Name: qMS
2025-05-14 20:23:01,451 - main - INFO -   ID: 2, Name: Инфоклиника
2025-05-14 20:23:01,451 - main - INFO - Found 3 business units:
2025-05-14 20:23:01,452 - main - INFO -   ID: 1, Name: ОО ФК "Хадасса Медикал ЛТД"
2025-05-14 20:23:01,452 - main - INFO -   ID: 2, Name: ООО "Медскан"
2025-05-14 20:23:01,452 - main - INFO -   ID: 3, Name: ООО "Клинический госпиталь на Яузе"
2025-05-14 20:23:01,452 - src.connectors.postgres_connector - INFO - Disconnected from PostgreSQL
2025-05-14 20:23:01,452 - main - INFO - Testing patient insertion...
2025-05-14 20:23:01,470 - src.connectors.postgres_connector - INFO - Connected to PostgreSQL
2025-05-14 20:23:01,478 - src.connectors.postgres_connector - INFO - Inserted/updated patient 2698071 with UUID c07329ba-3a38-44ce-8b79-81324177da05
2025-05-14 20:23:01,478 - main - INFO - Sample patient inserted successfully
2025-05-14 20:23:01,479 - main - INFO - Verified patient in database: ID=2698071, UUID=c07329ba-3a38-44ce-8b79-81324177da05, Passport=4512345678
2025-05-14 20:23:01,479 - src.connectors.postgres_connector - INFO - Disconnected from PostgreSQL
2025-05-14 20:23:01,479 - main - INFO - Testing patient fetch and import from Firebird to PostgreSQL...
2025-05-14 20:23:01,479 - src.connectors.firebird_connector - INFO - Testing TCP connectivity to 192.168.160.168:3050
2025-05-14 20:23:01,548 - src.connectors.firebird_connector - INFO - TCP connection to 192.168.160.168:3050 successful
2025-05-14 20:23:01,548 - src.connectors.firebird_connector - ERROR - Failed to connect to Firebird (Инфоклиника): Server 'infoclinica_server' already registered.
2025-05-14 20:23:01,548 - main - ERROR - Firebird connection failed
2025-05-14 20:23:01,548 - main - INFO - 
Test Results Summary:
2025-05-14 20:23:01,549 - main - INFO - PostgreSQL Connection: ✓
2025-05-14 20:23:01,549 - main - INFO - Firebird Connection: ✓
2025-05-14 20:23:01,549 - main - INFO - YottaDB Connection: ✗
2025-05-14 20:23:01,549 - main - INFO - PostgreSQL Schema: ✓
2025-05-14 20:23:01,549 - main - INFO - Patient Insertion: ✓
2025-05-14 20:23:01,549 - main - INFO - Firebird Import: ✗
2025-05-14 20:23:01,549 - main - INFO - 
Tests completed.
2025-05-15 00:21:49,930 - main - INFO - Starting tests...
2025-05-15 00:21:49,931 - main - INFO - Testing PostgreSQL connection...
2025-05-15 00:21:49,956 - src.connectors.postgres_connector - INFO - Connected to PostgreSQL
2025-05-15 00:21:49,956 - main - INFO - PostgreSQL connection successful
2025-05-15 00:21:49,966 - main - INFO - PostgreSQL version: PostgreSQL 15.12 (Debian 15.12-0+deb12u2) on x86_64-pc-linux-gnu, compiled by gcc (Debian 12.2.0-14) 12.2.0, 64-bit
2025-05-15 00:21:49,966 - src.connectors.postgres_connector - INFO - Disconnected from PostgreSQL
2025-05-15 00:21:49,966 - main - INFO - Testing Firebird connection...
2025-05-15 00:21:49,967 - main - INFO - Firebird config: {'host': '192.168.160.168:3050', 'database': '099-1', 'user': 'SYSDBA', 'password': 'masterkey', 'charset': 'UTF-8', 'debug': False}
2025-05-15 00:21:49,967 - src.connectors.firebird_connector - INFO - Testing TCP connectivity to 192.168.160.168:3050
2025-05-15 00:22:13,486 - main - INFO - Starting tests...
2025-05-15 00:22:13,486 - main - INFO - Testing PostgreSQL connection...
2025-05-15 00:22:13,500 - src.connectors.postgres_connector - INFO - Connected to PostgreSQL
2025-05-15 00:22:13,500 - main - INFO - PostgreSQL connection successful
2025-05-15 00:22:13,501 - main - INFO - PostgreSQL version: PostgreSQL 15.12 (Debian 15.12-0+deb12u2) on x86_64-pc-linux-gnu, compiled by gcc (Debian 12.2.0-14) 12.2.0, 64-bit
2025-05-15 00:22:13,501 - src.connectors.postgres_connector - INFO - Disconnected from PostgreSQL
2025-05-15 00:22:13,501 - main - INFO - Testing Firebird connection...
2025-05-15 00:22:13,501 - main - INFO - Firebird config: {'host': '192.168.160.168:3050', 'database': '099-1', 'user': 'SYSDBA', 'password': 'masterkey', 'charset': 'UTF-8', 'debug': False}
2025-05-15 00:22:13,501 - src.connectors.firebird_connector - INFO - Testing TCP connectivity to 192.168.160.168:3050
2025-05-15 00:22:13,516 - src.connectors.firebird_connector - INFO - TCP connection to 192.168.160.168:3050 successful
2025-05-15 00:22:13,517 - src.connectors.firebird_connector - INFO - Attempting to connect to Firebird at 192.168.160.168:3050, database: 099-1
2025-05-15 00:22:13,736 - src.connectors.firebird_connector - INFO - Connected to Firebird (Инфоклиника) using firebird-driver
2025-05-15 00:22:13,736 - main - INFO - Firebird connection successful
2025-05-15 00:22:13,787 - main - INFO - Firebird current time: 2025-05-15 00:22:13.770000
2025-05-15 00:22:13,811 - src.connectors.firebird_connector - ERROR - Error fetching patients from Firebird (Инфоклиника): Dynamic SQL Error
-SQL error code = -204
-Table unknown
-PATIENTS
-At line 13, column 22
2025-05-15 00:22:13,811 - main - INFO - Retrieved 0 patients from Firebird (Инфоклиника)
2025-05-15 00:22:13,842 - src.connectors.firebird_connector - INFO - Disconnected from Firebird (Инфоклиника)
2025-05-15 00:22:13,842 - main - INFO - Testing YottaDB connection...
2025-05-15 00:22:13,842 - main - ERROR - YottaDB connection failed
2025-05-15 00:22:13,842 - main - INFO - Testing PostgreSQL schema...
2025-05-15 00:22:13,854 - src.connectors.postgres_connector - INFO - Connected to PostgreSQL
2025-05-15 00:22:13,874 - main - INFO - All essential tables exist
2025-05-15 00:22:13,876 - main - INFO - Found 2 HIS entries:
2025-05-15 00:22:13,876 - main - INFO -   ID: 1, Name: qMS
2025-05-15 00:22:13,876 - main - INFO -   ID: 2, Name: Инфоклиника
2025-05-15 00:22:13,877 - main - INFO - Found 3 business units:
2025-05-15 00:22:13,877 - main - INFO -   ID: 1, Name: ОО ФК "Хадасса Медикал ЛТД"
2025-05-15 00:22:13,877 - main - INFO -   ID: 2, Name: ООО "Медскан"
2025-05-15 00:22:13,877 - main - INFO -   ID: 3, Name: ООО "Клинический госпиталь на Яузе"
2025-05-15 00:22:13,877 - src.connectors.postgres_connector - INFO - Disconnected from PostgreSQL
2025-05-15 00:22:13,878 - main - INFO - Testing patient insertion...
2025-05-15 00:22:13,889 - src.connectors.postgres_connector - INFO - Connected to PostgreSQL
2025-05-15 00:22:13,906 - src.connectors.postgres_connector - INFO - Inserted/updated patient 2698072 with UUID c07329ba-3a38-44ce-8b79-81324177da05
2025-05-15 00:22:13,907 - main - INFO - Sample patient inserted successfully
2025-05-15 00:22:13,909 - main - INFO - Verified patient in database: ID=2698072, UUID=c07329ba-3a38-44ce-8b79-81324177da05, Passport=4512345678
2025-05-15 00:22:13,909 - src.connectors.postgres_connector - INFO - Disconnected from PostgreSQL
2025-05-15 00:22:13,909 - main - INFO - Testing patient fetch and import from Firebird to PostgreSQL...
2025-05-15 00:22:13,910 - src.connectors.firebird_connector - INFO - Testing TCP connectivity to 192.168.160.168:3050
2025-05-15 00:22:13,923 - src.connectors.firebird_connector - INFO - TCP connection to 192.168.160.168:3050 successful
2025-05-15 00:22:13,923 - src.connectors.firebird_connector - ERROR - Failed to connect to Firebird (Инфоклиника): Server 'infoclinica_server' already registered.
2025-05-15 00:22:13,924 - main - ERROR - Firebird connection failed
2025-05-15 00:22:13,924 - main - INFO - 
Test Results Summary:
2025-05-15 00:22:13,924 - main - INFO - PostgreSQL Connection: ✓
2025-05-15 00:22:13,924 - main - INFO - Firebird Connection: ✓
2025-05-15 00:22:13,924 - main - INFO - YottaDB Connection: ✗
2025-05-15 00:22:13,924 - main - INFO - PostgreSQL Schema: ✓
2025-05-15 00:22:13,925 - main - INFO - Patient Insertion: ✓
2025-05-15 00:22:13,925 - main - INFO - Firebird Import: ✗
2025-05-15 00:22:13,925 - main - INFO - 
Tests completed.
2025-05-15 00:27:25,808 - main - INFO - Starting tests...
2025-05-15 00:27:25,808 - main - INFO - Testing PostgreSQL connection...
2025-05-15 00:27:25,821 - src.connectors.postgres_connector - INFO - Connected to PostgreSQL
2025-05-15 00:27:25,821 - main - INFO - PostgreSQL connection successful
2025-05-15 00:27:25,822 - main - INFO - PostgreSQL version: PostgreSQL 15.12 (Debian 15.12-0+deb12u2) on x86_64-pc-linux-gnu, compiled by gcc (Debian 12.2.0-14) 12.2.0, 64-bit
2025-05-15 00:27:25,823 - src.connectors.postgres_connector - INFO - Disconnected from PostgreSQL
2025-05-15 00:27:25,823 - main - INFO - Testing Firebird connection...
2025-05-15 00:27:25,823 - main - INFO - Firebird config: {'host': '192.168.160.168:3050', 'database': '099-1', 'user': 'SYSDBA', 'password': 'masterkey', 'charset': 'UTF-8', 'debug': False}
2025-05-15 00:27:25,823 - src.connectors.firebird_connector - INFO - Testing TCP connectivity to 192.168.160.168:3050
2025-05-15 00:27:25,839 - src.connectors.firebird_connector - INFO - TCP connection to 192.168.160.168:3050 successful
2025-05-15 00:27:25,841 - src.connectors.firebird_connector - INFO - Attempting to connect to Firebird at 192.168.160.168:3050, database: 099-1
2025-05-15 00:27:25,977 - src.connectors.firebird_connector - INFO - Connected to Firebird (Инфоклиника) using firebird-driver
2025-05-15 00:27:25,977 - main - INFO - Firebird connection successful
2025-05-15 00:27:26,252 - main - INFO - Firebird current time: 2025-05-15 00:27:26.225000
2025-05-15 00:27:26,270 - src.connectors.firebird_connector - ERROR - Error fetching patients from Firebird (Инфоклиника): Dynamic SQL Error
-SQL error code = -204
-Table unknown
-PATIENTS
-At line 13, column 22
2025-05-15 00:27:26,270 - main - INFO - Retrieved 0 patients from Firebird (Инфоклиника)
2025-05-15 00:27:26,299 - src.connectors.firebird_connector - INFO - Disconnected from Firebird (Инфоклиника)
2025-05-15 00:27:26,299 - main - INFO - Testing YottaDB connection...
2025-05-15 00:27:26,299 - main - ERROR - YottaDB connection failed
2025-05-15 00:27:26,300 - main - INFO - Testing PostgreSQL schema...
2025-05-15 00:27:26,332 - src.connectors.postgres_connector - INFO - Connected to PostgreSQL
2025-05-15 00:27:26,341 - main - INFO - All essential tables exist
2025-05-15 00:27:26,342 - main - INFO - Found 2 HIS entries:
2025-05-15 00:27:26,342 - main - INFO -   ID: 1, Name: qMS
2025-05-15 00:27:26,342 - main - INFO -   ID: 2, Name: Инфоклиника
2025-05-15 00:27:26,342 - main - INFO - Found 3 business units:
2025-05-15 00:27:26,343 - main - INFO -   ID: 1, Name: ОО ФК "Хадасса Медикал ЛТД"
2025-05-15 00:27:26,343 - main - INFO -   ID: 2, Name: ООО "Медскан"
2025-05-15 00:27:26,343 - main - INFO -   ID: 3, Name: ООО "Клинический госпиталь на Яузе"
2025-05-15 00:27:26,343 - src.connectors.postgres_connector - INFO - Disconnected from PostgreSQL
2025-05-15 00:27:26,343 - main - INFO - Testing patient insertion...
2025-05-15 00:27:26,368 - src.connectors.postgres_connector - INFO - Connected to PostgreSQL
2025-05-15 00:27:26,379 - src.connectors.postgres_connector - INFO - Inserted/updated patient 2798073 with UUID 129efa02-ad57-4d90-8082-9397e39b3573
2025-05-15 00:27:26,379 - main - INFO - Sample patient inserted successfully
2025-05-15 00:27:26,381 - main - INFO - Verified patient in database: ID=2798073, UUID=129efa02-ad57-4d90-8082-9397e39b3573, Passport=4512345678
2025-05-15 00:27:26,381 - src.connectors.postgres_connector - INFO - Disconnected from PostgreSQL
2025-05-15 00:27:26,381 - main - INFO - Testing patient fetch and import from Firebird to PostgreSQL...
2025-05-15 00:27:26,381 - src.connectors.firebird_connector - INFO - Testing TCP connectivity to 192.168.160.168:3050
2025-05-15 00:27:26,396 - src.connectors.firebird_connector - INFO - TCP connection to 192.168.160.168:3050 successful
2025-05-15 00:27:26,396 - src.connectors.firebird_connector - ERROR - Failed to connect to Firebird (Инфоклиника): Server 'infoclinica_server' already registered.
2025-05-15 00:27:26,397 - main - ERROR - Firebird connection failed
2025-05-15 00:27:26,397 - main - INFO - 
Test Results Summary:
2025-05-15 00:27:26,397 - main - INFO - PostgreSQL Connection: ✓
2025-05-15 00:27:26,397 - main - INFO - Firebird Connection: ✓
2025-05-15 00:27:26,397 - main - INFO - YottaDB Connection: ✗
2025-05-15 00:27:26,397 - main - INFO - PostgreSQL Schema: ✓
2025-05-15 00:27:26,397 - main - INFO - Patient Insertion: ✓
2025-05-15 00:27:26,397 - main - INFO - Firebird Import: ✗
2025-05-15 00:27:26,397 - main - INFO - 
Tests completed.
2025-05-15 01:19:13,518 - main - INFO - Starting tests...
2025-05-15 01:19:13,518 - main - INFO - Testing PostgreSQL connection...
2025-05-15 01:19:13,530 - src.connectors.postgres_connector - INFO - Connected to PostgreSQL
2025-05-15 01:19:13,530 - main - INFO - PostgreSQL connection successful
2025-05-15 01:19:13,531 - main - INFO - PostgreSQL version: PostgreSQL 15.12 (Debian 15.12-0+deb12u2) on x86_64-pc-linux-gnu, compiled by gcc (Debian 12.2.0-14) 12.2.0, 64-bit
2025-05-15 01:19:13,531 - src.connectors.postgres_connector - INFO - Disconnected from PostgreSQL
2025-05-15 01:19:13,531 - main - INFO - Testing Firebird connection...
2025-05-15 01:19:13,531 - main - INFO - Firebird config: {'host': '192.168.160.168:3050', 'database': '099-1', 'user': 'SYSDBA', 'password': 'masterkey', 'charset': 'UTF-8', 'debug': False}
2025-05-15 01:19:13,531 - src.connectors.firebird_connector - INFO - Testing TCP connectivity to 192.168.160.168:3050
2025-05-15 01:19:13,545 - src.connectors.firebird_connector - INFO - TCP connection to 192.168.160.168:3050 successful
2025-05-15 01:19:13,546 - src.connectors.firebird_connector - INFO - Attempting to connect to Firebird at 192.168.160.168:3050, database: 099-1
2025-05-15 01:19:13,713 - src.connectors.firebird_connector - INFO - Connected to Firebird (Инфоклиника) using firebird-driver
2025-05-15 01:19:13,714 - main - INFO - Firebird connection successful
2025-05-15 01:19:13,767 - main - INFO - Firebird current time: 2025-05-15 01:19:13.756000
2025-05-15 01:19:13,787 - src.connectors.firebird_connector - ERROR - Error fetching patients from Firebird (Инфоклиника): Dynamic SQL Error
-SQL error code = -204
-Table unknown
-PATIENTS
-At line 13, column 22
2025-05-15 01:19:13,788 - main - INFO - Retrieved 0 patients from Firebird (Инфоклиника)
2025-05-15 01:19:13,823 - src.connectors.firebird_connector - INFO - Disconnected from Firebird (Инфоклиника)
2025-05-15 01:19:13,823 - main - INFO - Testing YottaDB connection...
2025-05-15 01:19:13,824 - main - ERROR - YottaDB connection failed
2025-05-15 01:19:13,824 - main - INFO - Testing PostgreSQL schema...
2025-05-15 01:19:13,846 - src.connectors.postgres_connector - INFO - Connected to PostgreSQL
2025-05-15 01:19:13,853 - main - INFO - All essential tables exist
2025-05-15 01:19:13,854 - main - INFO - Found 2 HIS entries:
2025-05-15 01:19:13,854 - main - INFO -   ID: 1, Name: qMS
2025-05-15 01:19:13,854 - main - INFO -   ID: 2, Name: Инфоклиника
2025-05-15 01:19:13,854 - main - INFO - Found 3 business units:
2025-05-15 01:19:13,855 - main - INFO -   ID: 1, Name: ОО ФК "Хадасса Медикал ЛТД"
2025-05-15 01:19:13,855 - main - INFO -   ID: 2, Name: ООО "Медскан"
2025-05-15 01:19:13,855 - main - INFO -   ID: 3, Name: ООО "Клинический госпиталь на Яузе"
2025-05-15 01:19:13,855 - main - INFO - Found 17 document types:
2025-05-15 01:19:13,855 - main - INFO -   ID: 1, Name: Паспорт
2025-05-15 01:19:13,855 - main - INFO -   ID: 2, Name: Паспорт СССР
2025-05-15 01:19:13,856 - main - INFO -   ID: 3, Name: Заграничный паспорт РФ
2025-05-15 01:19:13,856 - main - INFO -   ID: 4, Name: Заграничный паспорт СССР
2025-05-15 01:19:13,856 - main - INFO -   ID: 5, Name: Свидетельство о рождении
2025-05-15 01:19:13,856 - main - INFO -   ... and 12 more document types
2025-05-15 01:19:13,856 - src.connectors.postgres_connector - INFO - Disconnected from PostgreSQL
2025-05-15 01:19:13,856 - main - INFO - Testing document type handling...
2025-05-15 01:19:13,876 - src.connectors.postgres_connector - INFO - Connected to PostgreSQL
2025-05-15 01:19:13,878 - main - INFO - Found 17 document types in the documenttypes table
2025-05-15 01:19:13,880 - src.connectors.postgres_connector - ERROR - Error inserting patient: ОШИБКА:  столбец "passport" в таблице "patientsdet" не существует
LINE 2: ...businessunit, lastname, name, surname, birthdate, passport, ...
                                                             ^

2025-05-15 01:19:13,881 - src.connectors.postgres_connector - ERROR - Error inserting patient: ОШИБКА:  столбец "passport" в таблице "patientsdet" не существует
LINE 2: ...businessunit, lastname, name, surname, birthdate, passport, ...
                                                             ^

2025-05-15 01:19:13,881 - src.connectors.postgres_connector - ERROR - Error inserting patient: ОШИБКА:  столбец "passport" в таблице "patientsdet" не существует
LINE 2: ...businessunit, lastname, name, surname, birthdate, passport, ...
                                                             ^

2025-05-15 01:19:13,882 - src.connectors.postgres_connector - ERROR - Error inserting patient: ОШИБКА:  столбец "passport" в таблице "patientsdet" не существует
LINE 2: ...businessunit, lastname, name, surname, birthdate, passport, ...
                                                             ^

2025-05-15 01:19:13,882 - src.connectors.postgres_connector - ERROR - Error inserting patient: ОШИБКА:  столбец "passport" в таблице "patientsdet" не существует
LINE 2: ...businessunit, lastname, name, surname, birthdate, passport, ...
                                                             ^

2025-05-15 01:19:13,882 - src.connectors.postgres_connector - ERROR - Error inserting patient: ОШИБКА:  столбец "passport" в таблице "patientsdet" не существует
LINE 2: ...businessunit, lastname, name, surname, birthdate, passport, ...
                                                             ^

2025-05-15 01:19:13,882 - main - INFO - Successfully inserted 0 out of 6 test patients with different document types
2025-05-15 01:19:13,883 - src.connectors.postgres_connector - INFO - Disconnected from PostgreSQL
2025-05-15 01:19:13,883 - main - INFO - Testing patient insertion...
2025-05-15 01:19:13,898 - src.connectors.postgres_connector - INFO - Connected to PostgreSQL
2025-05-15 01:19:13,898 - main - INFO - Using document type: Заграничный паспорт РФ (ID: 3) with number: 101865516
2025-05-15 01:19:13,899 - src.connectors.postgres_connector - ERROR - Error inserting patient: ОШИБКА:  столбец "passport" в таблице "patientsdet" не существует
LINE 2: ...businessunit, lastname, name, surname, birthdate, passport, ...
                                                             ^

2025-05-15 01:19:13,899 - main - ERROR - Failed to insert sample patient
2025-05-15 01:19:13,900 - src.connectors.postgres_connector - INFO - Disconnected from PostgreSQL
2025-05-15 01:19:13,900 - main - INFO - Testing patient fetch and import from Firebird to PostgreSQL...
2025-05-15 01:19:13,900 - src.connectors.firebird_connector - INFO - Testing TCP connectivity to 192.168.160.168:3050
2025-05-15 01:19:13,913 - src.connectors.firebird_connector - INFO - TCP connection to 192.168.160.168:3050 successful
2025-05-15 01:19:13,913 - src.connectors.firebird_connector - ERROR - Failed to connect to Firebird (Инфоклиника): Server 'infoclinica_server' already registered.
2025-05-15 01:19:13,913 - main - ERROR - Firebird connection failed
2025-05-15 01:19:13,913 - main - INFO - 
Test Results Summary:
2025-05-15 01:19:13,913 - main - INFO - PostgreSQL Connection: ✓
2025-05-15 01:19:13,913 - main - INFO - Firebird Connection: ✓
2025-05-15 01:19:13,914 - main - INFO - YottaDB Connection: ✗
2025-05-15 01:19:13,914 - main - INFO - PostgreSQL Schema: ✓
2025-05-15 01:19:13,914 - main - INFO - Document Type Handling: ✗
2025-05-15 01:19:13,914 - main - INFO - Patient Insertion: ✗
2025-05-15 01:19:13,914 - main - INFO - Firebird Import: ✗
2025-05-15 01:19:13,914 - main - INFO - 
Tests completed.
2025-05-15 01:21:23,486 - main - INFO - Starting tests...
2025-05-15 01:21:23,486 - main - INFO - Testing PostgreSQL connection...
2025-05-15 01:21:23,500 - src.connectors.postgres_connector - INFO - Connected to PostgreSQL
2025-05-15 01:21:23,500 - main - INFO - PostgreSQL connection successful
2025-05-15 01:21:23,500 - main - INFO - PostgreSQL version: PostgreSQL 15.12 (Debian 15.12-0+deb12u2) on x86_64-pc-linux-gnu, compiled by gcc (Debian 12.2.0-14) 12.2.0, 64-bit
2025-05-15 01:21:23,501 - src.connectors.postgres_connector - INFO - Disconnected from PostgreSQL
2025-05-15 01:21:23,501 - main - INFO - Testing Firebird connection...
2025-05-15 01:21:23,501 - main - INFO - Firebird config: {'host': '192.168.160.168:3050', 'database': '099-1', 'user': 'SYSDBA', 'password': 'masterkey', 'charset': 'UTF-8', 'debug': False}
2025-05-15 01:21:23,501 - src.connectors.firebird_connector - INFO - Testing TCP connectivity to 192.168.160.168:3050
2025-05-15 01:21:23,515 - src.connectors.firebird_connector - INFO - TCP connection to 192.168.160.168:3050 successful
2025-05-15 01:21:23,516 - src.connectors.firebird_connector - INFO - Attempting to connect to Firebird at 192.168.160.168:3050, database: 099-1
2025-05-15 01:21:23,638 - src.connectors.firebird_connector - INFO - Connected to Firebird (Инфоклиника) using firebird-driver
2025-05-15 01:21:23,639 - main - INFO - Firebird connection successful
2025-05-15 01:21:23,687 - main - INFO - Firebird current time: 2025-05-15 01:21:23.663000
2025-05-15 01:21:23,706 - src.connectors.firebird_connector - ERROR - Error fetching patients from Firebird (Инфоклиника): Dynamic SQL Error
-SQL error code = -204
-Table unknown
-PATIENTS
-At line 13, column 22
2025-05-15 01:21:23,706 - main - INFO - Retrieved 0 patients from Firebird (Инфоклиника)
2025-05-15 01:21:23,735 - src.connectors.firebird_connector - INFO - Disconnected from Firebird (Инфоклиника)
2025-05-15 01:21:23,735 - main - INFO - Testing YottaDB connection...
2025-05-15 01:21:23,735 - main - ERROR - YottaDB connection failed
2025-05-15 01:21:23,735 - main - INFO - Testing PostgreSQL schema...
2025-05-15 01:21:23,749 - src.connectors.postgres_connector - INFO - Connected to PostgreSQL
2025-05-15 01:21:23,754 - main - INFO - All essential tables exist
2025-05-15 01:21:23,755 - main - INFO - Found 2 HIS entries:
2025-05-15 01:21:23,755 - main - INFO -   ID: 1, Name: qMS
2025-05-15 01:21:23,755 - main - INFO -   ID: 2, Name: Инфоклиника
2025-05-15 01:21:23,755 - main - INFO - Found 3 business units:
2025-05-15 01:21:23,755 - main - INFO -   ID: 1, Name: ОО ФК "Хадасса Медикал ЛТД"
2025-05-15 01:21:23,755 - main - INFO -   ID: 2, Name: ООО "Медскан"
2025-05-15 01:21:23,755 - main - INFO -   ID: 3, Name: ООО "Клинический госпиталь на Яузе"
2025-05-15 01:21:23,756 - main - INFO - Found 17 document types:
2025-05-15 01:21:23,756 - main - INFO -   ID: 1, Name: Паспорт
2025-05-15 01:21:23,756 - main - INFO -   ID: 2, Name: Паспорт СССР
2025-05-15 01:21:23,756 - main - INFO -   ID: 3, Name: Заграничный паспорт РФ
2025-05-15 01:21:23,756 - main - INFO -   ID: 4, Name: Заграничный паспорт СССР
2025-05-15 01:21:23,756 - main - INFO -   ID: 5, Name: Свидетельство о рождении
2025-05-15 01:21:23,756 - main - INFO -   ... and 12 more document types
2025-05-15 01:21:23,756 - src.connectors.postgres_connector - INFO - Disconnected from PostgreSQL
2025-05-15 01:21:23,756 - main - INFO - Testing document type handling...
2025-05-15 01:21:23,771 - src.connectors.postgres_connector - INFO - Connected to PostgreSQL
2025-05-15 01:21:23,772 - main - INFO - Found 17 document types in the documenttypes table
2025-05-15 01:21:23,772 - src.connectors.postgres_connector - ERROR - Error inserting patient: ОШИБКА:  столбец "passport" в таблице "patientsdet" не существует
LINE 2: ...businessunit, lastname, name, surname, birthdate, passport, ...
                                                             ^

2025-05-15 01:21:23,773 - src.connectors.postgres_connector - ERROR - Error inserting patient: ОШИБКА:  столбец "passport" в таблице "patientsdet" не существует
LINE 2: ...businessunit, lastname, name, surname, birthdate, passport, ...
                                                             ^

2025-05-15 01:21:23,773 - src.connectors.postgres_connector - ERROR - Error inserting patient: ОШИБКА:  столбец "passport" в таблице "patientsdet" не существует
LINE 2: ...businessunit, lastname, name, surname, birthdate, passport, ...
                                                             ^

2025-05-15 01:21:23,774 - src.connectors.postgres_connector - ERROR - Error inserting patient: ОШИБКА:  столбец "passport" в таблице "patientsdet" не существует
LINE 2: ...businessunit, lastname, name, surname, birthdate, passport, ...
                                                             ^

2025-05-15 01:21:23,774 - src.connectors.postgres_connector - ERROR - Error inserting patient: ОШИБКА:  столбец "passport" в таблице "patientsdet" не существует
LINE 2: ...businessunit, lastname, name, surname, birthdate, passport, ...
                                                             ^

2025-05-15 01:21:23,774 - src.connectors.postgres_connector - ERROR - Error inserting patient: ОШИБКА:  столбец "passport" в таблице "patientsdet" не существует
LINE 2: ...businessunit, lastname, name, surname, birthdate, passport, ...
                                                             ^

2025-05-15 01:21:23,774 - main - INFO - Successfully inserted 0 out of 6 test patients with different document types
2025-05-15 01:21:23,774 - src.connectors.postgres_connector - INFO - Disconnected from PostgreSQL
2025-05-15 01:21:23,775 - main - INFO - Testing patient insertion...
2025-05-15 01:21:23,788 - src.connectors.postgres_connector - INFO - Connected to PostgreSQL
2025-05-15 01:21:23,788 - main - INFO - Using document type: Временное удостоверение (ID: 14) with number: 49632547
2025-05-15 01:21:23,789 - src.connectors.postgres_connector - ERROR - Error inserting patient: ОШИБКА:  столбец "passport" в таблице "patientsdet" не существует
LINE 2: ...businessunit, lastname, name, surname, birthdate, passport, ...
                                                             ^

2025-05-15 01:21:23,789 - main - ERROR - Failed to insert sample patient
2025-05-15 01:21:23,790 - src.connectors.postgres_connector - INFO - Disconnected from PostgreSQL
2025-05-15 01:21:23,790 - main - INFO - Testing patient fetch and import from Firebird to PostgreSQL...
2025-05-15 01:21:23,790 - src.connectors.firebird_connector - INFO - Testing TCP connectivity to 192.168.160.168:3050
2025-05-15 01:21:23,802 - src.connectors.firebird_connector - INFO - TCP connection to 192.168.160.168:3050 successful
2025-05-15 01:21:23,803 - src.connectors.firebird_connector - ERROR - Failed to connect to Firebird (Инфоклиника): Server 'infoclinica_server' already registered.
2025-05-15 01:21:23,803 - main - ERROR - Firebird connection failed
2025-05-15 01:21:23,803 - main - INFO - 
Test Results Summary:
2025-05-15 01:21:23,803 - main - INFO - PostgreSQL Connection: ✓
2025-05-15 01:21:23,804 - main - INFO - Firebird Connection: ✓
2025-05-15 01:21:23,804 - main - INFO - YottaDB Connection: ✗
2025-05-15 01:21:23,804 - main - INFO - PostgreSQL Schema: ✓
2025-05-15 01:21:23,804 - main - INFO - Document Type Handling: ✗
2025-05-15 01:21:23,804 - main - INFO - Patient Insertion: ✗
2025-05-15 01:21:23,804 - main - INFO - Firebird Import: ✗
2025-05-15 01:21:23,804 - main - INFO - 
Tests completed.
2025-05-15 01:29:29,891 - main - INFO - Starting tests...
2025-05-15 01:29:29,892 - main - INFO - Testing PostgreSQL connection...
2025-05-15 01:29:29,907 - src.connectors.postgres_connector - INFO - Connected to PostgreSQL
2025-05-15 01:29:29,907 - main - INFO - PostgreSQL connection successful
2025-05-15 01:29:29,908 - main - INFO - PostgreSQL version: PostgreSQL 15.12 (Debian 15.12-0+deb12u2) on x86_64-pc-linux-gnu, compiled by gcc (Debian 12.2.0-14) 12.2.0, 64-bit
2025-05-15 01:29:29,908 - src.connectors.postgres_connector - INFO - Disconnected from PostgreSQL
2025-05-15 01:29:29,908 - main - INFO - Testing Firebird connection...
2025-05-15 01:29:29,908 - main - INFO - Firebird config: {'host': '192.168.160.168:3050', 'database': '099-1', 'user': 'SYSDBA', 'password': 'masterkey', 'charset': 'UTF-8', 'debug': False}
2025-05-15 01:29:29,908 - src.connectors.firebird_connector - INFO - Testing TCP connectivity to 192.168.160.168:3050
2025-05-15 01:29:29,922 - src.connectors.firebird_connector - INFO - TCP connection to 192.168.160.168:3050 successful
2025-05-15 01:29:29,923 - src.connectors.firebird_connector - INFO - Attempting to connect to Firebird at 192.168.160.168:3050, database: 099-1
2025-05-15 01:29:30,041 - src.connectors.firebird_connector - INFO - Connected to Firebird (Инфоклиника) using firebird-driver
2025-05-15 01:29:30,041 - main - INFO - Firebird connection successful
2025-05-15 01:29:30,091 - main - INFO - Firebird current time: 2025-05-15 01:29:30.072000
2025-05-15 01:29:30,110 - src.connectors.firebird_connector - ERROR - Error fetching patients from Firebird (Инфоклиника): Dynamic SQL Error
-SQL error code = -204
-Table unknown
-PATIENTS
-At line 13, column 22
2025-05-15 01:29:30,110 - main - INFO - Retrieved 0 patients from Firebird (Инфоклиника)
2025-05-15 01:29:30,141 - src.connectors.firebird_connector - INFO - Disconnected from Firebird (Инфоклиника)
2025-05-15 01:29:30,142 - main - INFO - Testing YottaDB connection...
2025-05-15 01:29:30,142 - main - ERROR - YottaDB connection failed
2025-05-15 01:29:30,142 - main - INFO - Testing PostgreSQL schema...
2025-05-15 01:29:30,189 - src.connectors.postgres_connector - INFO - Connected to PostgreSQL
2025-05-15 01:29:30,199 - main - INFO - All essential tables exist
2025-05-15 01:29:30,200 - main - INFO - Found 2 HIS entries:
2025-05-15 01:29:30,200 - main - INFO -   ID: 1, Name: qMS
2025-05-15 01:29:30,200 - main - INFO -   ID: 2, Name: Инфоклиника
2025-05-15 01:29:30,201 - main - INFO - Found 3 business units:
2025-05-15 01:29:30,201 - main - INFO -   ID: 1, Name: ОО ФК "Хадасса Медикал ЛТД"
2025-05-15 01:29:30,201 - main - INFO -   ID: 2, Name: ООО "Медскан"
2025-05-15 01:29:30,201 - main - INFO -   ID: 3, Name: ООО "Клинический госпиталь на Яузе"
2025-05-15 01:29:30,202 - main - INFO - Found 17 document types:
2025-05-15 01:29:30,202 - main - INFO -   ID: 1, Name: Паспорт
2025-05-15 01:29:30,202 - main - INFO -   ID: 2, Name: Паспорт СССР
2025-05-15 01:29:30,202 - main - INFO -   ID: 3, Name: Заграничный паспорт РФ
2025-05-15 01:29:30,202 - main - INFO -   ID: 4, Name: Заграничный паспорт СССР
2025-05-15 01:29:30,202 - main - INFO -   ID: 5, Name: Свидетельство о рождении
2025-05-15 01:29:30,202 - main - INFO -   ... and 12 more document types
2025-05-15 01:29:30,202 - src.connectors.postgres_connector - INFO - Disconnected from PostgreSQL
2025-05-15 01:29:30,203 - main - INFO - Testing document type handling...
2025-05-15 01:29:30,227 - src.connectors.postgres_connector - INFO - Connected to PostgreSQL
2025-05-15 01:29:30,228 - main - INFO - Found 17 document types in the documenttypes table
2025-05-15 01:29:30,235 - src.connectors.postgres_connector - ERROR - Error inserting patient: ОШИБКА:  столбец "passport" в таблице "patient_matching_log" не существует
LINE 2:                 hisnumber, source, match_type, passport, cre...
                                                       ^
QUERY:  INSERT INTO patient_matching_log (
                hisnumber, source, match_type, passport, created_uuid
            ) VALUES (
                NEW.hisnumber, NEW.source, 'NEW', NEW.document_number, TRUE
            )
CONTEXT:  функция PL/pgSQL process_new_patient(), строка 95, оператор SQL-оператор

2025-05-15 01:29:30,236 - src.connectors.postgres_connector - ERROR - Error inserting patient: ОШИБКА:  столбец "passport" в таблице "patient_matching_log" не существует
LINE 2:                 hisnumber, source, match_type, passport, cre...
                                                       ^
QUERY:  INSERT INTO patient_matching_log (
                hisnumber, source, match_type, passport, created_uuid
            ) VALUES (
                NEW.hisnumber, NEW.source, 'NEW', NEW.document_number, TRUE
            )
CONTEXT:  функция PL/pgSQL process_new_patient(), строка 95, оператор SQL-оператор

2025-05-15 01:29:30,237 - src.connectors.postgres_connector - ERROR - Error inserting patient: ОШИБКА:  столбец "passport" в таблице "patient_matching_log" не существует
LINE 2:                 hisnumber, source, match_type, passport, cre...
                                                       ^
QUERY:  INSERT INTO patient_matching_log (
                hisnumber, source, match_type, passport, created_uuid
            ) VALUES (
                NEW.hisnumber, NEW.source, 'NEW', NEW.document_number, TRUE
            )
CONTEXT:  функция PL/pgSQL process_new_patient(), строка 95, оператор SQL-оператор

2025-05-15 01:29:30,239 - src.connectors.postgres_connector - ERROR - Error inserting patient: ОШИБКА:  столбец "passport" в таблице "patient_matching_log" не существует
LINE 2:                 hisnumber, source, match_type, passport, cre...
                                                       ^
QUERY:  INSERT INTO patient_matching_log (
                hisnumber, source, match_type, passport, created_uuid
            ) VALUES (
                NEW.hisnumber, NEW.source, 'NEW', NEW.document_number, TRUE
            )
CONTEXT:  функция PL/pgSQL process_new_patient(), строка 95, оператор SQL-оператор

2025-05-15 01:29:30,240 - src.connectors.postgres_connector - ERROR - Error inserting patient: ОШИБКА:  столбец "passport" в таблице "patient_matching_log" не существует
LINE 2:                 hisnumber, source, match_type, passport, cre...
                                                       ^
QUERY:  INSERT INTO patient_matching_log (
                hisnumber, source, match_type, passport, created_uuid
            ) VALUES (
                NEW.hisnumber, NEW.source, 'NEW', NEW.document_number, TRUE
            )
CONTEXT:  функция PL/pgSQL process_new_patient(), строка 95, оператор SQL-оператор

2025-05-15 01:29:30,241 - src.connectors.postgres_connector - ERROR - Error inserting patient: ОШИБКА:  столбец "passport" в таблице "patient_matching_log" не существует
LINE 2:                 hisnumber, source, match_type, passport, cre...
                                                       ^
QUERY:  INSERT INTO patient_matching_log (
                hisnumber, source, match_type, passport, created_uuid
            ) VALUES (
                NEW.hisnumber, NEW.source, 'NEW', NEW.document_number, TRUE
            )
CONTEXT:  функция PL/pgSQL process_new_patient(), строка 95, оператор SQL-оператор

2025-05-15 01:29:30,241 - main - INFO - Successfully inserted 0 out of 6 test patients with different document types
2025-05-15 01:29:30,241 - src.connectors.postgres_connector - INFO - Disconnected from PostgreSQL
2025-05-15 01:29:30,242 - main - INFO - Testing patient insertion...
2025-05-15 01:29:30,261 - src.connectors.postgres_connector - INFO - Connected to PostgreSQL
2025-05-15 01:29:30,261 - main - INFO - Using document type: Паспорт (ID: 1) with number: 8566171141
2025-05-15 01:29:30,266 - src.connectors.postgres_connector - ERROR - Error inserting patient: ОШИБКА:  столбец "passport" в таблице "patient_matching_log" не существует
LINE 2:                 hisnumber, source, match_type, passport, cre...
                                                       ^
QUERY:  INSERT INTO patient_matching_log (
                hisnumber, source, match_type, passport, created_uuid
            ) VALUES (
                NEW.hisnumber, NEW.source, 'NEW', NEW.document_number, TRUE
            )
CONTEXT:  функция PL/pgSQL process_new_patient(), строка 95, оператор SQL-оператор

2025-05-15 01:29:30,266 - main - ERROR - Failed to insert sample patient
2025-05-15 01:29:30,266 - src.connectors.postgres_connector - INFO - Disconnected from PostgreSQL
2025-05-15 01:29:30,266 - main - INFO - Testing patient fetch and import from Firebird to PostgreSQL...
2025-05-15 01:29:30,266 - src.connectors.firebird_connector - INFO - Testing TCP connectivity to 192.168.160.168:3050
2025-05-15 01:29:30,295 - src.connectors.firebird_connector - INFO - TCP connection to 192.168.160.168:3050 successful
2025-05-15 01:29:30,295 - src.connectors.firebird_connector - ERROR - Failed to connect to Firebird (Инфоклиника): Server 'infoclinica_server' already registered.
2025-05-15 01:29:30,296 - main - ERROR - Firebird connection failed
2025-05-15 01:29:30,296 - main - INFO - 
Test Results Summary:
2025-05-15 01:29:30,296 - main - INFO - PostgreSQL Connection: ✓
2025-05-15 01:29:30,296 - main - INFO - Firebird Connection: ✓
2025-05-15 01:29:30,296 - main - INFO - YottaDB Connection: ✗
2025-05-15 01:29:30,296 - main - INFO - PostgreSQL Schema: ✓
2025-05-15 01:29:30,296 - main - INFO - Document Type Handling: ✗
2025-05-15 01:29:30,297 - main - INFO - Patient Insertion: ✗
2025-05-15 01:29:30,297 - main - INFO - Firebird Import: ✗
2025-05-15 01:29:30,297 - main - INFO - 
Tests completed.
2025-05-15 01:31:00,153 - main - INFO - Starting tests...
2025-05-15 01:31:00,153 - main - INFO - Testing PostgreSQL connection...
2025-05-15 01:31:00,167 - src.connectors.postgres_connector - INFO - Connected to PostgreSQL
2025-05-15 01:31:00,167 - main - INFO - PostgreSQL connection successful
2025-05-15 01:31:00,168 - main - INFO - PostgreSQL version: PostgreSQL 15.12 (Debian 15.12-0+deb12u2) on x86_64-pc-linux-gnu, compiled by gcc (Debian 12.2.0-14) 12.2.0, 64-bit
2025-05-15 01:31:00,168 - src.connectors.postgres_connector - INFO - Disconnected from PostgreSQL
2025-05-15 01:31:00,168 - main - INFO - Testing Firebird connection...
2025-05-15 01:31:00,168 - main - INFO - Firebird config: {'host': '192.168.160.168:3050', 'database': '099-1', 'user': 'SYSDBA', 'password': 'masterkey', 'charset': 'UTF-8', 'debug': False}
2025-05-15 01:31:00,168 - src.connectors.firebird_connector - INFO - Testing TCP connectivity to 192.168.160.168:3050
2025-05-15 01:31:00,184 - src.connectors.firebird_connector - INFO - TCP connection to 192.168.160.168:3050 successful
2025-05-15 01:31:00,186 - src.connectors.firebird_connector - INFO - Attempting to connect to Firebird at 192.168.160.168:3050, database: 099-1
2025-05-15 01:31:00,306 - src.connectors.firebird_connector - INFO - Connected to Firebird (Инфоклиника) using firebird-driver
2025-05-15 01:31:00,307 - main - INFO - Firebird connection successful
2025-05-15 01:31:00,355 - main - INFO - Firebird current time: 2025-05-15 01:31:00.337000
2025-05-15 01:31:00,376 - src.connectors.firebird_connector - ERROR - Error fetching patients from Firebird (Инфоклиника): Dynamic SQL Error
-SQL error code = -204
-Table unknown
-PATIENTS
-At line 13, column 22
2025-05-15 01:31:00,376 - main - INFO - Retrieved 0 patients from Firebird (Инфоклиника)
2025-05-15 01:31:00,413 - src.connectors.firebird_connector - INFO - Disconnected from Firebird (Инфоклиника)
2025-05-15 01:31:00,413 - main - INFO - Testing YottaDB connection...
2025-05-15 01:31:00,413 - main - ERROR - YottaDB connection failed
2025-05-15 01:31:00,413 - main - INFO - Testing PostgreSQL schema...
2025-05-15 01:31:00,427 - src.connectors.postgres_connector - INFO - Connected to PostgreSQL
2025-05-15 01:31:00,432 - main - INFO - All essential tables exist
2025-05-15 01:31:00,432 - main - INFO - Found 2 HIS entries:
2025-05-15 01:31:00,432 - main - INFO -   ID: 1, Name: qMS
2025-05-15 01:31:00,432 - main - INFO -   ID: 2, Name: Инфоклиника
2025-05-15 01:31:00,432 - main - INFO - Found 3 business units:
2025-05-15 01:31:00,433 - main - INFO -   ID: 1, Name: ОО ФК "Хадасса Медикал ЛТД"
2025-05-15 01:31:00,433 - main - INFO -   ID: 2, Name: ООО "Медскан"
2025-05-15 01:31:00,433 - main - INFO -   ID: 3, Name: ООО "Клинический госпиталь на Яузе"
2025-05-15 01:31:00,433 - main - INFO - Found 17 document types:
2025-05-15 01:31:00,433 - main - INFO -   ID: 1, Name: Паспорт
2025-05-15 01:31:00,433 - main - INFO -   ID: 2, Name: Паспорт СССР
2025-05-15 01:31:00,433 - main - INFO -   ID: 3, Name: Заграничный паспорт РФ
2025-05-15 01:31:00,433 - main - INFO -   ID: 4, Name: Заграничный паспорт СССР
2025-05-15 01:31:00,433 - main - INFO -   ID: 5, Name: Свидетельство о рождении
2025-05-15 01:31:00,433 - main - INFO -   ... and 12 more document types
2025-05-15 01:31:00,433 - src.connectors.postgres_connector - INFO - Disconnected from PostgreSQL
2025-05-15 01:31:00,433 - main - INFO - Testing document type handling...
2025-05-15 01:31:00,447 - src.connectors.postgres_connector - INFO - Connected to PostgreSQL
2025-05-15 01:31:00,448 - main - INFO - Found 17 document types in the documenttypes table
2025-05-15 01:31:00,451 - src.connectors.postgres_connector - ERROR - Error inserting patient: ОШИБКА:  столбец "passport" в таблице "patient_matching_log" не существует
LINE 2:                 hisnumber, source, match_type, passport, cre...
                                                       ^
QUERY:  INSERT INTO patient_matching_log (
                hisnumber, source, match_type, passport, created_uuid
            ) VALUES (
                NEW.hisnumber, NEW.source, 'NEW', NEW.document_number, TRUE
            )
CONTEXT:  функция PL/pgSQL process_new_patient(), строка 95, оператор SQL-оператор

2025-05-15 01:31:00,452 - src.connectors.postgres_connector - ERROR - Error inserting patient: ОШИБКА:  столбец "passport" в таблице "patient_matching_log" не существует
LINE 2:                 hisnumber, source, match_type, passport, cre...
                                                       ^
QUERY:  INSERT INTO patient_matching_log (
                hisnumber, source, match_type, passport, created_uuid
            ) VALUES (
                NEW.hisnumber, NEW.source, 'NEW', NEW.document_number, TRUE
            )
CONTEXT:  функция PL/pgSQL process_new_patient(), строка 95, оператор SQL-оператор

2025-05-15 01:31:00,453 - src.connectors.postgres_connector - ERROR - Error inserting patient: ОШИБКА:  столбец "passport" в таблице "patient_matching_log" не существует
LINE 2:                 hisnumber, source, match_type, passport, cre...
                                                       ^
QUERY:  INSERT INTO patient_matching_log (
                hisnumber, source, match_type, passport, created_uuid
            ) VALUES (
                NEW.hisnumber, NEW.source, 'NEW', NEW.document_number, TRUE
            )
CONTEXT:  функция PL/pgSQL process_new_patient(), строка 95, оператор SQL-оператор

2025-05-15 01:31:00,453 - src.connectors.postgres_connector - ERROR - Error inserting patient: ОШИБКА:  столбец "passport" в таблице "patient_matching_log" не существует
LINE 2:                 hisnumber, source, match_type, passport, cre...
                                                       ^
QUERY:  INSERT INTO patient_matching_log (
                hisnumber, source, match_type, passport, created_uuid
            ) VALUES (
                NEW.hisnumber, NEW.source, 'NEW', NEW.document_number, TRUE
            )
CONTEXT:  функция PL/pgSQL process_new_patient(), строка 95, оператор SQL-оператор

2025-05-15 01:31:00,454 - src.connectors.postgres_connector - ERROR - Error inserting patient: ОШИБКА:  столбец "passport" в таблице "patient_matching_log" не существует
LINE 2:                 hisnumber, source, match_type, passport, cre...
                                                       ^
QUERY:  INSERT INTO patient_matching_log (
                hisnumber, source, match_type, passport, created_uuid
            ) VALUES (
                NEW.hisnumber, NEW.source, 'NEW', NEW.document_number, TRUE
            )
CONTEXT:  функция PL/pgSQL process_new_patient(), строка 95, оператор SQL-оператор

2025-05-15 01:31:00,455 - src.connectors.postgres_connector - ERROR - Error inserting patient: ОШИБКА:  столбец "passport" в таблице "patient_matching_log" не существует
LINE 2:                 hisnumber, source, match_type, passport, cre...
                                                       ^
QUERY:  INSERT INTO patient_matching_log (
                hisnumber, source, match_type, passport, created_uuid
            ) VALUES (
                NEW.hisnumber, NEW.source, 'NEW', NEW.document_number, TRUE
            )
CONTEXT:  функция PL/pgSQL process_new_patient(), строка 95, оператор SQL-оператор

2025-05-15 01:31:00,455 - main - INFO - Successfully inserted 0 out of 6 test patients with different document types
2025-05-15 01:31:00,455 - src.connectors.postgres_connector - INFO - Disconnected from PostgreSQL
2025-05-15 01:31:00,455 - main - INFO - Testing patient insertion...
2025-05-15 01:31:00,469 - src.connectors.postgres_connector - INFO - Connected to PostgreSQL
2025-05-15 01:31:00,469 - main - INFO - Using document type: Свидетельство о рождении (ID: 5) with number: 874226739273
2025-05-15 01:31:00,473 - src.connectors.postgres_connector - ERROR - Error inserting patient: ОШИБКА:  столбец "passport" в таблице "patient_matching_log" не существует
LINE 2:                 hisnumber, source, match_type, passport, cre...
                                                       ^
QUERY:  INSERT INTO patient_matching_log (
                hisnumber, source, match_type, passport, created_uuid
            ) VALUES (
                NEW.hisnumber, NEW.source, 'NEW', NEW.document_number, TRUE
            )
CONTEXT:  функция PL/pgSQL process_new_patient(), строка 95, оператор SQL-оператор

2025-05-15 01:31:00,473 - main - ERROR - Failed to insert sample patient
2025-05-15 01:31:00,473 - src.connectors.postgres_connector - INFO - Disconnected from PostgreSQL
2025-05-15 01:31:00,473 - main - INFO - Testing patient fetch and import from Firebird to PostgreSQL...
2025-05-15 01:31:00,473 - src.connectors.firebird_connector - INFO - Testing TCP connectivity to 192.168.160.168:3050
2025-05-15 01:31:00,486 - src.connectors.firebird_connector - INFO - TCP connection to 192.168.160.168:3050 successful
2025-05-15 01:31:00,487 - src.connectors.firebird_connector - ERROR - Failed to connect to Firebird (Инфоклиника): Server 'infoclinica_server' already registered.
2025-05-15 01:31:00,487 - main - ERROR - Firebird connection failed
2025-05-15 01:31:00,487 - main - INFO - 
Test Results Summary:
2025-05-15 01:31:00,487 - main - INFO - PostgreSQL Connection: ✓
2025-05-15 01:31:00,487 - main - INFO - Firebird Connection: ✓
2025-05-15 01:31:00,487 - main - INFO - YottaDB Connection: ✗
2025-05-15 01:31:00,487 - main - INFO - PostgreSQL Schema: ✓
2025-05-15 01:31:00,487 - main - INFO - Document Type Handling: ✗
2025-05-15 01:31:00,487 - main - INFO - Patient Insertion: ✗
2025-05-15 01:31:00,487 - main - INFO - Firebird Import: ✗
2025-05-15 01:31:00,487 - main - INFO - 
Tests completed.
2025-05-15 01:31:47,319 - main - INFO - Starting tests...
2025-05-15 01:31:47,319 - main - INFO - Testing PostgreSQL connection...
2025-05-15 01:31:47,331 - src.connectors.postgres_connector - INFO - Connected to PostgreSQL
2025-05-15 01:31:47,331 - main - INFO - PostgreSQL connection successful
2025-05-15 01:31:47,332 - main - INFO - PostgreSQL version: PostgreSQL 15.12 (Debian 15.12-0+deb12u2) on x86_64-pc-linux-gnu, compiled by gcc (Debian 12.2.0-14) 12.2.0, 64-bit
2025-05-15 01:31:47,332 - src.connectors.postgres_connector - INFO - Disconnected from PostgreSQL
2025-05-15 01:31:47,332 - main - INFO - Testing Firebird connection...
2025-05-15 01:31:47,332 - main - INFO - Firebird config: {'host': '192.168.160.168:3050', 'database': '099-1', 'user': 'SYSDBA', 'password': 'masterkey', 'charset': 'UTF-8', 'debug': False}
2025-05-15 01:31:47,332 - src.connectors.firebird_connector - INFO - Testing TCP connectivity to 192.168.160.168:3050
2025-05-15 01:31:47,346 - src.connectors.firebird_connector - INFO - TCP connection to 192.168.160.168:3050 successful
2025-05-15 01:31:47,346 - src.connectors.firebird_connector - INFO - Attempting to connect to Firebird at 192.168.160.168:3050, database: 099-1
2025-05-15 01:31:47,499 - src.connectors.firebird_connector - INFO - Connected to Firebird (Инфоклиника) using firebird-driver
2025-05-15 01:31:47,499 - main - INFO - Firebird connection successful
2025-05-15 01:31:47,544 - main - INFO - Firebird current time: 2025-05-15 01:31:47.525000
2025-05-15 01:31:47,563 - src.connectors.firebird_connector - ERROR - Error fetching patients from Firebird (Инфоклиника): Dynamic SQL Error
-SQL error code = -204
-Table unknown
-PATIENTS
-At line 13, column 22
2025-05-15 01:31:47,563 - main - INFO - Retrieved 0 patients from Firebird (Инфоклиника)
2025-05-15 01:31:47,600 - src.connectors.firebird_connector - INFO - Disconnected from Firebird (Инфоклиника)
2025-05-15 01:31:47,600 - main - INFO - Testing YottaDB connection...
2025-05-15 01:31:47,600 - main - ERROR - YottaDB connection failed
2025-05-15 01:31:47,600 - main - INFO - Testing PostgreSQL schema...
2025-05-15 01:31:47,618 - src.connectors.postgres_connector - INFO - Connected to PostgreSQL
2025-05-15 01:31:47,624 - main - INFO - All essential tables exist
2025-05-15 01:31:47,625 - main - INFO - Found 2 HIS entries:
2025-05-15 01:31:47,625 - main - INFO -   ID: 1, Name: qMS
2025-05-15 01:31:47,625 - main - INFO -   ID: 2, Name: Инфоклиника
2025-05-15 01:31:47,625 - main - INFO - Found 3 business units:
2025-05-15 01:31:47,626 - main - INFO -   ID: 1, Name: ОО ФК "Хадасса Медикал ЛТД"
2025-05-15 01:31:47,626 - main - INFO -   ID: 2, Name: ООО "Медскан"
2025-05-15 01:31:47,626 - main - INFO -   ID: 3, Name: ООО "Клинический госпиталь на Яузе"
2025-05-15 01:31:47,626 - main - INFO - Found 17 document types:
2025-05-15 01:31:47,626 - main - INFO -   ID: 1, Name: Паспорт
2025-05-15 01:31:47,626 - main - INFO -   ID: 2, Name: Паспорт СССР
2025-05-15 01:31:47,626 - main - INFO -   ID: 3, Name: Заграничный паспорт РФ
2025-05-15 01:31:47,626 - main - INFO -   ID: 4, Name: Заграничный паспорт СССР
2025-05-15 01:31:47,626 - main - INFO -   ID: 5, Name: Свидетельство о рождении
2025-05-15 01:31:47,626 - main - INFO -   ... and 12 more document types
2025-05-15 01:31:47,627 - src.connectors.postgres_connector - INFO - Disconnected from PostgreSQL
2025-05-15 01:31:47,627 - main - INFO - Testing document type handling...
2025-05-15 01:31:47,641 - src.connectors.postgres_connector - INFO - Connected to PostgreSQL
2025-05-15 01:31:47,643 - main - INFO - Found 17 document types in the documenttypes table
2025-05-15 01:31:47,646 - src.connectors.postgres_connector - ERROR - Error inserting patient: ОШИБКА:  столбец "passport" в таблице "patient_matching_log" не существует
LINE 2:                 hisnumber, source, match_type, passport, cre...
                                                       ^
QUERY:  INSERT INTO patient_matching_log (
                hisnumber, source, match_type, passport, created_uuid
            ) VALUES (
                NEW.hisnumber, NEW.source, 'NEW', NEW.document_number, TRUE
            )
CONTEXT:  функция PL/pgSQL process_new_patient(), строка 95, оператор SQL-оператор

2025-05-15 01:31:47,647 - src.connectors.postgres_connector - ERROR - Error inserting patient: ОШИБКА:  столбец "passport" в таблице "patient_matching_log" не существует
LINE 2:                 hisnumber, source, match_type, passport, cre...
                                                       ^
QUERY:  INSERT INTO patient_matching_log (
                hisnumber, source, match_type, passport, created_uuid
            ) VALUES (
                NEW.hisnumber, NEW.source, 'NEW', NEW.document_number, TRUE
            )
CONTEXT:  функция PL/pgSQL process_new_patient(), строка 95, оператор SQL-оператор

2025-05-15 01:31:47,647 - src.connectors.postgres_connector - ERROR - Error inserting patient: ОШИБКА:  столбец "passport" в таблице "patient_matching_log" не существует
LINE 2:                 hisnumber, source, match_type, passport, cre...
                                                       ^
QUERY:  INSERT INTO patient_matching_log (
                hisnumber, source, match_type, passport, created_uuid
            ) VALUES (
                NEW.hisnumber, NEW.source, 'NEW', NEW.document_number, TRUE
            )
CONTEXT:  функция PL/pgSQL process_new_patient(), строка 95, оператор SQL-оператор

2025-05-15 01:31:47,648 - src.connectors.postgres_connector - ERROR - Error inserting patient: ОШИБКА:  столбец "passport" в таблице "patient_matching_log" не существует
LINE 2:                 hisnumber, source, match_type, passport, cre...
                                                       ^
QUERY:  INSERT INTO patient_matching_log (
                hisnumber, source, match_type, passport, created_uuid
            ) VALUES (
                NEW.hisnumber, NEW.source, 'NEW', NEW.document_number, TRUE
            )
CONTEXT:  функция PL/pgSQL process_new_patient(), строка 95, оператор SQL-оператор

2025-05-15 01:31:47,649 - src.connectors.postgres_connector - ERROR - Error inserting patient: ОШИБКА:  столбец "passport" в таблице "patient_matching_log" не существует
LINE 2:                 hisnumber, source, match_type, passport, cre...
                                                       ^
QUERY:  INSERT INTO patient_matching_log (
                hisnumber, source, match_type, passport, created_uuid
            ) VALUES (
                NEW.hisnumber, NEW.source, 'NEW', NEW.document_number, TRUE
            )
CONTEXT:  функция PL/pgSQL process_new_patient(), строка 95, оператор SQL-оператор

2025-05-15 01:31:47,650 - src.connectors.postgres_connector - ERROR - Error inserting patient: ОШИБКА:  столбец "passport" в таблице "patient_matching_log" не существует
LINE 2:                 hisnumber, source, match_type, passport, cre...
                                                       ^
QUERY:  INSERT INTO patient_matching_log (
                hisnumber, source, match_type, passport, created_uuid
            ) VALUES (
                NEW.hisnumber, NEW.source, 'NEW', NEW.document_number, TRUE
            )
CONTEXT:  функция PL/pgSQL process_new_patient(), строка 95, оператор SQL-оператор

2025-05-15 01:31:47,650 - main - INFO - Successfully inserted 0 out of 6 test patients with different document types
2025-05-15 01:31:47,650 - src.connectors.postgres_connector - INFO - Disconnected from PostgreSQL
2025-05-15 01:31:47,650 - main - INFO - Testing patient insertion...
2025-05-15 01:31:47,666 - src.connectors.postgres_connector - INFO - Connected to PostgreSQL
2025-05-15 01:31:47,666 - main - INFO - Using document type: Заграничный паспорт РФ (ID: 3) with number: 541300958
2025-05-15 01:31:47,672 - src.connectors.postgres_connector - ERROR - Error inserting patient: ОШИБКА:  столбец "passport" в таблице "patient_matching_log" не существует
LINE 2:                 hisnumber, source, match_type, passport, cre...
                                                       ^
QUERY:  INSERT INTO patient_matching_log (
                hisnumber, source, match_type, passport, created_uuid
            ) VALUES (
                NEW.hisnumber, NEW.source, 'NEW', NEW.document_number, TRUE
            )
CONTEXT:  функция PL/pgSQL process_new_patient(), строка 95, оператор SQL-оператор

2025-05-15 01:31:47,674 - main - ERROR - Failed to insert sample patient
2025-05-15 01:31:47,674 - src.connectors.postgres_connector - INFO - Disconnected from PostgreSQL
2025-05-15 01:31:47,675 - main - INFO - Testing patient fetch and import from Firebird to PostgreSQL...
2025-05-15 01:31:47,675 - src.connectors.firebird_connector - INFO - Testing TCP connectivity to 192.168.160.168:3050
2025-05-15 01:31:47,703 - src.connectors.firebird_connector - INFO - TCP connection to 192.168.160.168:3050 successful
2025-05-15 01:31:47,703 - src.connectors.firebird_connector - ERROR - Failed to connect to Firebird (Инфоклиника): Server 'infoclinica_server' already registered.
2025-05-15 01:31:47,703 - main - ERROR - Firebird connection failed
2025-05-15 01:31:47,703 - main - INFO - 
Test Results Summary:
2025-05-15 01:31:47,704 - main - INFO - PostgreSQL Connection: ✓
2025-05-15 01:31:47,704 - main - INFO - Firebird Connection: ✓
2025-05-15 01:31:47,704 - main - INFO - YottaDB Connection: ✗
2025-05-15 01:31:47,704 - main - INFO - PostgreSQL Schema: ✓
2025-05-15 01:31:47,704 - main - INFO - Document Type Handling: ✗
2025-05-15 01:31:47,704 - main - INFO - Patient Insertion: ✗
2025-05-15 01:31:47,704 - main - INFO - Firebird Import: ✗
2025-05-15 01:31:47,704 - main - INFO - 
Tests completed.
2025-05-15 01:33:07,584 - main - INFO - Starting tests...
2025-05-15 01:33:07,584 - main - INFO - Testing PostgreSQL connection...
2025-05-15 01:33:07,596 - src.connectors.postgres_connector - INFO - Connected to PostgreSQL
2025-05-15 01:33:07,597 - main - INFO - PostgreSQL connection successful
2025-05-15 01:33:07,597 - main - INFO - PostgreSQL version: PostgreSQL 15.12 (Debian 15.12-0+deb12u2) on x86_64-pc-linux-gnu, compiled by gcc (Debian 12.2.0-14) 12.2.0, 64-bit
2025-05-15 01:33:07,598 - src.connectors.postgres_connector - INFO - Disconnected from PostgreSQL
2025-05-15 01:33:07,598 - main - INFO - Testing Firebird connection...
2025-05-15 01:33:07,598 - main - INFO - Firebird config: {'host': '192.168.160.168:3050', 'database': '099-1', 'user': 'SYSDBA', 'password': 'masterkey', 'charset': 'UTF-8', 'debug': False}
2025-05-15 01:33:07,598 - src.connectors.firebird_connector - INFO - Testing TCP connectivity to 192.168.160.168:3050
2025-05-15 01:33:07,665 - src.connectors.firebird_connector - INFO - TCP connection to 192.168.160.168:3050 successful
2025-05-15 01:33:07,666 - src.connectors.firebird_connector - INFO - Attempting to connect to Firebird at 192.168.160.168:3050, database: 099-1
2025-05-15 01:33:07,784 - src.connectors.firebird_connector - INFO - Connected to Firebird (Инфоклиника) using firebird-driver
2025-05-15 01:33:07,785 - main - INFO - Firebird connection successful
2025-05-15 01:33:07,830 - main - INFO - Firebird current time: 2025-05-15 01:33:07.807000
2025-05-15 01:33:07,850 - src.connectors.firebird_connector - ERROR - Error fetching patients from Firebird (Инфоклиника): Dynamic SQL Error
-SQL error code = -204
-Table unknown
-PATIENTS
-At line 13, column 22
2025-05-15 01:33:07,850 - main - INFO - Retrieved 0 patients from Firebird (Инфоклиника)
2025-05-15 01:33:07,882 - src.connectors.firebird_connector - INFO - Disconnected from Firebird (Инфоклиника)
2025-05-15 01:33:07,882 - main - INFO - Testing YottaDB connection...
2025-05-15 01:33:07,882 - main - ERROR - YottaDB connection failed
2025-05-15 01:33:07,882 - main - INFO - Testing PostgreSQL schema...
2025-05-15 01:33:07,902 - src.connectors.postgres_connector - INFO - Connected to PostgreSQL
2025-05-15 01:33:07,908 - main - INFO - All essential tables exist
2025-05-15 01:33:07,909 - main - INFO - Found 2 HIS entries:
2025-05-15 01:33:07,909 - main - INFO -   ID: 1, Name: qMS
2025-05-15 01:33:07,909 - main - INFO -   ID: 2, Name: Инфоклиника
2025-05-15 01:33:07,909 - main - INFO - Found 3 business units:
2025-05-15 01:33:07,910 - main - INFO -   ID: 1, Name: ОО ФК "Хадасса Медикал ЛТД"
2025-05-15 01:33:07,910 - main - INFO -   ID: 2, Name: ООО "Медскан"
2025-05-15 01:33:07,910 - main - INFO -   ID: 3, Name: ООО "Клинический госпиталь на Яузе"
2025-05-15 01:33:07,910 - main - INFO - Found 17 document types:
2025-05-15 01:33:07,910 - main - INFO -   ID: 1, Name: Паспорт
2025-05-15 01:33:07,910 - main - INFO -   ID: 2, Name: Паспорт СССР
2025-05-15 01:33:07,910 - main - INFO -   ID: 3, Name: Заграничный паспорт РФ
2025-05-15 01:33:07,910 - main - INFO -   ID: 4, Name: Заграничный паспорт СССР
2025-05-15 01:33:07,910 - main - INFO -   ID: 5, Name: Свидетельство о рождении
2025-05-15 01:33:07,910 - main - INFO -   ... and 12 more document types
2025-05-15 01:33:07,911 - src.connectors.postgres_connector - INFO - Disconnected from PostgreSQL
2025-05-15 01:33:07,911 - main - INFO - Testing document type handling...
2025-05-15 01:33:07,927 - src.connectors.postgres_connector - INFO - Connected to PostgreSQL
2025-05-15 01:33:07,928 - main - INFO - Found 17 document types in the documenttypes table
2025-05-15 01:33:07,935 - src.connectors.postgres_connector - INFO - Patient inserted with ID: 100022
2025-05-15 01:33:07,935 - main - INFO - Inserted patient with Паспорт (ID: 1), number: 6522754580
2025-05-15 01:33:07,937 - src.connectors.postgres_connector - INFO - Patient inserted with ID: 100023
2025-05-15 01:33:07,937 - main - INFO - Inserted patient with Заграничный паспорт РФ (ID: 3), number: 400888892
2025-05-15 01:33:07,938 - src.connectors.postgres_connector - INFO - Patient inserted with ID: 100024
2025-05-15 01:33:07,938 - main - INFO - Inserted patient with Свидетельство о рождении (ID: 5), number: 779911425743
2025-05-15 01:33:07,940 - src.connectors.postgres_connector - INFO - Patient inserted with ID: 100025
2025-05-15 01:33:07,940 - main - INFO - Inserted patient with Иностранный паспорт (ID: 10), number: 198070887
2025-05-15 01:33:07,942 - src.connectors.postgres_connector - INFO - Patient inserted with ID: 100026
2025-05-15 01:33:07,942 - main - INFO - Inserted patient with Временное удостоверение (ID: 14), number: 76837433
2025-05-15 01:33:07,944 - src.connectors.postgres_connector - INFO - Patient inserted with ID: 100027
2025-05-15 01:33:07,944 - main - INFO - Inserted patient with Иные документы (ID: 17), number: 15692226
2025-05-15 01:33:07,944 - main - INFO - Successfully inserted 6 out of 6 test patients with different document types
2025-05-15 01:33:07,944 - main - INFO - Successfully found patient by document type and number: UUID=f1dc039b-7ed4-467e-ad40-bac072a0fa2f
2025-05-15 01:33:07,945 - src.connectors.postgres_connector - INFO - Disconnected from PostgreSQL
2025-05-15 01:33:07,945 - main - INFO - Testing patient insertion...
2025-05-15 01:33:07,955 - src.connectors.postgres_connector - INFO - Connected to PostgreSQL
2025-05-15 01:33:07,955 - main - INFO - Using document type: Временное удостоверение (ID: 14) with number: 69542712
2025-05-15 01:33:07,960 - src.connectors.postgres_connector - INFO - Patient inserted with ID: 100028
2025-05-15 01:33:07,960 - main - INFO - Sample patient inserted successfully
2025-05-15 01:33:07,961 - main - INFO - Verified patient in database: ID=100028, UUID=67953311-49bb-43eb-b26a-17f55ff5c427, Document=Временное удостоверение #69542712
2025-05-15 01:33:07,961 - src.connectors.postgres_connector - INFO - Disconnected from PostgreSQL
2025-05-15 01:33:07,961 - main - INFO - Testing patient fetch and import from Firebird to PostgreSQL...
2025-05-15 01:33:07,962 - src.connectors.firebird_connector - INFO - Testing TCP connectivity to 192.168.160.168:3050
2025-05-15 01:33:07,976 - src.connectors.firebird_connector - INFO - TCP connection to 192.168.160.168:3050 successful
2025-05-15 01:33:07,977 - src.connectors.firebird_connector - ERROR - Failed to connect to Firebird (Инфоклиника): Server 'infoclinica_server' already registered.
2025-05-15 01:33:07,977 - main - ERROR - Firebird connection failed
2025-05-15 01:33:07,977 - main - INFO - 
Test Results Summary:
2025-05-15 01:33:07,977 - main - INFO - PostgreSQL Connection: ✓
2025-05-15 01:33:07,977 - main - INFO - Firebird Connection: ✓
2025-05-15 01:33:07,977 - main - INFO - YottaDB Connection: ✗
2025-05-15 01:33:07,977 - main - INFO - PostgreSQL Schema: ✓
2025-05-15 01:33:07,977 - main - INFO - Document Type Handling: ✓
2025-05-15 01:33:07,977 - main - INFO - Patient Insertion: ✓
2025-05-15 01:33:07,977 - main - INFO - Firebird Import: ✗
2025-05-15 01:33:07,977 - main - INFO - 
Tests completed.
2025-05-15 01:35:31,476 - main - INFO - Starting tests...
2025-05-15 01:35:31,476 - main - INFO - Testing PostgreSQL connection...
2025-05-15 01:35:31,489 - src.connectors.postgres_connector - INFO - Connected to PostgreSQL
2025-05-15 01:35:31,490 - main - INFO - PostgreSQL connection successful
2025-05-15 01:35:31,490 - main - INFO - PostgreSQL version: PostgreSQL 15.12 (Debian 15.12-0+deb12u2) on x86_64-pc-linux-gnu, compiled by gcc (Debian 12.2.0-14) 12.2.0, 64-bit
2025-05-15 01:35:31,491 - src.connectors.postgres_connector - INFO - Disconnected from PostgreSQL
2025-05-15 01:35:31,491 - main - INFO - Testing Firebird connection...
2025-05-15 01:35:31,491 - main - INFO - Firebird config: {'host': '192.168.160.168:3050', 'database': '099-1', 'user': 'SYSDBA', 'password': 'masterkey', 'charset': 'UTF-8', 'debug': False}
2025-05-15 01:35:31,491 - src.connectors.firebird_connector - INFO - Testing TCP connectivity to 192.168.160.168:3050
2025-05-15 01:35:31,506 - src.connectors.firebird_connector - INFO - TCP connection to 192.168.160.168:3050 successful
2025-05-15 01:35:31,507 - src.connectors.firebird_connector - INFO - Attempting to connect to Firebird at 192.168.160.168:3050, database: 099-1
2025-05-15 01:35:31,670 - src.connectors.firebird_connector - INFO - Connected to Firebird (Инфоклиника) using firebird-driver
2025-05-15 01:35:31,670 - main - INFO - Firebird connection successful
2025-05-15 01:35:31,715 - main - INFO - Firebird current time: 2025-05-15 01:35:31.697000
2025-05-15 01:35:31,737 - src.connectors.firebird_connector - ERROR - Error fetching patients from Firebird (Инфоклиника): Dynamic SQL Error
-SQL error code = -204
-Table unknown
-PATIENTS
-At line 13, column 22
2025-05-15 01:35:31,737 - main - INFO - Retrieved 0 patients from Firebird (Инфоклиника)
2025-05-15 01:35:31,777 - src.connectors.firebird_connector - INFO - Disconnected from Firebird (Инфоклиника)
2025-05-15 01:35:31,777 - main - INFO - Testing YottaDB connection...
2025-05-15 01:35:31,777 - main - ERROR - YottaDB connection failed
2025-05-15 01:35:31,777 - main - INFO - Testing PostgreSQL schema...
2025-05-15 01:35:31,795 - src.connectors.postgres_connector - INFO - Connected to PostgreSQL
2025-05-15 01:35:31,799 - main - INFO - All essential tables exist
2025-05-15 01:35:31,800 - main - INFO - Found 2 HIS entries:
2025-05-15 01:35:31,800 - main - INFO -   ID: 1, Name: qMS
2025-05-15 01:35:31,800 - main - INFO -   ID: 2, Name: Инфоклиника
2025-05-15 01:35:31,800 - main - INFO - Found 3 business units:
2025-05-15 01:35:31,800 - main - INFO -   ID: 1, Name: ОО ФК "Хадасса Медикал ЛТД"
2025-05-15 01:35:31,800 - main - INFO -   ID: 2, Name: ООО "Медскан"
2025-05-15 01:35:31,800 - main - INFO -   ID: 3, Name: ООО "Клинический госпиталь на Яузе"
2025-05-15 01:35:31,801 - main - INFO - Found 17 document types:
2025-05-15 01:35:31,801 - main - INFO -   ID: 1, Name: Паспорт
2025-05-15 01:35:31,801 - main - INFO -   ID: 2, Name: Паспорт СССР
2025-05-15 01:35:31,801 - main - INFO -   ID: 3, Name: Заграничный паспорт РФ
2025-05-15 01:35:31,801 - main - INFO -   ID: 4, Name: Заграничный паспорт СССР
2025-05-15 01:35:31,801 - main - INFO -   ID: 5, Name: Свидетельство о рождении
2025-05-15 01:35:31,801 - main - INFO -   ... and 12 more document types
2025-05-15 01:35:31,801 - src.connectors.postgres_connector - INFO - Disconnected from PostgreSQL
2025-05-15 01:35:31,801 - main - INFO - Testing document type handling...
2025-05-15 01:35:31,814 - src.connectors.postgres_connector - INFO - Connected to PostgreSQL
2025-05-15 01:35:31,815 - main - INFO - Found 17 document types in the documenttypes table
2025-05-15 01:35:31,823 - src.connectors.postgres_connector - INFO - Patient inserted with ID: 200029
2025-05-15 01:35:31,824 - main - INFO - Inserted patient with Паспорт (ID: 1), number: 5666898542
2025-05-15 01:35:31,825 - src.connectors.postgres_connector - INFO - Patient inserted with ID: 200030
2025-05-15 01:35:31,825 - main - INFO - Inserted patient with Заграничный паспорт РФ (ID: 3), number: 245808290
2025-05-15 01:35:31,827 - src.connectors.postgres_connector - INFO - Patient inserted with ID: 200031
2025-05-15 01:35:31,827 - main - INFO - Inserted patient with Свидетельство о рождении (ID: 5), number: 967135740634
2025-05-15 01:35:31,828 - src.connectors.postgres_connector - INFO - Patient inserted with ID: 200032
2025-05-15 01:35:31,829 - main - INFO - Inserted patient with Иностранный паспорт (ID: 10), number: 517357885
2025-05-15 01:35:31,830 - src.connectors.postgres_connector - INFO - Patient inserted with ID: 200033
2025-05-15 01:35:31,830 - main - INFO - Inserted patient with Временное удостоверение (ID: 14), number: 45163054
2025-05-15 01:35:31,832 - src.connectors.postgres_connector - INFO - Patient inserted with ID: 200034
2025-05-15 01:35:31,832 - main - INFO - Inserted patient with Иные документы (ID: 17), number: 59404462
2025-05-15 01:35:31,832 - main - INFO - Successfully inserted 6 out of 6 test patients with different document types
2025-05-15 01:35:31,832 - main - INFO - Successfully found patient by document type and number: UUID=99e657f6-59e5-4c86-bf91-c003598ee2b6
2025-05-15 01:35:31,833 - src.connectors.postgres_connector - INFO - Disconnected from PostgreSQL
2025-05-15 01:35:31,833 - main - INFO - Testing patient insertion...
2025-05-15 01:35:31,843 - src.connectors.postgres_connector - INFO - Connected to PostgreSQL
2025-05-15 01:35:31,844 - main - INFO - Using document type: Паспорт (ID: 1) with number: 5998828435
2025-05-15 01:35:31,848 - src.connectors.postgres_connector - INFO - Patient inserted with ID: 200035
2025-05-15 01:35:31,848 - main - INFO - Sample patient inserted successfully
2025-05-15 01:35:31,849 - main - INFO - Verified patient in database: ID=200035, UUID=1dacbf5f-265f-450f-a39f-063f01ac85f5, Document=Паспорт #5998828435
2025-05-15 01:35:31,849 - src.connectors.postgres_connector - INFO - Disconnected from PostgreSQL
2025-05-15 01:35:31,850 - main - INFO - Testing patient fetch and import from Firebird to PostgreSQL...
2025-05-15 01:35:31,850 - src.connectors.firebird_connector - INFO - Testing TCP connectivity to 192.168.160.168:3050
2025-05-15 01:35:31,863 - src.connectors.firebird_connector - INFO - TCP connection to 192.168.160.168:3050 successful
2025-05-15 01:35:31,863 - src.connectors.firebird_connector - ERROR - Failed to connect to Firebird (Инфоклиника): Server 'infoclinica_server' already registered.
2025-05-15 01:35:31,863 - main - ERROR - Firebird connection failed
2025-05-15 01:35:31,863 - main - INFO - 
Test Results Summary:
2025-05-15 01:35:31,863 - main - INFO - PostgreSQL Connection: ✓
2025-05-15 01:35:31,863 - main - INFO - Firebird Connection: ✓
2025-05-15 01:35:31,863 - main - INFO - YottaDB Connection: ✗
2025-05-15 01:35:31,863 - main - INFO - PostgreSQL Schema: ✓
2025-05-15 01:35:31,863 - main - INFO - Document Type Handling: ✓
2025-05-15 01:35:31,864 - main - INFO - Patient Insertion: ✓
2025-05-15 01:35:31,864 - main - INFO - Firebird Import: ✗
2025-05-15 01:35:31,864 - main - INFO - 
Tests completed.
2025-05-16 10:49:18,702 - main - INFO - Starting tests...
2025-05-16 10:49:18,702 - main - INFO - Testing PostgreSQL connection...
2025-05-16 10:49:18,726 - src.connectors.postgres_connector - INFO - Connected to PostgreSQL
2025-05-16 10:49:18,726 - main - INFO - PostgreSQL connection successful
2025-05-16 10:49:18,736 - main - INFO - PostgreSQL version: PostgreSQL 15.12 (Debian 15.12-0+deb12u2) on x86_64-pc-linux-gnu, compiled by gcc (Debian 12.2.0-14) 12.2.0, 64-bit
2025-05-16 10:49:18,736 - src.connectors.postgres_connector - INFO - Disconnected from PostgreSQL
2025-05-16 10:49:18,737 - main - INFO - Testing Firebird connection...
2025-05-16 10:49:18,737 - main - INFO - Firebird config: {'host': '192.168.160.168:3050', 'database': '099-1', 'user': 'SYSDBA', 'password': 'masterkey', 'charset': 'UTF-8', 'debug': False}
2025-05-16 10:49:18,737 - src.connectors.firebird_connector - INFO - Testing TCP connectivity to 192.168.160.168:3050
2025-05-16 10:49:18,738 - src.connectors.firebird_connector - INFO - TCP connection to 192.168.160.168:3050 successful
2025-05-16 10:49:18,740 - src.connectors.firebird_connector - INFO - Attempting to connect to Firebird at 192.168.160.168:3050, database: 099-1
2025-05-16 10:49:18,816 - src.connectors.firebird_connector - INFO - Connected to Firebird (Инфоклиника) using firebird-driver
2025-05-16 10:49:18,816 - main - INFO - Firebird connection successful
2025-05-16 10:49:18,825 - main - INFO - Firebird current time: 2025-05-16 10:49:18.785000
2025-05-16 10:49:52,327 - src.connectors.firebird_connector - INFO - Fetched 684294 patients from Firebird (Инфоклиника)
2025-05-16 10:49:52,477 - main - INFO - Retrieved 684294 patients from Firebird (Инфоклиника)
2025-05-16 10:49:52,477 - main - INFO - Patient 1: Проверочный Иван
2025-05-16 10:49:52,478 - main - INFO - Patient 2: Петровский Василий
2025-05-16 10:49:52,478 - main - INFO - Patient 3: Смирнова Елена
2025-05-16 10:49:52,483 - src.connectors.firebird_connector - INFO - Disconnected from Firebird (Инфоклиника)
2025-05-16 10:49:52,738 - main - INFO - Testing YottaDB connection...
2025-05-16 10:49:52,738 - main - ERROR - YottaDB connection failed
2025-05-16 10:49:52,738 - main - INFO - Testing PostgreSQL schema...
2025-05-16 10:49:52,755 - src.connectors.postgres_connector - INFO - Connected to PostgreSQL
2025-05-16 10:49:52,781 - main - INFO - All essential tables exist
2025-05-16 10:49:52,784 - main - INFO - Found 2 HIS entries:
2025-05-16 10:49:52,784 - main - INFO -   ID: 1, Name: qMS
2025-05-16 10:49:52,784 - main - INFO -   ID: 2, Name: Инфоклиника
2025-05-16 10:49:52,785 - main - INFO - Found 3 business units:
2025-05-16 10:49:52,785 - main - INFO -   ID: 1, Name: ОО ФК "Хадасса Медикал ЛТД"
2025-05-16 10:49:52,785 - main - INFO -   ID: 2, Name: ООО "Медскан"
2025-05-16 10:49:52,785 - main - INFO -   ID: 3, Name: ООО "Клинический госпиталь на Яузе"
2025-05-16 10:49:52,786 - main - INFO - Found 17 document types:
2025-05-16 10:49:52,787 - main - INFO -   ID: 1, Name: Паспорт
2025-05-16 10:49:52,787 - main - INFO -   ID: 2, Name: Паспорт СССР
2025-05-16 10:49:52,787 - main - INFO -   ID: 3, Name: Заграничный паспорт РФ
2025-05-16 10:49:52,787 - main - INFO -   ID: 4, Name: Заграничный паспорт СССР
2025-05-16 10:49:52,787 - main - INFO -   ID: 5, Name: Свидетельство о рождении
2025-05-16 10:49:52,787 - main - INFO -   ... and 12 more document types
2025-05-16 10:49:52,787 - src.connectors.postgres_connector - INFO - Disconnected from PostgreSQL
2025-05-16 10:49:52,788 - main - INFO - Testing document type handling...
2025-05-16 10:49:52,811 - src.connectors.postgres_connector - INFO - Connected to PostgreSQL
2025-05-16 10:49:52,815 - main - INFO - Found 17 document types in the documenttypes table
2025-05-16 10:49:52,851 - src.connectors.postgres_connector - INFO - Patient inserted with ID: 1200036
2025-05-16 10:49:52,852 - main - INFO - Inserted patient with Паспорт (ID: 1), number: 3979400118
2025-05-16 10:49:52,856 - src.connectors.postgres_connector - INFO - Patient inserted with ID: 1200037
2025-05-16 10:49:52,856 - main - INFO - Inserted patient with Заграничный паспорт РФ (ID: 3), number: 863623189
2025-05-16 10:49:52,861 - src.connectors.postgres_connector - INFO - Patient inserted with ID: 1200038
2025-05-16 10:49:52,861 - main - INFO - Inserted patient with Свидетельство о рождении (ID: 5), number: 268203369566
2025-05-16 10:49:52,867 - src.connectors.postgres_connector - INFO - Patient inserted with ID: 1200039
2025-05-16 10:49:52,867 - main - INFO - Inserted patient with Иностранный паспорт (ID: 10), number: 928107549
2025-05-16 10:49:52,873 - src.connectors.postgres_connector - INFO - Patient inserted with ID: 1200040
2025-05-16 10:49:52,873 - main - INFO - Inserted patient with Временное удостоверение (ID: 14), number: 58130608
2025-05-16 10:49:52,879 - src.connectors.postgres_connector - INFO - Patient inserted with ID: 1200041
2025-05-16 10:49:52,880 - main - INFO - Inserted patient with Иные документы (ID: 17), number: 81484597
2025-05-16 10:49:52,880 - main - INFO - Successfully inserted 6 out of 6 test patients with different document types
2025-05-16 10:49:52,881 - main - INFO - Successfully found patient by document type and number: UUID=b35c2bea-e2b0-47b0-a86a-386e883cb168
2025-05-16 10:49:52,882 - src.connectors.postgres_connector - INFO - Disconnected from PostgreSQL
2025-05-16 10:49:52,882 - main - INFO - Testing patient insertion...
2025-05-16 10:49:52,904 - src.connectors.postgres_connector - INFO - Connected to PostgreSQL
2025-05-16 10:49:52,905 - main - INFO - Using document type: Паспорт (ID: 1) with number: 7620814978
2025-05-16 10:49:52,920 - src.connectors.postgres_connector - INFO - Patient inserted with ID: 1200042
2025-05-16 10:49:52,921 - main - INFO - Sample patient inserted successfully
2025-05-16 10:49:52,928 - main - INFO - Verified patient in database: ID=1200042, UUID=2254c6a3-f081-45c6-8f58-1a05f5b4bf97, Document=Паспорт #7620814978
2025-05-16 10:49:52,929 - src.connectors.postgres_connector - INFO - Disconnected from PostgreSQL
2025-05-16 10:49:52,929 - main - INFO - Testing patient fetch and import from Firebird to PostgreSQL...
2025-05-16 10:49:52,929 - src.connectors.firebird_connector - INFO - Testing TCP connectivity to 192.168.160.168:3050
2025-05-16 10:49:52,930 - src.connectors.firebird_connector - INFO - TCP connection to 192.168.160.168:3050 successful
2025-05-16 10:49:52,931 - src.connectors.firebird_connector - ERROR - Failed to connect to Firebird (Инфоклиника): Server 'infoclinica_server' already registered.
2025-05-16 10:49:52,931 - main - ERROR - Firebird connection failed
2025-05-16 10:49:52,931 - main - INFO - 
Test Results Summary:
2025-05-16 10:49:52,931 - main - INFO - PostgreSQL Connection: ✓
2025-05-16 10:49:52,931 - main - INFO - Firebird Connection: ✓
2025-05-16 10:49:52,931 - main - INFO - YottaDB Connection: ✗
2025-05-16 10:49:52,931 - main - INFO - PostgreSQL Schema: ✓
2025-05-16 10:49:52,931 - main - INFO - Document Type Handling: ✓
2025-05-16 10:49:52,931 - main - INFO - Patient Insertion: ✓
2025-05-16 10:49:52,931 - main - INFO - Firebird Import: ✗
2025-05-16 10:49:52,931 - main - INFO - 
Tests completed.
2025-05-16 13:27:18,726 - main - INFO - Starting tests...
2025-05-16 13:27:18,726 - main - INFO - Testing PostgreSQL connection...
2025-05-16 13:27:18,740 - src.connectors.postgres_connector - INFO - Connected to PostgreSQL
2025-05-16 13:27:18,740 - main - INFO - PostgreSQL connection successful
2025-05-16 13:27:18,741 - main - INFO - PostgreSQL version: PostgreSQL 15.12 (Debian 15.12-0+deb12u2) on x86_64-pc-linux-gnu, compiled by gcc (Debian 12.2.0-14) 12.2.0, 64-bit
2025-05-16 13:27:18,741 - src.connectors.postgres_connector - INFO - Disconnected from PostgreSQL
2025-05-16 13:27:18,741 - main - INFO - Testing Firebird connection...
2025-05-16 13:27:18,741 - main - INFO - Firebird config: {'host': '192.168.160.168:3050', 'database': '099-1', 'user': 'SYSDBA', 'password': 'masterkey', 'charset': 'UTF-8', 'debug': False}
2025-05-16 13:27:18,742 - src.connectors.firebird_connector - INFO - Testing TCP connectivity to 192.168.160.168:3050
2025-05-16 13:27:18,743 - src.connectors.firebird_connector - INFO - TCP connection to 192.168.160.168:3050 successful
2025-05-16 13:27:18,744 - src.connectors.firebird_connector - INFO - Attempting to connect to Firebird at 192.168.160.168:3050, database: 099-1
2025-05-16 13:27:18,801 - src.connectors.firebird_connector - INFO - Connected to Firebird (Инфоклиника) using firebird-driver
2025-05-16 13:27:18,801 - main - INFO - Firebird connection successful
2025-05-16 13:27:18,808 - main - INFO - Firebird current time: 2025-05-16 13:27:18.786000
2025-05-16 13:27:39,378 - src.connectors.firebird_connector - INFO - Fetched 684294 patients from Firebird (Инфоклиника)
2025-05-16 13:27:39,444 - main - INFO - Retrieved 684294 patients from Firebird (Инфоклиника)
2025-05-16 13:27:39,445 - main - INFO - Patient 1: Проверочный Иван
2025-05-16 13:27:39,445 - main - INFO - Patient 2: Петровский Василий
2025-05-16 13:27:39,445 - main - INFO - Patient 3: Смирнова Елена
2025-05-16 13:27:39,451 - src.connectors.firebird_connector - INFO - Disconnected from Firebird (Инфоклиника)
2025-05-16 13:27:39,627 - main - INFO - Testing YottaDB connection...
2025-05-16 13:27:39,627 - main - ERROR - YottaDB connection failed
2025-05-16 13:27:39,627 - main - INFO - Testing PostgreSQL schema...
2025-05-16 13:27:39,639 - src.connectors.postgres_connector - INFO - Connected to PostgreSQL
2025-05-16 13:27:39,644 - main - INFO - All essential tables exist
2025-05-16 13:27:39,645 - main - INFO - Found 2 HIS entries:
2025-05-16 13:27:39,645 - main - INFO -   ID: 1, Name: qMS
2025-05-16 13:27:39,645 - main - INFO -   ID: 2, Name: Инфоклиника
2025-05-16 13:27:39,645 - main - INFO - Found 3 business units:
2025-05-16 13:27:39,646 - main - INFO -   ID: 1, Name: ОО ФК "Хадасса Медикал ЛТД"
2025-05-16 13:27:39,646 - main - INFO -   ID: 2, Name: ООО "Медскан"
2025-05-16 13:27:39,646 - main - INFO -   ID: 3, Name: ООО "Клинический госпиталь на Яузе"
2025-05-16 13:27:39,646 - main - INFO - Found 17 document types:
2025-05-16 13:27:39,647 - main - INFO -   ID: 1, Name: Паспорт
2025-05-16 13:27:39,647 - main - INFO -   ID: 2, Name: Паспорт СССР
2025-05-16 13:27:39,647 - main - INFO -   ID: 3, Name: Заграничный паспорт РФ
2025-05-16 13:27:39,647 - main - INFO -   ID: 4, Name: Заграничный паспорт СССР
2025-05-16 13:27:39,647 - main - INFO -   ID: 5, Name: Свидетельство о рождении
2025-05-16 13:27:39,647 - main - INFO -   ... and 12 more document types
2025-05-16 13:27:39,647 - src.connectors.postgres_connector - INFO - Disconnected from PostgreSQL
2025-05-16 13:27:39,647 - main - INFO - Testing document type handling...
2025-05-16 13:27:39,659 - src.connectors.postgres_connector - INFO - Connected to PostgreSQL
2025-05-16 13:27:39,660 - main - INFO - Found 17 document types in the documenttypes table
2025-05-16 13:27:39,667 - src.connectors.postgres_connector - INFO - Patient inserted with ID: 1
2025-05-16 13:27:39,667 - main - INFO - Inserted patient with Паспорт (ID: 1), number: 5174068192
2025-05-16 13:27:39,668 - src.connectors.postgres_connector - INFO - Patient inserted with ID: 2
2025-05-16 13:27:39,669 - main - INFO - Inserted patient with Заграничный паспорт РФ (ID: 3), number: 195042817
2025-05-16 13:27:39,670 - src.connectors.postgres_connector - INFO - Patient inserted with ID: 3
2025-05-16 13:27:39,670 - main - INFO - Inserted patient with Свидетельство о рождении (ID: 5), number: 647831800016
2025-05-16 13:27:39,671 - src.connectors.postgres_connector - INFO - Patient inserted with ID: 4
2025-05-16 13:27:39,671 - main - INFO - Inserted patient with Иностранный паспорт (ID: 10), number: 793579294
2025-05-16 13:27:39,672 - src.connectors.postgres_connector - INFO - Patient inserted with ID: 5
2025-05-16 13:27:39,673 - main - INFO - Inserted patient with Временное удостоверение (ID: 14), number: 91873666
2025-05-16 13:27:39,674 - src.connectors.postgres_connector - INFO - Patient inserted with ID: 6
2025-05-16 13:27:39,674 - main - INFO - Inserted patient with Иные документы (ID: 17), number: 28183794
2025-05-16 13:27:39,674 - main - INFO - Successfully inserted 6 out of 6 test patients with different document types
2025-05-16 13:27:39,674 - main - INFO - Successfully found patient by document type and number: UUID=652152cf-77bf-4310-90cc-01a7dcdccd9f
2025-05-16 13:27:39,675 - src.connectors.postgres_connector - INFO - Disconnected from PostgreSQL
2025-05-16 13:27:39,675 - main - INFO - Testing patient insertion...
2025-05-16 13:27:39,690 - src.connectors.postgres_connector - INFO - Connected to PostgreSQL
2025-05-16 13:27:39,691 - main - INFO - Using document type: Заграничный паспорт РФ (ID: 3) with number: 682327868
2025-05-16 13:27:39,696 - src.connectors.postgres_connector - INFO - Patient inserted with ID: 7
2025-05-16 13:27:39,696 - main - INFO - Sample patient inserted successfully
2025-05-16 13:27:39,697 - main - INFO - Verified patient in database: ID=7, UUID=e29cfebe-8144-4398-90b1-ffe76f417a05, Document=Заграничный паспорт РФ #682327868
2025-05-16 13:27:39,697 - src.connectors.postgres_connector - INFO - Disconnected from PostgreSQL
2025-05-16 13:27:39,697 - main - INFO - Testing patient fetch and import from Firebird to PostgreSQL...
2025-05-16 13:27:39,697 - src.connectors.firebird_connector - INFO - Testing TCP connectivity to 192.168.160.168:3050
2025-05-16 13:27:39,698 - src.connectors.firebird_connector - INFO - TCP connection to 192.168.160.168:3050 successful
2025-05-16 13:27:39,698 - src.connectors.firebird_connector - ERROR - Failed to connect to Firebird (Инфоклиника): Server 'infoclinica_server' already registered.
2025-05-16 13:27:39,698 - main - ERROR - Firebird connection failed
2025-05-16 13:27:39,698 - main - INFO - 
Test Results Summary:
2025-05-16 13:27:39,698 - main - INFO - PostgreSQL Connection: ✓
2025-05-16 13:27:39,698 - main - INFO - Firebird Connection: ✓
2025-05-16 13:27:39,698 - main - INFO - YottaDB Connection: ✗
2025-05-16 13:27:39,698 - main - INFO - PostgreSQL Schema: ✓
2025-05-16 13:27:39,698 - main - INFO - Document Type Handling: ✓
2025-05-16 13:27:39,698 - main - INFO - Patient Insertion: ✓
2025-05-16 13:27:39,699 - main - INFO - Firebird Import: ✗
2025-05-16 13:27:39,699 - main - INFO - 
Tests completed.
2025-05-20 11:53:45,003 - main - INFO - Starting tests...
2025-05-20 11:53:45,004 - main - INFO - Testing PostgreSQL connection...
2025-05-20 11:53:45,025 - src.connectors.postgres_connector - INFO - Connected to PostgreSQL
2025-05-20 11:53:45,025 - main - INFO - PostgreSQL connection successful
2025-05-20 11:53:45,026 - main - INFO - PostgreSQL version: PostgreSQL 15.12 (Debian 15.12-0+deb12u2) on x86_64-pc-linux-gnu, compiled by gcc (Debian 12.2.0-14) 12.2.0, 64-bit
2025-05-20 11:53:45,026 - src.connectors.postgres_connector - INFO - Disconnected from PostgreSQL
2025-05-20 11:53:45,026 - main - INFO - Testing Firebird connection...
2025-05-20 11:53:45,026 - main - INFO - Firebird config: {'host': '192.168.160.168:3050', 'database': '099-1', 'user': 'SYSDBA', 'password': 'masterkey', 'charset': 'UTF-8', 'debug': False}
2025-05-20 11:53:45,026 - src.connectors.firebird_connector - INFO - Testing TCP connectivity to 192.168.160.168:3050
2025-05-20 11:53:45,027 - src.connectors.firebird_connector - INFO - TCP connection to 192.168.160.168:3050 successful
2025-05-20 11:53:45,028 - src.connectors.firebird_connector - INFO - Attempting to connect to Firebird at 192.168.160.168:3050, database: 099-1
2025-05-20 11:53:45,104 - src.connectors.firebird_connector - INFO - Connected to Firebird (Инфоклиника) using firebird-driver
2025-05-20 11:53:45,104 - main - INFO - Firebird connection successful
2025-05-20 11:53:45,115 - main - INFO - Firebird current time: 2025-05-20 11:53:45.103000
2025-05-20 11:54:04,898 - src.connectors.firebird_connector - INFO - Fetched 684294 patients from Firebird (Инфоклиника)
2025-05-20 11:54:04,963 - main - INFO - Retrieved 684294 patients from Firebird (Инфоклиника)
2025-05-20 11:54:04,963 - main - INFO - Patient 1: Проверочный Иван
2025-05-20 11:54:04,963 - main - INFO - Patient 2: Петровский Василий
2025-05-20 11:54:04,963 - main - INFO - Patient 3: Смирнова Елена
2025-05-20 11:54:04,969 - src.connectors.firebird_connector - INFO - Disconnected from Firebird (Инфоклиника)
2025-05-20 11:54:05,118 - main - INFO - Testing YottaDB connection...
2025-05-20 11:54:05,118 - main - ERROR - YottaDB connection failed
2025-05-20 11:54:05,118 - main - INFO - Testing PostgreSQL schema...
2025-05-20 11:54:05,128 - src.connectors.postgres_connector - INFO - Connected to PostgreSQL
2025-05-20 11:54:05,136 - main - INFO - All essential tables exist
2025-05-20 11:54:05,138 - main - INFO - Found 2 HIS entries:
2025-05-20 11:54:05,138 - main - INFO -   ID: 1, Name: qMS
2025-05-20 11:54:05,138 - main - INFO -   ID: 2, Name: Инфоклиника
2025-05-20 11:54:05,139 - main - INFO - Found 3 business units:
2025-05-20 11:54:05,139 - main - INFO -   ID: 1, Name: ОО ФК "Хадасса Медикал ЛТД"
2025-05-20 11:54:05,139 - main - INFO -   ID: 2, Name: ООО "Медскан"
2025-05-20 11:54:05,140 - main - INFO -   ID: 3, Name: ООО "Клинический госпиталь на Яузе"
2025-05-20 11:54:05,140 - main - INFO - Found 17 document types:
2025-05-20 11:54:05,141 - main - INFO -   ID: 1, Name: Паспорт
2025-05-20 11:54:05,141 - main - INFO -   ID: 2, Name: Паспорт СССР
2025-05-20 11:54:05,141 - main - INFO -   ID: 3, Name: Заграничный паспорт РФ
2025-05-20 11:54:05,141 - main - INFO -   ID: 4, Name: Заграничный паспорт СССР
2025-05-20 11:54:05,141 - main - INFO -   ID: 5, Name: Свидетельство о рождении
2025-05-20 11:54:05,141 - main - INFO -   ... and 12 more document types
2025-05-20 11:54:05,141 - src.connectors.postgres_connector - INFO - Disconnected from PostgreSQL
2025-05-20 11:54:05,141 - main - INFO - Testing document type handling...
2025-05-20 11:54:05,151 - src.connectors.postgres_connector - INFO - Connected to PostgreSQL
2025-05-20 11:54:05,152 - main - INFO - Found 17 document types in the documenttypes table
2025-05-20 11:54:05,170 - src.connectors.postgres_connector - INFO - Patient inserted with ID: 100008
2025-05-20 11:54:05,171 - main - INFO - Inserted patient with Паспорт (ID: 1), number: 3053531673
2025-05-20 11:54:05,173 - src.connectors.postgres_connector - INFO - Patient inserted with ID: 100009
2025-05-20 11:54:05,174 - main - INFO - Inserted patient with Заграничный паспорт РФ (ID: 3), number: 959307636
2025-05-20 11:54:05,176 - src.connectors.postgres_connector - INFO - Patient inserted with ID: 100010
2025-05-20 11:54:05,177 - main - INFO - Inserted patient with Свидетельство о рождении (ID: 5), number: 856797379040
2025-05-20 11:54:05,179 - src.connectors.postgres_connector - INFO - Patient inserted with ID: 100011
2025-05-20 11:54:05,179 - main - INFO - Inserted patient with Иностранный паспорт (ID: 10), number: 362132873
2025-05-20 11:54:05,182 - src.connectors.postgres_connector - INFO - Patient inserted with ID: 100012
2025-05-20 11:54:05,182 - main - INFO - Inserted patient with Временное удостоверение (ID: 14), number: 57976869
2025-05-20 11:54:05,188 - src.connectors.postgres_connector - INFO - Patient inserted with ID: 100013
2025-05-20 11:54:05,188 - main - INFO - Inserted patient with Иные документы (ID: 17), number: 93431365
2025-05-20 11:54:05,188 - main - INFO - Successfully inserted 6 out of 6 test patients with different document types
2025-05-20 11:54:05,188 - main - INFO - Successfully found patient by document type and number: UUID=9925c0a3-2c25-40a2-8788-a984d6715940
2025-05-20 11:54:05,188 - src.connectors.postgres_connector - INFO - Disconnected from PostgreSQL
2025-05-20 11:54:05,189 - main - INFO - Testing patient insertion...
2025-05-20 11:54:05,199 - src.connectors.postgres_connector - INFO - Connected to PostgreSQL
2025-05-20 11:54:05,200 - main - INFO - Using document type: Заграничный паспорт РФ (ID: 3) with number: 473931203
2025-05-20 11:54:05,207 - src.connectors.postgres_connector - INFO - Patient inserted with ID: 100014
2025-05-20 11:54:05,207 - main - INFO - Sample patient inserted successfully
2025-05-20 11:54:05,209 - main - INFO - Verified patient in database: ID=100014, UUID=6ca69f3c-02ec-403b-9885-940d5ecb4152, Document=Заграничный паспорт РФ #473931203
2025-05-20 11:54:05,210 - src.connectors.postgres_connector - INFO - Disconnected from PostgreSQL
2025-05-20 11:54:05,210 - main - INFO - Testing patient fetch and import from Firebird to PostgreSQL...
2025-05-20 11:54:05,210 - src.connectors.firebird_connector - INFO - Testing TCP connectivity to 192.168.160.168:3050
2025-05-20 11:54:05,210 - src.connectors.firebird_connector - INFO - TCP connection to 192.168.160.168:3050 successful
2025-05-20 11:54:05,211 - src.connectors.firebird_connector - ERROR - Failed to connect to Firebird (Инфоклиника): Server 'infoclinica_server' already registered.
2025-05-20 11:54:05,211 - main - ERROR - Firebird connection failed
2025-05-20 11:54:05,211 - main - INFO - 
Test Results Summary:
2025-05-20 11:54:05,211 - main - INFO - PostgreSQL Connection: ✓
2025-05-20 11:54:05,211 - main - INFO - Firebird Connection: ✓
2025-05-20 11:54:05,211 - main - INFO - YottaDB Connection: ✗
2025-05-20 11:54:05,211 - main - INFO - PostgreSQL Schema: ✓
2025-05-20 11:54:05,211 - main - INFO - Document Type Handling: ✓
2025-05-20 11:54:05,211 - main - INFO - Patient Insertion: ✓
2025-05-20 11:54:05,211 - main - INFO - Firebird Import: ✗
2025-05-20 11:54:05,211 - main - INFO - 
Tests completed.
2025-05-20 12:49:57,969 - main - INFO - Starting tests...
2025-05-20 12:49:57,969 - main - INFO - Testing PostgreSQL connection...
2025-05-20 12:49:57,986 - src.connectors.postgres_connector - INFO - Connected to PostgreSQL
2025-05-20 12:49:57,986 - main - INFO - PostgreSQL connection successful
2025-05-20 12:49:57,987 - main - INFO - PostgreSQL version: PostgreSQL 15.12 (Debian 15.12-0+deb12u2) on x86_64-pc-linux-gnu, compiled by gcc (Debian 12.2.0-14) 12.2.0, 64-bit
2025-05-20 12:49:57,988 - src.connectors.postgres_connector - INFO - Disconnected from PostgreSQL
2025-05-20 12:49:57,988 - main - INFO - Testing Firebird connection...
2025-05-20 12:49:57,988 - main - INFO - Firebird config: {'host': '192.168.160.168:3050', 'database': '099-1', 'user': 'SYSDBA', 'password': 'masterkey', 'charset': 'UTF-8', 'debug': False}
2025-05-20 12:49:57,989 - src.connectors.firebird_connector - INFO - Testing TCP connectivity to 192.168.160.168:3050
2025-05-20 12:49:57,990 - src.connectors.firebird_connector - INFO - TCP connection to 192.168.160.168:3050 successful
2025-05-20 12:49:57,993 - src.connectors.firebird_connector - INFO - Registered Firebird server and database configurations
2025-05-20 12:49:57,993 - src.connectors.firebird_connector - INFO - Attempting to connect to Firebird at 192.168.160.168:3050, database: 099-1
2025-05-20 12:49:58,049 - src.connectors.firebird_connector - INFO - Connected to Firebird (Инфоклиника) using firebird-driver
2025-05-20 12:49:58,050 - main - INFO - Firebird connection successful
2025-05-20 12:49:58,059 - main - INFO - Firebird current time: 2025-05-20 12:49:58.050000
2025-05-20 12:49:58,071 - src.connectors.firebird_connector - INFO - Fetched 5 patients from Firebird (Инфоклиника)
2025-05-20 12:49:58,072 - main - INFO - Retrieved 5 patients from Firebird (Инфоклиника)
2025-05-20 12:49:58,072 - main - INFO - Patient 1: Проверочный Иван
2025-05-20 12:49:58,073 - main - INFO - Patient 2: Петровский Василий
2025-05-20 12:49:58,073 - main - INFO - Patient 3: Смирнова Елена
2025-05-20 12:49:58,077 - src.connectors.firebird_connector - INFO - Disconnected from Firebird (Инфоклиника)
2025-05-20 12:49:58,078 - main - INFO - Testing YottaDB connection...
2025-05-20 12:49:58,078 - main - ERROR - YottaDB connection failed
2025-05-20 12:49:58,078 - main - INFO - Testing PostgreSQL schema...
2025-05-20 12:49:58,101 - src.connectors.postgres_connector - INFO - Connected to PostgreSQL
2025-05-20 12:49:58,109 - main - INFO - All essential tables exist
2025-05-20 12:49:58,111 - main - INFO - Found 2 HIS entries:
2025-05-20 12:49:58,111 - main - INFO -   ID: 1, Name: qMS
2025-05-20 12:49:58,112 - main - INFO -   ID: 2, Name: Инфоклиника
2025-05-20 12:49:58,114 - main - INFO - Found 3 business units:
2025-05-20 12:49:58,114 - main - INFO -   ID: 1, Name: ОО ФК "Хадасса Медикал ЛТД"
2025-05-20 12:49:58,114 - main - INFO -   ID: 2, Name: ООО "Медскан"
2025-05-20 12:49:58,114 - main - INFO -   ID: 3, Name: ООО "Клинический госпиталь на Яузе"
2025-05-20 12:49:58,115 - main - INFO - Found 17 document types:
2025-05-20 12:49:58,116 - main - INFO -   ID: 1, Name: Паспорт
2025-05-20 12:49:58,116 - main - INFO -   ID: 2, Name: Паспорт СССР
2025-05-20 12:49:58,116 - main - INFO -   ID: 3, Name: Заграничный паспорт РФ
2025-05-20 12:49:58,116 - main - INFO -   ID: 4, Name: Заграничный паспорт СССР
2025-05-20 12:49:58,116 - main - INFO -   ID: 5, Name: Свидетельство о рождении
2025-05-20 12:49:58,116 - main - INFO -   ... and 12 more document types
2025-05-20 12:49:58,116 - src.connectors.postgres_connector - INFO - Disconnected from PostgreSQL
2025-05-20 12:49:58,116 - main - INFO - Testing document type handling...
2025-05-20 12:49:58,145 - src.connectors.postgres_connector - INFO - Connected to PostgreSQL
2025-05-20 12:49:58,149 - main - INFO - Found 17 document types in the documenttypes table
2025-05-20 12:49:58,167 - src.connectors.postgres_connector - INFO - Patient inserted with ID: 100015
2025-05-20 12:49:58,168 - main - INFO - Inserted patient with Паспорт (ID: 1), number: 5493840391
2025-05-20 12:49:58,173 - src.connectors.postgres_connector - INFO - Patient inserted with ID: 100016
2025-05-20 12:49:58,173 - main - INFO - Inserted patient with Заграничный паспорт РФ (ID: 3), number: 667635398
2025-05-20 12:49:58,178 - src.connectors.postgres_connector - INFO - Patient inserted with ID: 100017
2025-05-20 12:49:58,178 - main - INFO - Inserted patient with Свидетельство о рождении (ID: 5), number: 542463650097
2025-05-20 12:49:58,184 - src.connectors.postgres_connector - INFO - Patient inserted with ID: 100018
2025-05-20 12:49:58,184 - main - INFO - Inserted patient with Иностранный паспорт (ID: 10), number: 320786213
2025-05-20 12:49:58,187 - src.connectors.postgres_connector - INFO - Patient inserted with ID: 100019
2025-05-20 12:49:58,187 - main - INFO - Inserted patient with Временное удостоверение (ID: 14), number: 41380800
2025-05-20 12:49:58,191 - src.connectors.postgres_connector - INFO - Patient inserted with ID: 100020
2025-05-20 12:49:58,191 - main - INFO - Inserted patient with Иные документы (ID: 17), number: 28079620
2025-05-20 12:49:58,191 - main - INFO - Successfully inserted 6 out of 6 test patients with different document types
2025-05-20 12:49:58,192 - main - INFO - Successfully found patient by document type and number: UUID=7906cc93-acf5-4337-85ec-e52e02dc9ea8
2025-05-20 12:49:58,192 - src.connectors.postgres_connector - INFO - Disconnected from PostgreSQL
2025-05-20 12:49:58,192 - main - INFO - Testing patient insertion...
2025-05-20 12:49:58,212 - src.connectors.postgres_connector - INFO - Connected to PostgreSQL
2025-05-20 12:49:58,213 - main - INFO - Using document type: Паспорт (ID: 1) with number: 5491639907
2025-05-20 12:49:58,228 - src.connectors.postgres_connector - INFO - Patient inserted with ID: 100021
2025-05-20 12:49:58,228 - main - INFO - Sample patient inserted successfully
2025-05-20 12:49:58,231 - main - INFO - Verified patient in database: ID=100021, UUID=17e990a9-9687-439f-945d-ce8e22c44c01, Document=Паспорт #5491639907
2025-05-20 12:49:58,231 - src.connectors.postgres_connector - INFO - Disconnected from PostgreSQL
2025-05-20 12:49:58,231 - main - INFO - Testing patient fetch and import from Firebird to PostgreSQL...
2025-05-20 12:49:58,231 - src.connectors.firebird_connector - INFO - Testing TCP connectivity to 192.168.160.168:3050
2025-05-20 12:49:58,232 - src.connectors.firebird_connector - INFO - TCP connection to 192.168.160.168:3050 successful
2025-05-20 12:49:58,232 - src.connectors.firebird_connector - INFO - Using previously registered Firebird configuration
2025-05-20 12:49:58,232 - src.connectors.firebird_connector - INFO - Attempting to connect to Firebird at 192.168.160.168:3050, database: 099-1
2025-05-20 12:49:58,274 - src.connectors.firebird_connector - INFO - Connected to Firebird (Инфоклиника) using firebird-driver
2025-05-20 12:49:58,305 - src.connectors.postgres_connector - INFO - Connected to PostgreSQL
2025-05-20 12:49:58,325 - src.connectors.firebird_connector - INFO - Fetched 10 patients from Firebird (Инфоклиника)
2025-05-20 12:49:58,325 - main - INFO - Retrieved 10 patients from Firebird
2025-05-20 12:49:58,332 - src.connectors.postgres_connector - ERROR - Error inserting patient: ОШИБКА:  INSERT или UPDATE в таблице "patients" нарушает ограничение внешнего ключа "patients_documenttypes_fkey"
DETAIL:  Ключ (documenttypes)=(99) отсутствует в таблице "documenttypes".
CONTEXT:  SQL-оператор: "INSERT INTO patients (
            documenttypes, document_number,
            lastname, name, surname, birthdate,
            primary_source,
            hisnumber_qms, email_qms, telephone_qms, password_qms,
            hisnumber_infoclinica, email_infoclinica, telephone_infoclinica, password_infoclinica
        ) 
        VALUES (
            NEW.documenttypes, NEW.document_number,
            NEW.lastname, NEW.name, NEW.surname, NEW.birthdate,
            NEW.source,
            CASE WHEN v_his_name = 'qMS' THEN NEW.hisnumber ELSE NULL END,
            CASE WHEN v_his_name = 'qMS' THEN NEW.email ELSE NULL END,
            CASE WHEN v_his_name = 'qMS' THEN NEW.telephone ELSE NULL END,
            CASE WHEN v_his_name = 'qMS' THEN NEW.his_password ELSE NULL END,
            CASE WHEN v_his_name = 'Инфоклиника' THEN NEW.hisnumber ELSE NULL END,
            CASE WHEN v_his_name = 'Инфоклиника' THEN NEW.email ELSE NULL END,
            CASE WHEN v_his_name = 'Инфоклиника' THEN NEW.telephone ELSE NULL END,
            CASE WHEN v_his_name = 'Инфоклиника' THEN NEW.his_password ELSE NULL END
        )
        RETURNING uuid"
функция PL/pgSQL process_new_patient(), строка 103, оператор SQL-оператор

2025-05-20 12:49:58,333 - src.connectors.postgres_connector - ERROR - Error inserting patient: ОШИБКА:  INSERT или UPDATE в таблице "patients" нарушает ограничение внешнего ключа "patients_documenttypes_fkey"
DETAIL:  Ключ (documenttypes)=(99) отсутствует в таблице "documenttypes".
CONTEXT:  SQL-оператор: "INSERT INTO patients (
            documenttypes, document_number,
            lastname, name, surname, birthdate,
            primary_source,
            hisnumber_qms, email_qms, telephone_qms, password_qms,
            hisnumber_infoclinica, email_infoclinica, telephone_infoclinica, password_infoclinica
        ) 
        VALUES (
            NEW.documenttypes, NEW.document_number,
            NEW.lastname, NEW.name, NEW.surname, NEW.birthdate,
            NEW.source,
            CASE WHEN v_his_name = 'qMS' THEN NEW.hisnumber ELSE NULL END,
            CASE WHEN v_his_name = 'qMS' THEN NEW.email ELSE NULL END,
            CASE WHEN v_his_name = 'qMS' THEN NEW.telephone ELSE NULL END,
            CASE WHEN v_his_name = 'qMS' THEN NEW.his_password ELSE NULL END,
            CASE WHEN v_his_name = 'Инфоклиника' THEN NEW.hisnumber ELSE NULL END,
            CASE WHEN v_his_name = 'Инфоклиника' THEN NEW.email ELSE NULL END,
            CASE WHEN v_his_name = 'Инфоклиника' THEN NEW.telephone ELSE NULL END,
            CASE WHEN v_his_name = 'Инфоклиника' THEN NEW.his_password ELSE NULL END
        )
        RETURNING uuid"
функция PL/pgSQL process_new_patient(), строка 103, оператор SQL-оператор

2025-05-20 12:49:58,335 - src.connectors.postgres_connector - ERROR - Error inserting patient: ОШИБКА:  INSERT или UPDATE в таблице "patients" нарушает ограничение внешнего ключа "patients_documenttypes_fkey"
DETAIL:  Ключ (documenttypes)=(99) отсутствует в таблице "documenttypes".
CONTEXT:  SQL-оператор: "INSERT INTO patients (
            documenttypes, document_number,
            lastname, name, surname, birthdate,
            primary_source,
            hisnumber_qms, email_qms, telephone_qms, password_qms,
            hisnumber_infoclinica, email_infoclinica, telephone_infoclinica, password_infoclinica
        ) 
        VALUES (
            NEW.documenttypes, NEW.document_number,
            NEW.lastname, NEW.name, NEW.surname, NEW.birthdate,
            NEW.source,
            CASE WHEN v_his_name = 'qMS' THEN NEW.hisnumber ELSE NULL END,
            CASE WHEN v_his_name = 'qMS' THEN NEW.email ELSE NULL END,
            CASE WHEN v_his_name = 'qMS' THEN NEW.telephone ELSE NULL END,
            CASE WHEN v_his_name = 'qMS' THEN NEW.his_password ELSE NULL END,
            CASE WHEN v_his_name = 'Инфоклиника' THEN NEW.hisnumber ELSE NULL END,
            CASE WHEN v_his_name = 'Инфоклиника' THEN NEW.email ELSE NULL END,
            CASE WHEN v_his_name = 'Инфоклиника' THEN NEW.telephone ELSE NULL END,
            CASE WHEN v_his_name = 'Инфоклиника' THEN NEW.his_password ELSE NULL END
        )
        RETURNING uuid"
функция PL/pgSQL process_new_patient(), строка 103, оператор SQL-оператор

2025-05-20 12:49:58,343 - src.connectors.postgres_connector - INFO - Patient inserted with ID: 100025
2025-05-20 12:49:58,346 - src.connectors.postgres_connector - ERROR - Error inserting patient: ОШИБКА:  INSERT или UPDATE в таблице "patients" нарушает ограничение внешнего ключа "patients_documenttypes_fkey"
DETAIL:  Ключ (documenttypes)=(99) отсутствует в таблице "documenttypes".
CONTEXT:  SQL-оператор: "INSERT INTO patients (
            documenttypes, document_number,
            lastname, name, surname, birthdate,
            primary_source,
            hisnumber_qms, email_qms, telephone_qms, password_qms,
            hisnumber_infoclinica, email_infoclinica, telephone_infoclinica, password_infoclinica
        ) 
        VALUES (
            NEW.documenttypes, NEW.document_number,
            NEW.lastname, NEW.name, NEW.surname, NEW.birthdate,
            NEW.source,
            CASE WHEN v_his_name = 'qMS' THEN NEW.hisnumber ELSE NULL END,
            CASE WHEN v_his_name = 'qMS' THEN NEW.email ELSE NULL END,
            CASE WHEN v_his_name = 'qMS' THEN NEW.telephone ELSE NULL END,
            CASE WHEN v_his_name = 'qMS' THEN NEW.his_password ELSE NULL END,
            CASE WHEN v_his_name = 'Инфоклиника' THEN NEW.hisnumber ELSE NULL END,
            CASE WHEN v_his_name = 'Инфоклиника' THEN NEW.email ELSE NULL END,
            CASE WHEN v_his_name = 'Инфоклиника' THEN NEW.telephone ELSE NULL END,
            CASE WHEN v_his_name = 'Инфоклиника' THEN NEW.his_password ELSE NULL END
        )
        RETURNING uuid"
функция PL/pgSQL process_new_patient(), строка 103, оператор SQL-оператор

2025-05-20 12:49:58,352 - src.connectors.postgres_connector - INFO - Patient inserted with ID: 100027
2025-05-20 12:49:58,357 - src.connectors.postgres_connector - INFO - Patient inserted with ID: 100028
2025-05-20 12:49:58,364 - src.connectors.postgres_connector - INFO - Patient inserted with ID: 100029
2025-05-20 12:49:58,366 - src.connectors.postgres_connector - ERROR - Error inserting patient: ОШИБКА:  INSERT или UPDATE в таблице "patients" нарушает ограничение внешнего ключа "patients_documenttypes_fkey"
DETAIL:  Ключ (documenttypes)=(99) отсутствует в таблице "documenttypes".
CONTEXT:  SQL-оператор: "INSERT INTO patients (
            documenttypes, document_number,
            lastname, name, surname, birthdate,
            primary_source,
            hisnumber_qms, email_qms, telephone_qms, password_qms,
            hisnumber_infoclinica, email_infoclinica, telephone_infoclinica, password_infoclinica
        ) 
        VALUES (
            NEW.documenttypes, NEW.document_number,
            NEW.lastname, NEW.name, NEW.surname, NEW.birthdate,
            NEW.source,
            CASE WHEN v_his_name = 'qMS' THEN NEW.hisnumber ELSE NULL END,
            CASE WHEN v_his_name = 'qMS' THEN NEW.email ELSE NULL END,
            CASE WHEN v_his_name = 'qMS' THEN NEW.telephone ELSE NULL END,
            CASE WHEN v_his_name = 'qMS' THEN NEW.his_password ELSE NULL END,
            CASE WHEN v_his_name = 'Инфоклиника' THEN NEW.hisnumber ELSE NULL END,
            CASE WHEN v_his_name = 'Инфоклиника' THEN NEW.email ELSE NULL END,
            CASE WHEN v_his_name = 'Инфоклиника' THEN NEW.telephone ELSE NULL END,
            CASE WHEN v_his_name = 'Инфоклиника' THEN NEW.his_password ELSE NULL END
        )
        RETURNING uuid"
функция PL/pgSQL process_new_patient(), строка 103, оператор SQL-оператор

2025-05-20 12:49:58,372 - src.connectors.postgres_connector - INFO - Patient inserted with ID: 100031
2025-05-20 12:49:58,372 - main - INFO - Successfully imported 5 out of 10 patients
2025-05-20 12:49:58,414 - main - INFO - Total Инфоклиника patients in database: 49962
2025-05-20 12:49:58,464 - main - INFO - Document type distribution:
2025-05-20 12:49:58,464 - main - INFO -   - Паспорт: 49523
2025-05-20 12:49:58,464 - main - INFO -   - Заграничный паспорт РФ: 7187
2025-05-20 12:49:58,464 - main - INFO -   - Свидетельство о рождении: 3601
2025-05-20 12:49:58,464 - main - INFO -   - Иные документы: 3581
2025-05-20 12:49:58,464 - main - INFO -   - Временное удостоверение: 3495
2025-05-20 12:49:58,472 - src.connectors.firebird_connector - INFO - Disconnected from Firebird (Инфоклиника)
2025-05-20 12:49:58,472 - src.connectors.postgres_connector - INFO - Disconnected from PostgreSQL
2025-05-20 12:49:58,472 - main - INFO - 
Test Results Summary:
2025-05-20 12:49:58,472 - main - INFO - PostgreSQL Connection: ✓
2025-05-20 12:49:58,472 - main - INFO - Firebird Connection: ✓
2025-05-20 12:49:58,473 - main - INFO - YottaDB Connection: ✗
2025-05-20 12:49:58,473 - main - INFO - PostgreSQL Schema: ✓
2025-05-20 12:49:58,473 - main - INFO - Document Type Handling: ✓
2025-05-20 12:49:58,473 - main - INFO - Patient Insertion: ✓
2025-05-20 12:49:58,473 - main - INFO - Firebird Import: ✓
2025-05-20 12:49:58,473 - main - INFO - 
Tests completed.
2025-05-20 13:00:50,859 - main - INFO - Starting tests...
2025-05-20 13:00:50,859 - main - INFO - Testing PostgreSQL connection...
2025-05-20 13:00:50,871 - src.connectors.postgres_connector - INFO - Connected to PostgreSQL
2025-05-20 13:00:50,871 - main - INFO - PostgreSQL connection successful
2025-05-20 13:00:50,872 - main - INFO - PostgreSQL version: PostgreSQL 15.12 (Debian 15.12-0+deb12u2) on x86_64-pc-linux-gnu, compiled by gcc (Debian 12.2.0-14) 12.2.0, 64-bit
2025-05-20 13:00:50,872 - src.connectors.postgres_connector - INFO - Disconnected from PostgreSQL
2025-05-20 13:00:50,872 - main - INFO - Testing Firebird connection...
2025-05-20 13:00:50,872 - main - INFO - Firebird config: {'host': '192.168.160.168:3050', 'database': '099-1', 'user': 'SYSDBA', 'password': 'masterkey', 'charset': 'UTF-8', 'debug': False}
2025-05-20 13:00:50,872 - src.connectors.firebird_connector - INFO - Testing TCP connectivity to 192.168.160.168:3050
2025-05-20 13:00:50,873 - src.connectors.firebird_connector - INFO - TCP connection to 192.168.160.168:3050 successful
2025-05-20 13:00:50,874 - src.connectors.firebird_connector - INFO - Registered Firebird server and database configurations
2025-05-20 13:00:50,874 - src.connectors.firebird_connector - INFO - Attempting to connect to Firebird at 192.168.160.168:3050, database: 099-1
2025-05-20 13:00:50,935 - src.connectors.firebird_connector - INFO - Connected to Firebird (Инфоклиника) using firebird-driver
2025-05-20 13:00:50,935 - main - INFO - Firebird connection successful
2025-05-20 13:00:50,944 - main - INFO - Firebird current time: 2025-05-20 13:00:50.936000
2025-05-20 13:00:50,956 - src.connectors.firebird_connector - INFO - Fetched 5 patients from Firebird (Инфоклиника)
2025-05-20 13:00:50,957 - main - INFO - Retrieved 5 patients from Firebird (Инфоклиника)
2025-05-20 13:00:50,957 - main - INFO - Patient 1: Проверочный Иван
2025-05-20 13:00:50,957 - main - INFO - Patient 2: Петровский Василий
2025-05-20 13:00:50,957 - main - INFO - Patient 3: Смирнова Елена
2025-05-20 13:00:50,961 - src.connectors.firebird_connector - INFO - Disconnected from Firebird (Инфоклиника)
2025-05-20 13:00:50,961 - main - INFO - Testing YottaDB connection...
2025-05-20 13:00:50,961 - main - ERROR - YottaDB connection failed
2025-05-20 13:00:50,961 - main - INFO - Testing PostgreSQL schema...
2025-05-20 13:00:50,987 - src.connectors.postgres_connector - INFO - Connected to PostgreSQL
2025-05-20 13:00:50,993 - main - INFO - All essential tables exist
2025-05-20 13:00:50,993 - main - INFO - Found 2 HIS entries:
2025-05-20 13:00:50,993 - main - INFO -   ID: 1, Name: qMS
2025-05-20 13:00:50,993 - main - INFO -   ID: 2, Name: Инфоклиника
2025-05-20 13:00:50,994 - main - INFO - Found 3 business units:
2025-05-20 13:00:50,994 - main - INFO -   ID: 1, Name: ОО ФК "Хадасса Медикал ЛТД"
2025-05-20 13:00:50,994 - main - INFO -   ID: 2, Name: ООО "Медскан"
2025-05-20 13:00:50,994 - main - INFO -   ID: 3, Name: ООО "Клинический госпиталь на Яузе"
2025-05-20 13:00:50,994 - main - INFO - Found 17 document types:
2025-05-20 13:00:50,994 - main - INFO -   ID: 1, Name: Паспорт
2025-05-20 13:00:50,994 - main - INFO -   ID: 2, Name: Паспорт СССР
2025-05-20 13:00:50,994 - main - INFO -   ID: 3, Name: Заграничный паспорт РФ
2025-05-20 13:00:50,994 - main - INFO -   ID: 4, Name: Заграничный паспорт СССР
2025-05-20 13:00:50,994 - main - INFO -   ID: 5, Name: Свидетельство о рождении
2025-05-20 13:00:50,994 - main - INFO -   ... and 12 more document types
2025-05-20 13:00:50,995 - src.connectors.postgres_connector - INFO - Disconnected from PostgreSQL
2025-05-20 13:00:50,995 - main - INFO - Testing document type handling...
2025-05-20 13:00:51,008 - src.connectors.postgres_connector - INFO - Connected to PostgreSQL
2025-05-20 13:00:51,009 - main - INFO - Found 17 document types in the documenttypes table
2025-05-20 13:00:51,015 - src.connectors.postgres_connector - INFO - Patient inserted with ID: 100032
2025-05-20 13:00:51,015 - main - INFO - Inserted patient with Паспорт (ID: 1), number: 9437317561
2025-05-20 13:00:51,017 - src.connectors.postgres_connector - INFO - Patient inserted with ID: 100033
2025-05-20 13:00:51,017 - main - INFO - Inserted patient with Заграничный паспорт РФ (ID: 3), number: 189250721
2025-05-20 13:00:51,020 - src.connectors.postgres_connector - INFO - Patient inserted with ID: 100034
2025-05-20 13:00:51,020 - main - INFO - Inserted patient with Свидетельство о рождении (ID: 5), number: 923718780589
2025-05-20 13:00:51,023 - src.connectors.postgres_connector - INFO - Patient inserted with ID: 100035
2025-05-20 13:00:51,023 - main - INFO - Inserted patient with Иностранный паспорт (ID: 10), number: 769590944
2025-05-20 13:00:51,025 - src.connectors.postgres_connector - INFO - Patient inserted with ID: 100036
2025-05-20 13:00:51,025 - main - INFO - Inserted patient with Временное удостоверение (ID: 14), number: 83236769
2025-05-20 13:00:51,028 - src.connectors.postgres_connector - INFO - Patient inserted with ID: 100037
2025-05-20 13:00:51,028 - main - INFO - Inserted patient with Иные документы (ID: 17), number: 10127067
2025-05-20 13:00:51,029 - main - INFO - Successfully inserted 6 out of 6 test patients with different document types
2025-05-20 13:00:51,029 - main - INFO - Successfully found patient by document type and number: UUID=5b37d9dd-4b67-4db7-b279-92e8a3244c3e
2025-05-20 13:00:51,030 - src.connectors.postgres_connector - INFO - Disconnected from PostgreSQL
2025-05-20 13:00:51,030 - main - INFO - Testing patient insertion...
2025-05-20 13:00:51,044 - src.connectors.postgres_connector - INFO - Connected to PostgreSQL
2025-05-20 13:00:51,044 - main - INFO - Using document type: Временное удостоверение (ID: 14) with number: 82605082
2025-05-20 13:00:51,050 - src.connectors.postgres_connector - INFO - Patient inserted with ID: 100038
2025-05-20 13:00:51,050 - main - INFO - Sample patient inserted successfully
2025-05-20 13:00:51,052 - main - INFO - Verified patient in database: ID=100038, UUID=a2e64c36-368d-4c1f-8aee-92824cac53ed, Document=Временное удостоверение #82605082
2025-05-20 13:00:51,053 - src.connectors.postgres_connector - INFO - Disconnected from PostgreSQL
2025-05-20 13:00:51,053 - main - INFO - Testing patient fetch and import from Firebird to PostgreSQL...
2025-05-20 13:00:51,053 - src.connectors.firebird_connector - INFO - Testing TCP connectivity to 192.168.160.168:3050
2025-05-20 13:00:51,054 - src.connectors.firebird_connector - INFO - TCP connection to 192.168.160.168:3050 successful
2025-05-20 13:00:51,054 - src.connectors.firebird_connector - INFO - Using previously registered Firebird configuration
2025-05-20 13:00:51,054 - src.connectors.firebird_connector - INFO - Attempting to connect to Firebird at 192.168.160.168:3050, database: 099-1
2025-05-20 13:00:51,098 - src.connectors.firebird_connector - INFO - Connected to Firebird (Инфоклиника) using firebird-driver
2025-05-20 13:00:51,113 - src.connectors.postgres_connector - INFO - Connected to PostgreSQL
2025-05-20 13:00:51,127 - src.connectors.firebird_connector - INFO - Fetched 10 patients from Firebird (Инфоклиника)
2025-05-20 13:00:51,127 - main - INFO - Retrieved 10 patients from Firebird
2025-05-20 13:00:51,135 - src.connectors.postgres_connector - INFO - Patient inserted with ID: 100039
2025-05-20 13:00:51,137 - src.connectors.postgres_connector - INFO - Patient inserted with ID: 100040
2025-05-20 13:00:51,140 - src.connectors.postgres_connector - INFO - Patient inserted with ID: 100041
2025-05-20 13:00:51,142 - src.connectors.postgres_connector - ERROR - Error inserting patient: ОШИБКА:  повторяющееся значение ключа нарушает ограничение уникальности "unique_hisnumber_source"
DETAIL:  Ключ "(hisnumber, source)=(15631, 2)" уже существует.

2025-05-20 13:00:51,144 - src.connectors.postgres_connector - INFO - Patient inserted with ID: 100043
2025-05-20 13:00:51,145 - src.connectors.postgres_connector - ERROR - Error inserting patient: ОШИБКА:  повторяющееся значение ключа нарушает ограничение уникальности "unique_hisnumber_source"
DETAIL:  Ключ "(hisnumber, source)=(10000072, 2)" уже существует.

2025-05-20 13:00:51,146 - src.connectors.postgres_connector - ERROR - Error inserting patient: ОШИБКА:  повторяющееся значение ключа нарушает ограничение уникальности "unique_hisnumber_source"
DETAIL:  Ключ "(hisnumber, source)=(40003556, 2)" уже существует.

2025-05-20 13:00:51,146 - src.connectors.postgres_connector - ERROR - Error inserting patient: ОШИБКА:  повторяющееся значение ключа нарушает ограничение уникальности "unique_hisnumber_source"
DETAIL:  Ключ "(hisnumber, source)=(10000609, 2)" уже существует.

2025-05-20 13:00:51,149 - src.connectors.postgres_connector - INFO - Patient inserted with ID: 100047
2025-05-20 13:00:51,149 - src.connectors.postgres_connector - ERROR - Error inserting patient: ОШИБКА:  повторяющееся значение ключа нарушает ограничение уникальности "unique_hisnumber_source"
DETAIL:  Ключ "(hisnumber, source)=(122548, 2)" уже существует.

2025-05-20 13:00:51,149 - main - INFO - Successfully imported 5 out of 10 patients
2025-05-20 13:00:51,155 - main - INFO - Total Инфоклиника patients in database: 49967
2025-05-20 13:00:51,178 - main - INFO - Document type distribution:
2025-05-20 13:00:51,179 - main - INFO -   - Паспорт: 49524
2025-05-20 13:00:51,179 - main - INFO -   - Заграничный паспорт РФ: 7188
2025-05-20 13:00:51,179 - main - INFO -   - Свидетельство о рождении: 3602
2025-05-20 13:00:51,179 - main - INFO -   - Иные документы: 3587
2025-05-20 13:00:51,179 - main - INFO -   - Временное удостоверение: 3497
2025-05-20 13:00:51,187 - src.connectors.firebird_connector - INFO - Disconnected from Firebird (Инфоклиника)
2025-05-20 13:00:51,187 - src.connectors.postgres_connector - INFO - Disconnected from PostgreSQL
2025-05-20 13:00:51,188 - main - INFO - 
Test Results Summary:
2025-05-20 13:00:51,188 - main - INFO - PostgreSQL Connection: ✓
2025-05-20 13:00:51,188 - main - INFO - Firebird Connection: ✓
2025-05-20 13:00:51,188 - main - INFO - YottaDB Connection: ✗
2025-05-20 13:00:51,188 - main - INFO - PostgreSQL Schema: ✓
2025-05-20 13:00:51,188 - main - INFO - Document Type Handling: ✓
2025-05-20 13:00:51,188 - main - INFO - Patient Insertion: ✓
2025-05-20 13:00:51,188 - main - INFO - Firebird Import: ✓
2025-05-20 13:00:51,188 - main - INFO - 
Tests completed.
2025-05-20 13:18:41,619 - main - INFO - Starting tests...
2025-05-20 13:18:41,619 - main - INFO - Testing PostgreSQL connection...
2025-05-20 13:18:41,635 - src.connectors.postgres_connector - INFO - Connected to PostgreSQL
2025-05-20 13:18:41,636 - main - INFO - PostgreSQL connection successful
2025-05-20 13:18:41,637 - main - INFO - PostgreSQL version: PostgreSQL 15.12 (Debian 15.12-0+deb12u2) on x86_64-pc-linux-gnu, compiled by gcc (Debian 12.2.0-14) 12.2.0, 64-bit
2025-05-20 13:18:41,637 - src.connectors.postgres_connector - INFO - Disconnected from PostgreSQL
2025-05-20 13:18:41,637 - main - INFO - Testing Firebird connection...
2025-05-20 13:18:41,638 - main - INFO - Firebird config: {'host': '192.168.160.168:3050', 'database': '099-1', 'user': 'SYSDBA', 'password': 'masterkey', 'charset': 'UTF-8', 'debug': False}
2025-05-20 13:18:41,638 - src.connectors.firebird_connector - INFO - Testing TCP connectivity to 192.168.160.168:3050
2025-05-20 13:18:41,639 - src.connectors.firebird_connector - INFO - TCP connection to 192.168.160.168:3050 successful
2025-05-20 13:18:41,640 - src.connectors.firebird_connector - INFO - Registered Firebird server and database configurations
2025-05-20 13:18:41,640 - src.connectors.firebird_connector - INFO - Attempting to connect to Firebird at 192.168.160.168:3050, database: 099-1
2025-05-20 13:18:41,696 - src.connectors.firebird_connector - INFO - Connected to Firebird using firebird-driver
2025-05-20 13:18:41,697 - main - INFO - Firebird connection successful
2025-05-20 13:18:41,705 - main - INFO - Firebird current time: 2025-05-20 13:18:41.696000
2025-05-20 13:18:41,705 - main - ERROR - Error fetching patients from Firebird: 'FirebirdConnector' object has no attribute 'fetch_patients'
2025-05-20 13:18:41,711 - src.connectors.firebird_connector - INFO - Disconnected from Firebird
2025-05-20 13:18:41,711 - main - INFO - Testing YottaDB connection...
2025-05-20 13:18:41,711 - main - ERROR - YottaDB connection failed
2025-05-20 13:18:41,711 - main - INFO - Testing PostgreSQL schema...
2025-05-20 13:18:41,730 - src.connectors.postgres_connector - INFO - Connected to PostgreSQL
2025-05-20 13:18:41,734 - main - INFO - All essential tables exist
2025-05-20 13:18:41,735 - main - INFO - Found 2 HIS entries:
2025-05-20 13:18:41,735 - main - INFO -   ID: 1, Name: qMS
2025-05-20 13:18:41,735 - main - INFO -   ID: 2, Name: Инфоклиника
2025-05-20 13:18:41,736 - main - INFO - Found 3 business units:
2025-05-20 13:18:41,736 - main - INFO -   ID: 1, Name: ОО ФК "Хадасса Медикал ЛТД"
2025-05-20 13:18:41,736 - main - INFO -   ID: 2, Name: ООО "Медскан"
2025-05-20 13:18:41,736 - main - INFO -   ID: 3, Name: ООО "Клинический госпиталь на Яузе"
2025-05-20 13:18:41,736 - main - INFO - Found 17 document types:
2025-05-20 13:18:41,736 - main - INFO -   ID: 1, Name: Паспорт
2025-05-20 13:18:41,736 - main - INFO -   ID: 2, Name: Паспорт СССР
2025-05-20 13:18:41,736 - main - INFO -   ID: 3, Name: Заграничный паспорт РФ
2025-05-20 13:18:41,736 - main - INFO -   ID: 4, Name: Заграничный паспорт СССР
2025-05-20 13:18:41,736 - main - INFO -   ID: 5, Name: Свидетельство о рождении
2025-05-20 13:18:41,737 - main - INFO -   ... and 12 more document types
2025-05-20 13:18:41,737 - src.connectors.postgres_connector - INFO - Disconnected from PostgreSQL
2025-05-20 13:18:41,737 - main - INFO - Testing document type handling...
2025-05-20 13:18:41,753 - src.connectors.postgres_connector - INFO - Connected to PostgreSQL
2025-05-20 13:18:41,754 - main - INFO - Found 17 document types in the documenttypes table
2025-05-20 13:18:41,765 - src.connectors.postgres_connector - INFO - Patient inserted with ID: 100049
2025-05-20 13:18:41,765 - main - INFO - Inserted patient with Паспорт (ID: 1), number: 4877701256
2025-05-20 13:18:41,768 - src.connectors.postgres_connector - INFO - Patient inserted with ID: 100050
2025-05-20 13:18:41,768 - main - INFO - Inserted patient with Заграничный паспорт РФ (ID: 3), number: 668875770
2025-05-20 13:18:41,772 - src.connectors.postgres_connector - INFO - Patient inserted with ID: 100051
2025-05-20 13:18:41,773 - main - INFO - Inserted patient with Свидетельство о рождении (ID: 5), number: 796408780103
2025-05-20 13:18:41,776 - src.connectors.postgres_connector - INFO - Patient inserted with ID: 100052
2025-05-20 13:18:41,776 - main - INFO - Inserted patient with Иностранный паспорт (ID: 10), number: 582002186
2025-05-20 13:18:41,779 - src.connectors.postgres_connector - INFO - Patient inserted with ID: 100053
2025-05-20 13:18:41,779 - main - INFO - Inserted patient with Временное удостоверение (ID: 14), number: 73848618
2025-05-20 13:18:41,781 - src.connectors.postgres_connector - INFO - Patient inserted with ID: 100054
2025-05-20 13:18:41,781 - main - INFO - Inserted patient with Иные документы (ID: 17), number: 81863073
2025-05-20 13:18:41,781 - main - INFO - Successfully inserted 6 out of 6 test patients with different document types
2025-05-20 13:18:41,781 - main - INFO - Successfully found patient by document type and number: UUID=2cc76917-3306-4c00-b25e-55acc4637b51
2025-05-20 13:18:41,782 - src.connectors.postgres_connector - INFO - Disconnected from PostgreSQL
2025-05-20 13:18:41,782 - main - INFO - Testing patient insertion...
2025-05-20 13:18:41,794 - src.connectors.postgres_connector - INFO - Connected to PostgreSQL
2025-05-20 13:18:41,794 - main - INFO - Using document type: Иностранный паспорт (ID: 10) with number: 729293908
2025-05-20 13:18:41,800 - src.connectors.postgres_connector - INFO - Patient inserted with ID: 100055
2025-05-20 13:18:41,800 - main - INFO - Sample patient inserted successfully
2025-05-20 13:18:41,801 - main - INFO - Verified patient in database: ID=100055, UUID=4ba8392f-5234-4b92-add3-9896c10a8a0a, Document=Иностранный паспорт #729293908
2025-05-20 13:18:41,801 - src.connectors.postgres_connector - INFO - Disconnected from PostgreSQL
2025-05-20 13:18:41,801 - main - INFO - Testing patient fetch and import from Firebird to PostgreSQL...
2025-05-20 13:18:41,802 - src.connectors.firebird_connector - INFO - Testing TCP connectivity to 192.168.160.168:3050
2025-05-20 13:18:41,802 - src.connectors.firebird_connector - INFO - TCP connection to 192.168.160.168:3050 successful
2025-05-20 13:18:41,802 - src.connectors.firebird_connector - INFO - Using previously registered Firebird configuration
2025-05-20 13:18:41,802 - src.connectors.firebird_connector - INFO - Attempting to connect to Firebird at 192.168.160.168:3050, database: 099-1
2025-05-20 13:18:41,838 - src.connectors.firebird_connector - INFO - Connected to Firebird using firebird-driver
2025-05-20 13:18:41,852 - src.connectors.postgres_connector - INFO - Connected to PostgreSQL
2025-05-20 13:18:41,852 - main - ERROR - Error during patient import: 'FirebirdConnector' object has no attribute 'fetch_patients'
2025-05-20 13:18:41,855 - src.connectors.firebird_connector - INFO - Disconnected from Firebird
2025-05-20 13:18:41,855 - src.connectors.postgres_connector - INFO - Disconnected from PostgreSQL
2025-05-20 13:18:41,855 - src.connectors.firebird_connector - INFO - Testing TCP connectivity to 192.168.160.168:3050
2025-05-20 13:18:41,856 - src.connectors.firebird_connector - INFO - TCP connection to 192.168.160.168:3050 successful
2025-05-20 13:18:41,856 - src.connectors.firebird_connector - INFO - Using previously registered Firebird configuration
2025-05-20 13:18:41,856 - src.connectors.firebird_connector - INFO - Attempting to connect to Firebird at 192.168.160.168:3050, database: 099-1
2025-05-20 13:18:41,910 - src.connectors.firebird_connector - INFO - Connected to Firebird using firebird-driver
2025-05-20 13:18:41,926 - src.connectors.postgres_connector - INFO - Connected to PostgreSQL
2025-05-20 13:18:41,926 - src.etl.etl_service - INFO - Extracting up to 10 patients from Firebird
2025-05-20 13:18:41,952 - src.repositories.firebird_repository - INFO - Retrieved 10 patients from Firebird
2025-05-20 13:18:41,952 - src.etl.etl_service - INFO - Transforming 10 patients
2025-05-20 13:18:41,953 - src.etl.etl_service - INFO - Loading 10 patients into PostgreSQL
2025-05-20 13:18:41,960 - src.repositories.postgres_repository - ERROR - Error inserting patient: ОШИБКА:  повторяющееся значение ключа нарушает ограничение уникальности "unique_hisnumber_source"
DETAIL:  Ключ "(hisnumber, source)=(10000233, 2)" уже существует.

2025-05-20 13:18:41,962 - src.repositories.postgres_repository - ERROR - Error inserting patient: ОШИБКА:  повторяющееся значение ключа нарушает ограничение уникальности "unique_hisnumber_source"
DETAIL:  Ключ "(hisnumber, source)=(15678, 2)" уже существует.

2025-05-20 13:18:41,964 - src.repositories.postgres_repository - ERROR - Error inserting patient: ОШИБКА:  повторяющееся значение ключа нарушает ограничение уникальности "unique_hisnumber_source"
DETAIL:  Ключ "(hisnumber, source)=(10000001, 2)" уже существует.

2025-05-20 13:18:41,966 - src.repositories.postgres_repository - ERROR - Error inserting patient: ОШИБКА:  повторяющееся значение ключа нарушает ограничение уникальности "unique_hisnumber_source"
DETAIL:  Ключ "(hisnumber, source)=(15631, 2)" уже существует.

2025-05-20 13:18:41,968 - src.repositories.postgres_repository - ERROR - Error inserting patient: ОШИБКА:  повторяющееся значение ключа нарушает ограничение уникальности "unique_hisnumber_source"
DETAIL:  Ключ "(hisnumber, source)=(1117479, 2)" уже существует.

2025-05-20 13:18:41,969 - src.repositories.postgres_repository - ERROR - Error inserting patient: ОШИБКА:  повторяющееся значение ключа нарушает ограничение уникальности "unique_hisnumber_source"
DETAIL:  Ключ "(hisnumber, source)=(10000072, 2)" уже существует.

2025-05-20 13:18:41,970 - src.repositories.postgres_repository - ERROR - Error inserting patient: ОШИБКА:  повторяющееся значение ключа нарушает ограничение уникальности "unique_hisnumber_source"
DETAIL:  Ключ "(hisnumber, source)=(40003556, 2)" уже существует.

2025-05-20 13:18:41,970 - src.repositories.postgres_repository - ERROR - Error inserting patient: ОШИБКА:  повторяющееся значение ключа нарушает ограничение уникальности "unique_hisnumber_source"
DETAIL:  Ключ "(hisnumber, source)=(10000609, 2)" уже существует.

2025-05-20 13:18:41,971 - src.repositories.postgres_repository - ERROR - Error inserting patient: ОШИБКА:  повторяющееся значение ключа нарушает ограничение уникальности "unique_hisnumber_source"
DETAIL:  Ключ "(hisnumber, source)=(10000556, 2)" уже существует.

2025-05-20 13:18:41,972 - src.repositories.postgres_repository - ERROR - Error inserting patient: ОШИБКА:  повторяющееся значение ключа нарушает ограничение уникальности "unique_hisnumber_source"
DETAIL:  Ключ "(hisnumber, source)=(122548, 2)" уже существует.

2025-05-20 13:18:41,972 - src.etl.etl_service - INFO - ETL complete: 0/10 patients processed successfully
2025-05-20 13:18:41,977 - src.connectors.firebird_connector - INFO - Disconnected from Firebird
2025-05-20 13:18:41,977 - src.connectors.postgres_connector - INFO - Disconnected from PostgreSQL
2025-05-20 13:18:41,977 - main - INFO - 
Test Results Summary:
2025-05-20 13:18:41,978 - main - INFO - PostgreSQL Connection: ✓
2025-05-20 13:18:41,978 - main - INFO - Firebird Connection: ✓
2025-05-20 13:18:41,978 - main - INFO - YottaDB Connection: ✗
2025-05-20 13:18:41,978 - main - INFO - PostgreSQL Schema: ✓
2025-05-20 13:18:41,979 - main - INFO - Document Type Handling: ✓
2025-05-20 13:18:41,979 - main - INFO - Patient Insertion: ✓
2025-05-20 13:18:41,979 - main - INFO - Firebird Import: ✗
2025-05-20 13:18:41,979 - main - INFO - ETL Process: ✗
2025-05-20 13:18:41,979 - main - INFO - 
Tests completed.
2025-05-20 13:22:47,233 - main - INFO - Starting tests...
2025-05-20 13:22:47,234 - main - INFO - Testing PostgreSQL connection...
2025-05-20 13:22:47,247 - src.connectors.postgres_connector - INFO - Connected to PostgreSQL
2025-05-20 13:22:47,247 - main - INFO - PostgreSQL connection successful
2025-05-20 13:22:47,248 - main - INFO - PostgreSQL version: PostgreSQL 15.12 (Debian 15.12-0+deb12u2) on x86_64-pc-linux-gnu, compiled by gcc (Debian 12.2.0-14) 12.2.0, 64-bit
2025-05-20 13:22:47,248 - src.connectors.postgres_connector - INFO - Disconnected from PostgreSQL
2025-05-20 13:22:47,248 - main - INFO - Testing Firebird connection...
2025-05-20 13:22:47,248 - main - INFO - Firebird config: {'host': '192.168.160.168:3050', 'database': '099-1', 'user': 'SYSDBA', 'password': 'masterkey', 'charset': 'UTF-8', 'debug': False}
2025-05-20 13:22:47,248 - src.connectors.firebird_connector - INFO - Testing TCP connectivity to 192.168.160.168:3050
2025-05-20 13:22:47,249 - src.connectors.firebird_connector - INFO - TCP connection to 192.168.160.168:3050 successful
2025-05-20 13:22:47,250 - src.connectors.firebird_connector - INFO - Registered Firebird server and database configurations
2025-05-20 13:22:47,250 - src.connectors.firebird_connector - INFO - Attempting to connect to Firebird at 192.168.160.168:3050, database: 099-1
2025-05-20 13:22:47,304 - src.connectors.firebird_connector - INFO - Connected to Firebird using firebird-driver
2025-05-20 13:22:47,304 - main - INFO - Firebird connection successful
2025-05-20 13:22:47,310 - main - INFO - Firebird current time: 2025-05-20 13:22:47.308000
2025-05-20 13:22:47,318 - src.repositories.firebird_repository - INFO - Retrieved 3 patients from Firebird
2025-05-20 13:22:47,319 - main - INFO - Retrieved 3 patients from Firebird through repository
2025-05-20 13:22:47,319 - main - INFO - Patient 1: Проверочный Иван
2025-05-20 13:22:47,319 - main - INFO - Patient 2: Петровский Василий
2025-05-20 13:22:47,329 - src.connectors.firebird_connector - INFO - Disconnected from Firebird
2025-05-20 13:22:47,330 - main - INFO - Testing YottaDB connection...
2025-05-20 13:22:47,330 - main - ERROR - YottaDB connection failed
2025-05-20 13:22:47,330 - main - INFO - Testing PostgreSQL schema...
2025-05-20 13:22:47,364 - src.connectors.postgres_connector - INFO - Connected to PostgreSQL
2025-05-20 13:22:47,369 - main - INFO - All essential tables exist
2025-05-20 13:22:47,370 - main - INFO - Found 2 HIS systems in hislist table
2025-05-20 13:22:47,370 - main - INFO -   hislist entry: (1, 'qMS')
2025-05-20 13:22:47,370 - main - INFO -   hislist entry: (2, 'Инфоклиника')
2025-05-20 13:22:47,371 - main - INFO - Found 3 business units in businessunits table
2025-05-20 13:22:47,372 - main - INFO -   businessunits entry: (1, 'ОО ФК "Хадасса Медикал ЛТД"')
2025-05-20 13:22:47,372 - main - INFO -   businessunits entry: (2, 'ООО "Медскан"')
2025-05-20 13:22:47,372 - main - INFO -   businessunits entry: (3, 'ООО "Клинический госпиталь на Яузе"')
2025-05-20 13:22:47,372 - main - INFO - Found 17 document types in documenttypes table
2025-05-20 13:22:47,373 - main - INFO -   documenttypes entry: (1, 'Паспорт')
2025-05-20 13:22:47,373 - main - INFO -   documenttypes entry: (2, 'Паспорт СССР')
2025-05-20 13:22:47,373 - main - INFO -   documenttypes entry: (3, 'Заграничный паспорт РФ')
2025-05-20 13:22:47,373 - main - INFO -   documenttypes entry: (4, 'Заграничный паспорт СССР')
2025-05-20 13:22:47,373 - main - INFO -   documenttypes entry: (5, 'Свидетельство о рождении')
2025-05-20 13:22:47,373 - src.connectors.postgres_connector - INFO - Disconnected from PostgreSQL
2025-05-20 13:22:47,374 - main - INFO - Testing document type handling...
2025-05-20 13:22:47,387 - src.connectors.postgres_connector - INFO - Connected to PostgreSQL
2025-05-20 13:22:47,395 - src.repositories.postgres_repository - INFO - Patient inserted with ID: 100066
2025-05-20 13:22:47,396 - main - INFO - Inserted patient with Паспорт (ID: 1), number: 2509406959
2025-05-20 13:22:47,398 - src.repositories.postgres_repository - INFO - Patient inserted with ID: 100067
2025-05-20 13:22:47,398 - main - INFO - Inserted patient with Заграничный паспорт РФ (ID: 3), number: 376974257
2025-05-20 13:22:47,400 - src.repositories.postgres_repository - INFO - Patient inserted with ID: 100068
2025-05-20 13:22:47,400 - main - INFO - Inserted patient with Свидетельство о рождении (ID: 5), number: 801771193599
2025-05-20 13:22:47,403 - src.repositories.postgres_repository - INFO - Patient inserted with ID: 100069
2025-05-20 13:22:47,404 - main - INFO - Inserted patient with Иностранный паспорт (ID: 10), number: 181098465
2025-05-20 13:22:47,406 - src.repositories.postgres_repository - INFO - Patient inserted with ID: 100070
2025-05-20 13:22:47,406 - main - INFO - Inserted patient with Временное удостоверение (ID: 14), number: 28290534
2025-05-20 13:22:47,410 - src.repositories.postgres_repository - INFO - Patient inserted with ID: 100071
2025-05-20 13:22:47,410 - main - INFO - Inserted patient with Иные документы (ID: 17), number: 53443969
2025-05-20 13:22:47,410 - main - INFO - Successfully inserted 6 out of 6 test patients with different document types
2025-05-20 13:22:47,410 - src.connectors.postgres_connector - INFO - Disconnected from PostgreSQL
2025-05-20 13:22:47,411 - main - INFO - Testing ETL process with the repository-transformer architecture...
2025-05-20 13:22:47,411 - src.connectors.firebird_connector - INFO - Testing TCP connectivity to 192.168.160.168:3050
2025-05-20 13:22:47,411 - src.connectors.firebird_connector - INFO - TCP connection to 192.168.160.168:3050 successful
2025-05-20 13:22:47,411 - src.connectors.firebird_connector - INFO - Using previously registered Firebird configuration
2025-05-20 13:22:47,411 - src.connectors.firebird_connector - INFO - Attempting to connect to Firebird at 192.168.160.168:3050, database: 099-1
2025-05-20 13:22:47,466 - src.connectors.firebird_connector - INFO - Connected to Firebird using firebird-driver
2025-05-20 13:22:47,488 - src.connectors.postgres_connector - INFO - Connected to PostgreSQL
2025-05-20 13:22:47,488 - main - INFO - Processing 10 patients through ETL
2025-05-20 13:22:47,488 - src.etl.etl_service - INFO - Extracting up to 10 patients from Firebird
2025-05-20 13:22:47,502 - src.repositories.firebird_repository - INFO - Retrieved 10 patients from Firebird
2025-05-20 13:22:47,502 - src.etl.etl_service - INFO - Transforming 10 patients
2025-05-20 13:22:47,502 - src.etl.etl_service - INFO - Loading 10 patients into PostgreSQL
2025-05-20 13:22:47,510 - src.repositories.postgres_repository - ERROR - Error inserting patient: ОШИБКА:  повторяющееся значение ключа нарушает ограничение уникальности "unique_hisnumber_source"
DETAIL:  Ключ "(hisnumber, source)=(10000233, 2)" уже существует.

2025-05-20 13:22:47,511 - src.repositories.postgres_repository - ERROR - Error inserting patient: ОШИБКА:  повторяющееся значение ключа нарушает ограничение уникальности "unique_hisnumber_source"
DETAIL:  Ключ "(hisnumber, source)=(15678, 2)" уже существует.

2025-05-20 13:22:47,513 - src.repositories.postgres_repository - ERROR - Error inserting patient: ОШИБКА:  повторяющееся значение ключа нарушает ограничение уникальности "unique_hisnumber_source"
DETAIL:  Ключ "(hisnumber, source)=(10000001, 2)" уже существует.

2025-05-20 13:22:47,514 - src.repositories.postgres_repository - ERROR - Error inserting patient: ОШИБКА:  повторяющееся значение ключа нарушает ограничение уникальности "unique_hisnumber_source"
DETAIL:  Ключ "(hisnumber, source)=(15631, 2)" уже существует.

2025-05-20 13:22:47,515 - src.repositories.postgres_repository - ERROR - Error inserting patient: ОШИБКА:  повторяющееся значение ключа нарушает ограничение уникальности "unique_hisnumber_source"
DETAIL:  Ключ "(hisnumber, source)=(1117479, 2)" уже существует.

2025-05-20 13:22:47,516 - src.repositories.postgres_repository - ERROR - Error inserting patient: ОШИБКА:  повторяющееся значение ключа нарушает ограничение уникальности "unique_hisnumber_source"
DETAIL:  Ключ "(hisnumber, source)=(10000072, 2)" уже существует.

2025-05-20 13:22:47,517 - src.repositories.postgres_repository - ERROR - Error inserting patient: ОШИБКА:  повторяющееся значение ключа нарушает ограничение уникальности "unique_hisnumber_source"
DETAIL:  Ключ "(hisnumber, source)=(40003556, 2)" уже существует.

2025-05-20 13:22:47,517 - src.repositories.postgres_repository - ERROR - Error inserting patient: ОШИБКА:  повторяющееся значение ключа нарушает ограничение уникальности "unique_hisnumber_source"
DETAIL:  Ключ "(hisnumber, source)=(10000609, 2)" уже существует.

2025-05-20 13:22:47,518 - src.repositories.postgres_repository - ERROR - Error inserting patient: ОШИБКА:  повторяющееся значение ключа нарушает ограничение уникальности "unique_hisnumber_source"
DETAIL:  Ключ "(hisnumber, source)=(10000556, 2)" уже существует.

2025-05-20 13:22:47,519 - src.repositories.postgres_repository - ERROR - Error inserting patient: ОШИБКА:  повторяющееся значение ключа нарушает ограничение уникальности "unique_hisnumber_source"
DETAIL:  Ключ "(hisnumber, source)=(122548, 2)" уже существует.

2025-05-20 13:22:47,519 - src.etl.etl_service - INFO - ETL complete: 0/10 patients processed successfully
2025-05-20 13:22:47,519 - main - INFO - ETL processed 0 patients successfully
2025-05-20 13:22:47,519 - main - WARNING - ETL process test completed but no records were processed
2025-05-20 13:22:47,523 - src.connectors.firebird_connector - INFO - Disconnected from Firebird
2025-05-20 13:22:47,524 - src.connectors.postgres_connector - INFO - Disconnected from PostgreSQL
2025-05-20 13:22:47,524 - main - INFO - 
Test Results Summary:
2025-05-20 13:22:47,524 - main - INFO - PostgreSQL Connection: ✓
2025-05-20 13:22:47,524 - main - INFO - Firebird Connection: ✓
2025-05-20 13:22:47,524 - main - INFO - YottaDB Connection: ✗
2025-05-20 13:22:47,524 - main - INFO - PostgreSQL Schema: ✓
2025-05-20 13:22:47,524 - main - INFO - Document Type Handling: ✓
2025-05-20 13:22:47,524 - main - INFO - ETL Process: ✗
2025-05-20 13:22:47,524 - main - INFO - 
Tests completed.
2025-05-20 14:04:09,399 - main - INFO - Starting tests...
2025-05-20 14:04:09,399 - main - INFO - Testing PostgreSQL connection...
2025-05-20 14:04:09,411 - src.connectors.postgres_connector - INFO - Connected to PostgreSQL
2025-05-20 14:04:09,411 - main - INFO - PostgreSQL connection successful
2025-05-20 14:04:09,412 - main - INFO - PostgreSQL version: PostgreSQL 15.12 (Debian 15.12-0+deb12u2) on x86_64-pc-linux-gnu, compiled by gcc (Debian 12.2.0-14) 12.2.0, 64-bit
2025-05-20 14:04:09,412 - src.connectors.postgres_connector - INFO - Disconnected from PostgreSQL
2025-05-20 14:04:09,412 - main - INFO - Testing Firebird connection...
2025-05-20 14:04:09,412 - main - INFO - Firebird config: {'host': '192.168.160.168:3050', 'database': '099-1', 'user': 'SYSDBA', 'password': 'masterkey', 'charset': 'UTF-8', 'debug': False}
2025-05-20 14:04:09,412 - src.connectors.firebird_connector - INFO - Testing TCP connectivity to 192.168.160.168:3050
2025-05-20 14:04:09,413 - src.connectors.firebird_connector - INFO - TCP connection to 192.168.160.168:3050 successful
2025-05-20 14:04:09,415 - src.connectors.firebird_connector - INFO - Registered Firebird server and database configurations
2025-05-20 14:04:09,415 - src.connectors.firebird_connector - INFO - Attempting to connect to Firebird at 192.168.160.168:3050, database: 099-1
2025-05-20 14:04:09,465 - src.connectors.firebird_connector - INFO - Connected to Firebird using firebird-driver
2025-05-20 14:04:09,465 - main - INFO - Firebird connection successful
2025-05-20 14:04:09,473 - main - INFO - Firebird current time: 2025-05-20 14:04:09.466000
2025-05-20 14:04:09,485 - src.repositories.firebird_repository - INFO - Retrieved 3 patients from Firebird
2025-05-20 14:04:09,486 - main - INFO - Retrieved 3 patients from Firebird through repository
2025-05-20 14:04:09,486 - main - INFO - Patient 1: Проверочный Иван
2025-05-20 14:04:09,486 - main - INFO - Patient 2: Петровский Василий
2025-05-20 14:04:09,490 - src.connectors.firebird_connector - INFO - Disconnected from Firebird
2025-05-20 14:04:09,491 - main - INFO - Testing YottaDB connection...
2025-05-20 14:04:09,491 - main - ERROR - YottaDB connection failed
2025-05-20 14:04:09,491 - main - INFO - Testing PostgreSQL schema...
2025-05-20 14:04:09,510 - src.connectors.postgres_connector - INFO - Connected to PostgreSQL
2025-05-20 14:04:09,516 - main - INFO - All essential tables exist
2025-05-20 14:04:09,517 - main - INFO - Found 2 HIS systems in hislist table
2025-05-20 14:04:09,517 - main - INFO -   hislist entry: (1, 'qMS')
2025-05-20 14:04:09,517 - main - INFO -   hislist entry: (2, 'Инфоклиника')
2025-05-20 14:04:09,517 - main - INFO - Found 3 business units in businessunits table
2025-05-20 14:04:09,518 - main - INFO -   businessunits entry: (1, 'ОО ФК "Хадасса Медикал ЛТД"')
2025-05-20 14:04:09,518 - main - INFO -   businessunits entry: (2, 'ООО "Медскан"')
2025-05-20 14:04:09,518 - main - INFO -   businessunits entry: (3, 'ООО "Клинический госпиталь на Яузе"')
2025-05-20 14:04:09,518 - main - INFO - Found 17 document types in documenttypes table
2025-05-20 14:04:09,518 - main - INFO -   documenttypes entry: (1, 'Паспорт')
2025-05-20 14:04:09,518 - main - INFO -   documenttypes entry: (2, 'Паспорт СССР')
2025-05-20 14:04:09,518 - main - INFO -   documenttypes entry: (3, 'Заграничный паспорт РФ')
2025-05-20 14:04:09,518 - main - INFO -   documenttypes entry: (4, 'Заграничный паспорт СССР')
2025-05-20 14:04:09,518 - main - INFO -   documenttypes entry: (5, 'Свидетельство о рождении')
2025-05-20 14:04:09,519 - src.connectors.postgres_connector - INFO - Disconnected from PostgreSQL
2025-05-20 14:04:09,519 - main - INFO - Testing document type handling...
2025-05-20 14:04:09,530 - src.connectors.postgres_connector - INFO - Connected to PostgreSQL
2025-05-20 14:04:09,540 - src.repositories.postgres_repository - INFO - Patient inserted with ID: 100082
2025-05-20 14:04:09,541 - main - INFO - Inserted patient with Паспорт (ID: 1), number: 1319523923
2025-05-20 14:04:09,542 - src.repositories.postgres_repository - INFO - Patient inserted with ID: 100083
2025-05-20 14:04:09,542 - main - INFO - Inserted patient with Заграничный паспорт РФ (ID: 3), number: 351077357
2025-05-20 14:04:09,544 - src.repositories.postgres_repository - INFO - Patient inserted with ID: 100084
2025-05-20 14:04:09,544 - main - INFO - Inserted patient with Свидетельство о рождении (ID: 5), number: 669070786809
2025-05-20 14:04:09,545 - src.repositories.postgres_repository - INFO - Patient inserted with ID: 100085
2025-05-20 14:04:09,545 - main - INFO - Inserted patient with Иностранный паспорт (ID: 10), number: 686995713
2025-05-20 14:04:09,546 - src.repositories.postgres_repository - INFO - Patient inserted with ID: 100086
2025-05-20 14:04:09,546 - main - INFO - Inserted patient with Временное удостоверение (ID: 14), number: 71802573
2025-05-20 14:04:09,548 - src.repositories.postgres_repository - INFO - Patient inserted with ID: 100087
2025-05-20 14:04:09,548 - main - INFO - Inserted patient with Иные документы (ID: 17), number: 39526803
2025-05-20 14:04:09,548 - main - INFO - Successfully inserted 6 out of 6 test patients with different document types
2025-05-20 14:04:09,549 - src.connectors.postgres_connector - INFO - Disconnected from PostgreSQL
2025-05-20 14:04:09,549 - main - INFO - Testing ETL process with the repository-transformer architecture...
2025-05-20 14:04:09,549 - src.connectors.firebird_connector - INFO - Testing TCP connectivity to 192.168.160.168:3050
2025-05-20 14:04:09,549 - src.connectors.firebird_connector - INFO - TCP connection to 192.168.160.168:3050 successful
2025-05-20 14:04:09,550 - src.connectors.firebird_connector - INFO - Using previously registered Firebird configuration
2025-05-20 14:04:09,550 - src.connectors.firebird_connector - INFO - Attempting to connect to Firebird at 192.168.160.168:3050, database: 099-1
2025-05-20 14:04:09,590 - src.connectors.firebird_connector - INFO - Connected to Firebird using firebird-driver
2025-05-20 14:04:09,604 - src.connectors.postgres_connector - INFO - Connected to PostgreSQL
2025-05-20 14:04:09,604 - main - INFO - Processing 10 patients through ETL
2025-05-20 14:04:09,604 - src.etl.etl_service - INFO - Extracting up to 10 patients from Firebird
2025-05-20 14:04:09,618 - src.repositories.firebird_repository - INFO - Retrieved 10 patients from Firebird
2025-05-20 14:04:09,618 - src.etl.etl_service - INFO - Transforming 10 patients
2025-05-20 14:04:09,619 - src.etl.etl_service - INFO - Loading 10 patients into PostgreSQL
2025-05-20 14:04:09,624 - src.repositories.postgres_repository - INFO - Patient inserted with ID: 100088
2025-05-20 14:04:09,627 - src.repositories.postgres_repository - INFO - Patient inserted with ID: 100089
2025-05-20 14:04:09,629 - src.repositories.postgres_repository - INFO - Patient inserted with ID: 100090
2025-05-20 14:04:09,631 - src.repositories.postgres_repository - INFO - Patient inserted with ID: 100091
2025-05-20 14:04:09,632 - src.repositories.postgres_repository - INFO - Patient inserted with ID: 100092
2025-05-20 14:04:09,634 - src.repositories.postgres_repository - INFO - Patient inserted with ID: 100093
2025-05-20 14:04:09,635 - src.repositories.postgres_repository - INFO - Patient inserted with ID: 100094
2025-05-20 14:04:09,637 - src.repositories.postgres_repository - INFO - Patient inserted with ID: 100095
2025-05-20 14:04:09,638 - src.repositories.postgres_repository - INFO - Patient inserted with ID: 100096
2025-05-20 14:04:09,639 - src.repositories.postgres_repository - INFO - Patient inserted with ID: 100097
2025-05-20 14:04:09,639 - src.etl.etl_service - INFO - ETL complete: 10/10 patients processed successfully
2025-05-20 14:04:09,639 - main - INFO - ETL processed 10 patients successfully
2025-05-20 14:04:09,639 - main - INFO - ETL process test successful
2025-05-20 14:04:09,647 - src.connectors.firebird_connector - INFO - Disconnected from Firebird
2025-05-20 14:04:09,647 - src.connectors.postgres_connector - INFO - Disconnected from PostgreSQL
2025-05-20 14:04:09,647 - main - INFO - 
Test Results Summary:
2025-05-20 14:04:09,648 - main - INFO - PostgreSQL Connection: ✓
2025-05-20 14:04:09,648 - main - INFO - Firebird Connection: ✓
2025-05-20 14:04:09,648 - main - INFO - YottaDB Connection: ✗
2025-05-20 14:04:09,648 - main - INFO - PostgreSQL Schema: ✓
2025-05-20 14:04:09,648 - main - INFO - Document Type Handling: ✓
2025-05-20 14:04:09,648 - main - INFO - ETL Process: ✓
2025-05-20 14:04:09,648 - main - INFO - 
Tests completed.
2025-05-20 14:07:37,164 - main - INFO - Starting tests...
2025-05-20 14:07:37,164 - main - INFO - Testing PostgreSQL connection...
2025-05-20 14:07:37,176 - src.connectors.postgres_connector - INFO - Connected to PostgreSQL
2025-05-20 14:07:37,176 - main - INFO - PostgreSQL connection successful
2025-05-20 14:07:37,177 - main - INFO - PostgreSQL version: PostgreSQL 15.12 (Debian 15.12-0+deb12u2) on x86_64-pc-linux-gnu, compiled by gcc (Debian 12.2.0-14) 12.2.0, 64-bit
2025-05-20 14:07:37,177 - src.connectors.postgres_connector - INFO - Disconnected from PostgreSQL
2025-05-20 14:07:37,177 - main - INFO - Testing Firebird connection...
2025-05-20 14:07:37,177 - main - INFO - Firebird config: {'host': '192.168.160.168:3050', 'database': '099-1', 'user': 'SYSDBA', 'password': 'masterkey', 'charset': 'UTF-8', 'debug': False}
2025-05-20 14:07:37,177 - src.connectors.firebird_connector - INFO - Testing TCP connectivity to 192.168.160.168:3050
2025-05-20 14:07:37,178 - src.connectors.firebird_connector - INFO - TCP connection to 192.168.160.168:3050 successful
2025-05-20 14:07:37,179 - src.connectors.firebird_connector - INFO - Registered Firebird server and database configurations
2025-05-20 14:07:37,179 - src.connectors.firebird_connector - INFO - Attempting to connect to Firebird at 192.168.160.168:3050, database: 099-1
2025-05-20 14:07:37,234 - src.connectors.firebird_connector - INFO - Connected to Firebird using firebird-driver
2025-05-20 14:07:37,234 - main - INFO - Firebird connection successful
2025-05-20 14:07:37,240 - main - INFO - Firebird current time: 2025-05-20 14:07:37.241000
2025-05-20 14:07:37,256 - src.repositories.firebird_repository - INFO - Retrieved 3 patients from Firebird
2025-05-20 14:07:37,256 - main - INFO - Retrieved 3 patients from Firebird through repository
2025-05-20 14:07:37,256 - main - INFO - Patient 1: Проверочный Иван
2025-05-20 14:07:37,256 - main - INFO - Patient 2: Петровский Василий
2025-05-20 14:07:37,260 - src.connectors.firebird_connector - INFO - Disconnected from Firebird
2025-05-20 14:07:37,260 - main - INFO - Testing YottaDB connection...
2025-05-20 14:07:37,260 - main - ERROR - YottaDB connection failed
2025-05-20 14:07:37,260 - main - INFO - Testing PostgreSQL schema...
2025-05-20 14:07:37,275 - src.connectors.postgres_connector - INFO - Connected to PostgreSQL
2025-05-20 14:07:37,280 - main - INFO - All essential tables exist
2025-05-20 14:07:37,281 - main - INFO - Found 2 HIS systems in hislist table
2025-05-20 14:07:37,281 - main - INFO -   hislist entry: (1, 'qMS')
2025-05-20 14:07:37,281 - main - INFO -   hislist entry: (2, 'Инфоклиника')
2025-05-20 14:07:37,281 - main - INFO - Found 3 business units in businessunits table
2025-05-20 14:07:37,282 - main - INFO -   businessunits entry: (1, 'ОО ФК "Хадасса Медикал ЛТД"')
2025-05-20 14:07:37,282 - main - INFO -   businessunits entry: (2, 'ООО "Медскан"')
2025-05-20 14:07:37,282 - main - INFO -   businessunits entry: (3, 'ООО "Клинический госпиталь на Яузе"')
2025-05-20 14:07:37,282 - main - INFO - Found 17 document types in documenttypes table
2025-05-20 14:07:37,282 - main - INFO -   documenttypes entry: (1, 'Паспорт')
2025-05-20 14:07:37,282 - main - INFO -   documenttypes entry: (2, 'Паспорт СССР')
2025-05-20 14:07:37,283 - main - INFO -   documenttypes entry: (3, 'Заграничный паспорт РФ')
2025-05-20 14:07:37,283 - main - INFO -   documenttypes entry: (4, 'Заграничный паспорт СССР')
2025-05-20 14:07:37,283 - main - INFO -   documenttypes entry: (5, 'Свидетельство о рождении')
2025-05-20 14:07:37,283 - src.connectors.postgres_connector - INFO - Disconnected from PostgreSQL
2025-05-20 14:07:37,283 - main - INFO - Testing document type handling...
2025-05-20 14:07:37,297 - src.connectors.postgres_connector - INFO - Connected to PostgreSQL
2025-05-20 14:07:37,308 - src.repositories.postgres_repository - INFO - Patient inserted with ID: 100098
2025-05-20 14:07:37,308 - main - INFO - Inserted patient with Паспорт (ID: 1), number: 5446594390
2025-05-20 14:07:37,311 - src.repositories.postgres_repository - INFO - Patient inserted with ID: 100099
2025-05-20 14:07:37,311 - main - INFO - Inserted patient with Заграничный паспорт РФ (ID: 3), number: 583628617
2025-05-20 14:07:37,312 - src.repositories.postgres_repository - INFO - Patient inserted with ID: 100100
2025-05-20 14:07:37,312 - main - INFO - Inserted patient with Свидетельство о рождении (ID: 5), number: 131529439160
2025-05-20 14:07:37,314 - src.repositories.postgres_repository - INFO - Patient inserted with ID: 100101
2025-05-20 14:07:37,315 - main - INFO - Inserted patient with Иностранный паспорт (ID: 10), number: 685983828
2025-05-20 14:07:37,320 - src.repositories.postgres_repository - INFO - Patient inserted with ID: 100102
2025-05-20 14:07:37,320 - main - INFO - Inserted patient with Временное удостоверение (ID: 14), number: 24342317
2025-05-20 14:07:37,321 - src.repositories.postgres_repository - INFO - Patient inserted with ID: 100103
2025-05-20 14:07:37,321 - main - INFO - Inserted patient with Иные документы (ID: 17), number: 90462098
2025-05-20 14:07:37,321 - main - INFO - Successfully inserted 6 out of 6 test patients with different document types
2025-05-20 14:07:37,322 - src.connectors.postgres_connector - INFO - Disconnected from PostgreSQL
2025-05-20 14:07:37,322 - main - INFO - Testing ETL process with the repository-transformer architecture...
2025-05-20 14:07:37,322 - src.connectors.firebird_connector - INFO - Testing TCP connectivity to 192.168.160.168:3050
2025-05-20 14:07:37,322 - src.connectors.firebird_connector - INFO - TCP connection to 192.168.160.168:3050 successful
2025-05-20 14:07:37,322 - src.connectors.firebird_connector - INFO - Using previously registered Firebird configuration
2025-05-20 14:07:37,322 - src.connectors.firebird_connector - INFO - Attempting to connect to Firebird at 192.168.160.168:3050, database: 099-1
2025-05-20 14:07:37,372 - src.connectors.firebird_connector - INFO - Connected to Firebird using firebird-driver
2025-05-20 14:07:37,384 - src.connectors.postgres_connector - INFO - Connected to PostgreSQL
2025-05-20 14:07:37,384 - main - INFO - Processing 10 patients through ETL
2025-05-20 14:07:37,384 - src.etl.etl_service - INFO - Extracting up to 10 patients from Firebird
2025-05-20 14:07:37,406 - src.repositories.firebird_repository - INFO - Retrieved 10 patients from Firebird
2025-05-20 14:07:37,406 - src.etl.etl_service - INFO - Transforming 10 patients
2025-05-20 14:07:37,406 - src.etl.etl_service - INFO - Loading 10 patients into PostgreSQL
2025-05-20 14:07:37,410 - src.repositories.postgres_repository - ERROR - Error inserting patient: ОШИБКА:  повторяющееся значение ключа нарушает ограничение уникальности "unique_hisnumber_source"
DETAIL:  Ключ "(hisnumber, source)=(10000233, 2)" уже существует.

2025-05-20 14:07:37,411 - src.repositories.postgres_repository - ERROR - Error inserting patient: ОШИБКА:  повторяющееся значение ключа нарушает ограничение уникальности "unique_hisnumber_source"
DETAIL:  Ключ "(hisnumber, source)=(15678, 2)" уже существует.

2025-05-20 14:07:37,412 - src.repositories.postgres_repository - ERROR - Error inserting patient: ОШИБКА:  повторяющееся значение ключа нарушает ограничение уникальности "unique_hisnumber_source"
DETAIL:  Ключ "(hisnumber, source)=(10000001, 2)" уже существует.

2025-05-20 14:07:37,413 - src.repositories.postgres_repository - ERROR - Error inserting patient: ОШИБКА:  повторяющееся значение ключа нарушает ограничение уникальности "unique_hisnumber_source"
DETAIL:  Ключ "(hisnumber, source)=(15631, 2)" уже существует.

2025-05-20 14:07:37,413 - src.repositories.postgres_repository - ERROR - Error inserting patient: ОШИБКА:  повторяющееся значение ключа нарушает ограничение уникальности "unique_hisnumber_source"
DETAIL:  Ключ "(hisnumber, source)=(1117479, 2)" уже существует.

2025-05-20 14:07:37,414 - src.repositories.postgres_repository - ERROR - Error inserting patient: ОШИБКА:  повторяющееся значение ключа нарушает ограничение уникальности "unique_hisnumber_source"
DETAIL:  Ключ "(hisnumber, source)=(10000072, 2)" уже существует.

2025-05-20 14:07:37,415 - src.repositories.postgres_repository - ERROR - Error inserting patient: ОШИБКА:  повторяющееся значение ключа нарушает ограничение уникальности "unique_hisnumber_source"
DETAIL:  Ключ "(hisnumber, source)=(40003556, 2)" уже существует.

2025-05-20 14:07:37,416 - src.repositories.postgres_repository - ERROR - Error inserting patient: ОШИБКА:  повторяющееся значение ключа нарушает ограничение уникальности "unique_hisnumber_source"
DETAIL:  Ключ "(hisnumber, source)=(10000609, 2)" уже существует.

2025-05-20 14:07:37,416 - src.repositories.postgres_repository - ERROR - Error inserting patient: ОШИБКА:  повторяющееся значение ключа нарушает ограничение уникальности "unique_hisnumber_source"
DETAIL:  Ключ "(hisnumber, source)=(10000556, 2)" уже существует.

2025-05-20 14:07:37,417 - src.repositories.postgres_repository - ERROR - Error inserting patient: ОШИБКА:  повторяющееся значение ключа нарушает ограничение уникальности "unique_hisnumber_source"
DETAIL:  Ключ "(hisnumber, source)=(122548, 2)" уже существует.

2025-05-20 14:07:37,417 - src.etl.etl_service - INFO - ETL complete: 0/10 patients processed successfully
2025-05-20 14:07:37,417 - main - INFO - ETL processed 0 patients successfully
2025-05-20 14:07:37,417 - main - WARNING - ETL process test completed but no records were processed
2025-05-20 14:07:37,422 - src.connectors.firebird_connector - INFO - Disconnected from Firebird
2025-05-20 14:07:37,423 - src.connectors.postgres_connector - INFO - Disconnected from PostgreSQL
2025-05-20 14:07:37,423 - main - INFO - 
Test Results Summary:
2025-05-20 14:07:37,423 - main - INFO - PostgreSQL Connection: ✓
2025-05-20 14:07:37,423 - main - INFO - Firebird Connection: ✓
2025-05-20 14:07:37,423 - main - INFO - YottaDB Connection: ✗
2025-05-20 14:07:37,423 - main - INFO - PostgreSQL Schema: ✓
2025-05-20 14:07:37,423 - main - INFO - Document Type Handling: ✓
2025-05-20 14:07:37,423 - main - INFO - ETL Process: ✗
2025-05-20 14:07:37,423 - main - INFO - 
Tests completed.
2025-05-20 14:08:09,928 - main - INFO - Starting tests...
2025-05-20 14:08:09,928 - main - INFO - Testing PostgreSQL connection...
2025-05-20 14:08:09,941 - src.connectors.postgres_connector - INFO - Connected to PostgreSQL
2025-05-20 14:08:09,941 - main - INFO - PostgreSQL connection successful
2025-05-20 14:08:09,942 - main - INFO - PostgreSQL version: PostgreSQL 15.12 (Debian 15.12-0+deb12u2) on x86_64-pc-linux-gnu, compiled by gcc (Debian 12.2.0-14) 12.2.0, 64-bit
2025-05-20 14:08:09,942 - src.connectors.postgres_connector - INFO - Disconnected from PostgreSQL
2025-05-20 14:08:09,942 - main - INFO - Testing Firebird connection...
2025-05-20 14:08:09,942 - main - INFO - Firebird config: {'host': '192.168.160.168:3050', 'database': '099-1', 'user': 'SYSDBA', 'password': 'masterkey', 'charset': 'UTF-8', 'debug': False}
2025-05-20 14:08:09,943 - src.connectors.firebird_connector - INFO - Testing TCP connectivity to 192.168.160.168:3050
2025-05-20 14:08:09,943 - src.connectors.firebird_connector - INFO - TCP connection to 192.168.160.168:3050 successful
2025-05-20 14:08:09,944 - src.connectors.firebird_connector - INFO - Registered Firebird server and database configurations
2025-05-20 14:08:09,944 - src.connectors.firebird_connector - INFO - Attempting to connect to Firebird at 192.168.160.168:3050, database: 099-1
2025-05-20 14:08:09,975 - src.connectors.firebird_connector - INFO - Connected to Firebird using firebird-driver
2025-05-20 14:08:09,975 - main - INFO - Firebird connection successful
2025-05-20 14:08:09,981 - main - INFO - Firebird current time: 2025-05-20 14:08:09.976000
2025-05-20 14:08:09,989 - src.repositories.firebird_repository - INFO - Retrieved 3 patients from Firebird
2025-05-20 14:08:09,989 - main - INFO - Retrieved 3 patients from Firebird through repository
2025-05-20 14:08:09,989 - main - INFO - Patient 1: Проверочный Иван
2025-05-20 14:08:09,989 - main - INFO - Patient 2: Петровский Василий
2025-05-20 14:08:09,993 - src.connectors.firebird_connector - INFO - Disconnected from Firebird
2025-05-20 14:08:09,993 - main - INFO - Testing YottaDB connection...
2025-05-20 14:08:09,993 - main - ERROR - YottaDB connection failed
2025-05-20 14:08:09,993 - main - INFO - Testing PostgreSQL schema...
2025-05-20 14:08:10,006 - src.connectors.postgres_connector - INFO - Connected to PostgreSQL
2025-05-20 14:08:10,011 - main - INFO - All essential tables exist
2025-05-20 14:08:10,012 - main - INFO - Found 2 HIS systems in hislist table
2025-05-20 14:08:10,012 - main - INFO -   hislist entry: (1, 'qMS')
2025-05-20 14:08:10,012 - main - INFO -   hislist entry: (2, 'Инфоклиника')
2025-05-20 14:08:10,012 - main - INFO - Found 3 business units in businessunits table
2025-05-20 14:08:10,013 - main - INFO -   businessunits entry: (1, 'ОО ФК "Хадасса Медикал ЛТД"')
2025-05-20 14:08:10,013 - main - INFO -   businessunits entry: (2, 'ООО "Медскан"')
2025-05-20 14:08:10,013 - main - INFO -   businessunits entry: (3, 'ООО "Клинический госпиталь на Яузе"')
2025-05-20 14:08:10,013 - main - INFO - Found 17 document types in documenttypes table
2025-05-20 14:08:10,013 - main - INFO -   documenttypes entry: (1, 'Паспорт')
2025-05-20 14:08:10,013 - main - INFO -   documenttypes entry: (2, 'Паспорт СССР')
2025-05-20 14:08:10,013 - main - INFO -   documenttypes entry: (3, 'Заграничный паспорт РФ')
2025-05-20 14:08:10,013 - main - INFO -   documenttypes entry: (4, 'Заграничный паспорт СССР')
2025-05-20 14:08:10,013 - main - INFO -   documenttypes entry: (5, 'Свидетельство о рождении')
2025-05-20 14:08:10,014 - src.connectors.postgres_connector - INFO - Disconnected from PostgreSQL
2025-05-20 14:08:10,014 - main - INFO - Testing document type handling...
2025-05-20 14:08:10,027 - src.connectors.postgres_connector - INFO - Connected to PostgreSQL
2025-05-20 14:08:10,035 - src.repositories.postgres_repository - INFO - Patient inserted with ID: 100114
2025-05-20 14:08:10,035 - main - INFO - Inserted patient with Паспорт (ID: 1), number: 1034282389
2025-05-20 14:08:10,036 - src.repositories.postgres_repository - INFO - Patient inserted with ID: 100115
2025-05-20 14:08:10,037 - main - INFO - Inserted patient with Заграничный паспорт РФ (ID: 3), number: 564869728
2025-05-20 14:08:10,038 - src.repositories.postgres_repository - INFO - Patient inserted with ID: 100116
2025-05-20 14:08:10,038 - main - INFO - Inserted patient with Свидетельство о рождении (ID: 5), number: 117363068692
2025-05-20 14:08:10,039 - src.repositories.postgres_repository - INFO - Patient inserted with ID: 100117
2025-05-20 14:08:10,039 - main - INFO - Inserted patient with Иностранный паспорт (ID: 10), number: 430182747
2025-05-20 14:08:10,041 - src.repositories.postgres_repository - INFO - Patient inserted with ID: 100118
2025-05-20 14:08:10,041 - main - INFO - Inserted patient with Временное удостоверение (ID: 14), number: 87512448
2025-05-20 14:08:10,042 - src.repositories.postgres_repository - INFO - Patient inserted with ID: 100119
2025-05-20 14:08:10,042 - main - INFO - Inserted patient with Иные документы (ID: 17), number: 28662963
2025-05-20 14:08:10,042 - main - INFO - Successfully inserted 6 out of 6 test patients with different document types
2025-05-20 14:08:10,042 - src.connectors.postgres_connector - INFO - Disconnected from PostgreSQL
2025-05-20 14:08:10,042 - main - INFO - Testing ETL process with the repository-transformer architecture...
2025-05-20 14:08:10,043 - src.connectors.firebird_connector - INFO - Testing TCP connectivity to 192.168.160.168:3050
2025-05-20 14:08:10,043 - src.connectors.firebird_connector - INFO - TCP connection to 192.168.160.168:3050 successful
2025-05-20 14:08:10,043 - src.connectors.firebird_connector - INFO - Using previously registered Firebird configuration
2025-05-20 14:08:10,043 - src.connectors.firebird_connector - INFO - Attempting to connect to Firebird at 192.168.160.168:3050, database: 099-1
2025-05-20 14:08:10,087 - src.connectors.firebird_connector - INFO - Connected to Firebird using firebird-driver
2025-05-20 14:08:10,107 - src.connectors.postgres_connector - INFO - Connected to PostgreSQL
2025-05-20 14:08:10,107 - main - INFO - Processing 10 patients through ETL
2025-05-20 14:08:10,107 - src.etl.etl_service - INFO - Extracting up to 10 patients from Firebird
2025-05-20 14:08:10,121 - src.repositories.firebird_repository - INFO - Retrieved 10 patients from Firebird
2025-05-20 14:08:10,122 - src.etl.etl_service - INFO - Transforming 10 patients
2025-05-20 14:08:10,122 - src.etl.etl_service - INFO - Loading 10 patients into PostgreSQL
2025-05-20 14:08:10,126 - src.repositories.postgres_repository - ERROR - Error inserting patient: ОШИБКА:  повторяющееся значение ключа нарушает ограничение уникальности "unique_hisnumber_source"
DETAIL:  Ключ "(hisnumber, source)=(10000233, 2)" уже существует.

2025-05-20 14:08:10,127 - src.repositories.postgres_repository - ERROR - Error inserting patient: ОШИБКА:  повторяющееся значение ключа нарушает ограничение уникальности "unique_hisnumber_source"
DETAIL:  Ключ "(hisnumber, source)=(15678, 2)" уже существует.

2025-05-20 14:08:10,128 - src.repositories.postgres_repository - ERROR - Error inserting patient: ОШИБКА:  повторяющееся значение ключа нарушает ограничение уникальности "unique_hisnumber_source"
DETAIL:  Ключ "(hisnumber, source)=(10000001, 2)" уже существует.

2025-05-20 14:08:10,129 - src.repositories.postgres_repository - ERROR - Error inserting patient: ОШИБКА:  повторяющееся значение ключа нарушает ограничение уникальности "unique_hisnumber_source"
DETAIL:  Ключ "(hisnumber, source)=(15631, 2)" уже существует.

2025-05-20 14:08:10,130 - src.repositories.postgres_repository - ERROR - Error inserting patient: ОШИБКА:  повторяющееся значение ключа нарушает ограничение уникальности "unique_hisnumber_source"
DETAIL:  Ключ "(hisnumber, source)=(1117479, 2)" уже существует.

2025-05-20 14:08:10,131 - src.repositories.postgres_repository - ERROR - Error inserting patient: ОШИБКА:  повторяющееся значение ключа нарушает ограничение уникальности "unique_hisnumber_source"
DETAIL:  Ключ "(hisnumber, source)=(10000072, 2)" уже существует.

2025-05-20 14:08:10,131 - src.repositories.postgres_repository - ERROR - Error inserting patient: ОШИБКА:  повторяющееся значение ключа нарушает ограничение уникальности "unique_hisnumber_source"
DETAIL:  Ключ "(hisnumber, source)=(40003556, 2)" уже существует.

2025-05-20 14:08:10,132 - src.repositories.postgres_repository - ERROR - Error inserting patient: ОШИБКА:  повторяющееся значение ключа нарушает ограничение уникальности "unique_hisnumber_source"
DETAIL:  Ключ "(hisnumber, source)=(10000609, 2)" уже существует.

2025-05-20 14:08:10,132 - src.repositories.postgres_repository - ERROR - Error inserting patient: ОШИБКА:  повторяющееся значение ключа нарушает ограничение уникальности "unique_hisnumber_source"
DETAIL:  Ключ "(hisnumber, source)=(10000556, 2)" уже существует.

2025-05-20 14:08:10,133 - src.repositories.postgres_repository - ERROR - Error inserting patient: ОШИБКА:  повторяющееся значение ключа нарушает ограничение уникальности "unique_hisnumber_source"
DETAIL:  Ключ "(hisnumber, source)=(122548, 2)" уже существует.

2025-05-20 14:08:10,133 - src.etl.etl_service - INFO - ETL complete: 0/10 patients processed successfully
2025-05-20 14:08:10,133 - main - INFO - ETL processed 0 patients successfully
2025-05-20 14:08:10,133 - main - WARNING - ETL process test completed but no records were processed
2025-05-20 14:08:10,140 - src.connectors.firebird_connector - INFO - Disconnected from Firebird
2025-05-20 14:08:10,140 - src.connectors.postgres_connector - INFO - Disconnected from PostgreSQL
2025-05-20 14:08:10,140 - main - INFO - 
Test Results Summary:
2025-05-20 14:08:10,141 - main - INFO - PostgreSQL Connection: ✓
2025-05-20 14:08:10,141 - main - INFO - Firebird Connection: ✓
2025-05-20 14:08:10,141 - main - INFO - YottaDB Connection: ✗
2025-05-20 14:08:10,141 - main - INFO - PostgreSQL Schema: ✓
2025-05-20 14:08:10,141 - main - INFO - Document Type Handling: ✓
2025-05-20 14:08:10,141 - main - INFO - ETL Process: ✗
2025-05-20 14:08:10,142 - main - INFO - 
Tests completed.
2025-05-20 14:09:51,466 - main - INFO - Starting tests...
2025-05-20 14:09:51,466 - main - INFO - Testing PostgreSQL connection...
2025-05-20 14:09:51,478 - src.connectors.postgres_connector - INFO - Connected to PostgreSQL
2025-05-20 14:09:51,478 - main - INFO - PostgreSQL connection successful
2025-05-20 14:09:51,479 - main - INFO - PostgreSQL version: PostgreSQL 15.12 (Debian 15.12-0+deb12u2) on x86_64-pc-linux-gnu, compiled by gcc (Debian 12.2.0-14) 12.2.0, 64-bit
2025-05-20 14:09:51,479 - src.connectors.postgres_connector - INFO - Disconnected from PostgreSQL
2025-05-20 14:09:51,479 - main - INFO - Testing Firebird connection...
2025-05-20 14:09:51,479 - main - INFO - Firebird config: {'host': '192.168.160.168:3050', 'database': '099-1', 'user': 'SYSDBA', 'password': 'masterkey', 'charset': 'UTF-8', 'debug': False}
2025-05-20 14:09:51,479 - src.connectors.firebird_connector - INFO - Testing TCP connectivity to 192.168.160.168:3050
2025-05-20 14:09:51,480 - src.connectors.firebird_connector - INFO - TCP connection to 192.168.160.168:3050 successful
2025-05-20 14:09:51,481 - src.connectors.firebird_connector - INFO - Registered Firebird server and database configurations
2025-05-20 14:09:51,481 - src.connectors.firebird_connector - INFO - Attempting to connect to Firebird at 192.168.160.168:3050, database: 099-1
2025-05-20 14:09:51,558 - src.connectors.firebird_connector - INFO - Connected to Firebird using firebird-driver
2025-05-20 14:09:51,558 - main - INFO - Firebird connection successful
2025-05-20 14:09:51,565 - main - INFO - Firebird current time: 2025-05-20 14:09:51.570000
2025-05-20 14:09:51,578 - src.repositories.firebird_repository - INFO - Retrieved 3 patients from Firebird
2025-05-20 14:09:51,579 - main - INFO - Retrieved 3 patients from Firebird through repository
2025-05-20 14:09:51,579 - main - INFO - Patient 1: Проверочный Иван
2025-05-20 14:09:51,579 - main - INFO - Patient 2: Петровский Василий
2025-05-20 14:09:51,623 - src.connectors.firebird_connector - INFO - Disconnected from Firebird
2025-05-20 14:09:51,623 - main - INFO - Testing YottaDB connection...
2025-05-20 14:09:51,624 - main - ERROR - YottaDB connection failed
2025-05-20 14:09:51,624 - main - INFO - Testing PostgreSQL schema...
2025-05-20 14:09:51,648 - src.connectors.postgres_connector - INFO - Connected to PostgreSQL
2025-05-20 14:09:51,654 - main - INFO - All essential tables exist
2025-05-20 14:09:51,655 - main - INFO - Found 2 HIS systems in hislist table
2025-05-20 14:09:51,655 - main - INFO -   hislist entry: (1, 'qMS')
2025-05-20 14:09:51,655 - main - INFO -   hislist entry: (2, 'Инфоклиника')
2025-05-20 14:09:51,656 - main - INFO - Found 3 business units in businessunits table
2025-05-20 14:09:51,656 - main - INFO -   businessunits entry: (1, 'ОО ФК "Хадасса Медикал ЛТД"')
2025-05-20 14:09:51,656 - main - INFO -   businessunits entry: (2, 'ООО "Медскан"')
2025-05-20 14:09:51,656 - main - INFO -   businessunits entry: (3, 'ООО "Клинический госпиталь на Яузе"')
2025-05-20 14:09:51,656 - main - INFO - Found 17 document types in documenttypes table
2025-05-20 14:09:51,657 - main - INFO -   documenttypes entry: (1, 'Паспорт')
2025-05-20 14:09:51,657 - main - INFO -   documenttypes entry: (2, 'Паспорт СССР')
2025-05-20 14:09:51,657 - main - INFO -   documenttypes entry: (3, 'Заграничный паспорт РФ')
2025-05-20 14:09:51,657 - main - INFO -   documenttypes entry: (4, 'Заграничный паспорт СССР')
2025-05-20 14:09:51,657 - main - INFO -   documenttypes entry: (5, 'Свидетельство о рождении')
2025-05-20 14:09:51,657 - src.connectors.postgres_connector - INFO - Disconnected from PostgreSQL
2025-05-20 14:09:51,657 - main - INFO - Testing document type handling...
2025-05-20 14:09:51,672 - src.connectors.postgres_connector - INFO - Connected to PostgreSQL
2025-05-20 14:09:51,682 - src.repositories.postgres_repository - INFO - Patient inserted with ID: 100130
2025-05-20 14:09:51,682 - main - INFO - Inserted patient with Паспорт (ID: 1), number: 9256711810
2025-05-20 14:09:51,684 - src.repositories.postgres_repository - INFO - Patient inserted with ID: 100131
2025-05-20 14:09:51,684 - main - INFO - Inserted patient with Заграничный паспорт РФ (ID: 3), number: 616830030
2025-05-20 14:09:51,686 - src.repositories.postgres_repository - INFO - Patient inserted with ID: 100132
2025-05-20 14:09:51,687 - main - INFO - Inserted patient with Свидетельство о рождении (ID: 5), number: 370213596655
2025-05-20 14:09:51,688 - src.repositories.postgres_repository - INFO - Patient inserted with ID: 100133
2025-05-20 14:09:51,689 - main - INFO - Inserted patient with Иностранный паспорт (ID: 10), number: 686901151
2025-05-20 14:09:51,690 - src.repositories.postgres_repository - INFO - Patient inserted with ID: 100134
2025-05-20 14:09:51,690 - main - INFO - Inserted patient with Временное удостоверение (ID: 14), number: 28358907
2025-05-20 14:09:51,692 - src.repositories.postgres_repository - INFO - Patient inserted with ID: 100135
2025-05-20 14:09:51,693 - main - INFO - Inserted patient with Иные документы (ID: 17), number: 67628068
2025-05-20 14:09:51,693 - main - INFO - Successfully inserted 6 out of 6 test patients with different document types
2025-05-20 14:09:51,693 - src.connectors.postgres_connector - INFO - Disconnected from PostgreSQL
2025-05-20 14:09:51,693 - main - INFO - Testing ETL process with the repository-transformer architecture...
2025-05-20 14:09:51,693 - src.connectors.firebird_connector - INFO - Testing TCP connectivity to 192.168.160.168:3050
2025-05-20 14:09:51,694 - src.connectors.firebird_connector - INFO - TCP connection to 192.168.160.168:3050 successful
2025-05-20 14:09:51,694 - src.connectors.firebird_connector - INFO - Using previously registered Firebird configuration
2025-05-20 14:09:51,694 - src.connectors.firebird_connector - INFO - Attempting to connect to Firebird at 192.168.160.168:3050, database: 099-1
2025-05-20 14:09:51,741 - src.connectors.firebird_connector - INFO - Connected to Firebird using firebird-driver
2025-05-20 14:09:51,760 - src.connectors.postgres_connector - INFO - Connected to PostgreSQL
2025-05-20 14:09:51,760 - main - INFO - Processing 10 patients through ETL
2025-05-20 14:09:51,760 - src.etl.etl_service - INFO - Extracting up to 10 patients from Firebird
2025-05-20 14:09:51,778 - src.repositories.firebird_repository - INFO - Retrieved 10 patients from Firebird
2025-05-20 14:09:51,778 - src.etl.etl_service - INFO - Transforming 10 patients
2025-05-20 14:09:51,779 - src.etl.etl_service - INFO - Loading 10 patients into PostgreSQL
2025-05-20 14:09:51,786 - src.repositories.postgres_repository - ERROR - Error inserting patient: ОШИБКА:  повторяющееся значение ключа нарушает ограничение уникальности "unique_hisnumber_source"
DETAIL:  Ключ "(hisnumber, source)=(10000233, 2)" уже существует.

2025-05-20 14:09:51,787 - src.repositories.postgres_repository - ERROR - Error inserting patient: ОШИБКА:  повторяющееся значение ключа нарушает ограничение уникальности "unique_hisnumber_source"
DETAIL:  Ключ "(hisnumber, source)=(15678, 2)" уже существует.

2025-05-20 14:09:51,788 - src.repositories.postgres_repository - ERROR - Error inserting patient: ОШИБКА:  повторяющееся значение ключа нарушает ограничение уникальности "unique_hisnumber_source"
DETAIL:  Ключ "(hisnumber, source)=(10000001, 2)" уже существует.

2025-05-20 14:09:51,790 - src.repositories.postgres_repository - ERROR - Error inserting patient: ОШИБКА:  повторяющееся значение ключа нарушает ограничение уникальности "unique_hisnumber_source"
DETAIL:  Ключ "(hisnumber, source)=(15631, 2)" уже существует.

2025-05-20 14:09:51,791 - src.repositories.postgres_repository - ERROR - Error inserting patient: ОШИБКА:  повторяющееся значение ключа нарушает ограничение уникальности "unique_hisnumber_source"
DETAIL:  Ключ "(hisnumber, source)=(1117479, 2)" уже существует.

2025-05-20 14:09:51,792 - src.repositories.postgres_repository - ERROR - Error inserting patient: ОШИБКА:  повторяющееся значение ключа нарушает ограничение уникальности "unique_hisnumber_source"
DETAIL:  Ключ "(hisnumber, source)=(10000072, 2)" уже существует.

2025-05-20 14:09:51,793 - src.repositories.postgres_repository - ERROR - Error inserting patient: ОШИБКА:  повторяющееся значение ключа нарушает ограничение уникальности "unique_hisnumber_source"
DETAIL:  Ключ "(hisnumber, source)=(40003556, 2)" уже существует.

2025-05-20 14:09:51,794 - src.repositories.postgres_repository - ERROR - Error inserting patient: ОШИБКА:  повторяющееся значение ключа нарушает ограничение уникальности "unique_hisnumber_source"
DETAIL:  Ключ "(hisnumber, source)=(10000609, 2)" уже существует.

2025-05-20 14:09:51,795 - src.repositories.postgres_repository - ERROR - Error inserting patient: ОШИБКА:  повторяющееся значение ключа нарушает ограничение уникальности "unique_hisnumber_source"
DETAIL:  Ключ "(hisnumber, source)=(10000556, 2)" уже существует.

2025-05-20 14:09:51,796 - src.repositories.postgres_repository - ERROR - Error inserting patient: ОШИБКА:  повторяющееся значение ключа нарушает ограничение уникальности "unique_hisnumber_source"
DETAIL:  Ключ "(hisnumber, source)=(122548, 2)" уже существует.

2025-05-20 14:09:51,797 - src.etl.etl_service - INFO - ETL complete: 0/10 patients processed successfully
2025-05-20 14:09:51,797 - main - INFO - ETL processed 0 patients successfully
2025-05-20 14:09:51,797 - main - WARNING - ETL process test completed but no records were processed
2025-05-20 14:09:51,805 - src.connectors.firebird_connector - INFO - Disconnected from Firebird
2025-05-20 14:09:51,805 - src.connectors.postgres_connector - INFO - Disconnected from PostgreSQL
2025-05-20 14:09:51,805 - main - INFO - 
Test Results Summary:
2025-05-20 14:09:51,805 - main - INFO - PostgreSQL Connection: ✓
2025-05-20 14:09:51,806 - main - INFO - Firebird Connection: ✓
2025-05-20 14:09:51,806 - main - INFO - YottaDB Connection: ✗
2025-05-20 14:09:51,806 - main - INFO - PostgreSQL Schema: ✓
2025-05-20 14:09:51,806 - main - INFO - Document Type Handling: ✓
2025-05-20 14:09:51,806 - main - INFO - ETL Process: ✗
2025-05-20 14:09:51,806 - main - INFO - 
Tests completed.
2025-05-20 14:43:02,015 - main - INFO - Starting tests...
2025-05-20 14:43:02,015 - main - INFO - Testing PostgreSQL connection...
2025-05-20 14:43:02,034 - src.connectors.postgres_connector - INFO - Connected to PostgreSQL
2025-05-20 14:43:02,034 - main - INFO - PostgreSQL connection successful
2025-05-20 14:43:02,036 - main - INFO - PostgreSQL version: PostgreSQL 15.12 (Debian 15.12-0+deb12u2) on x86_64-pc-linux-gnu, compiled by gcc (Debian 12.2.0-14) 12.2.0, 64-bit
2025-05-20 14:43:02,036 - src.connectors.postgres_connector - INFO - Disconnected from PostgreSQL
2025-05-20 14:43:02,036 - main - INFO - Testing Firebird connection...
2025-05-20 14:43:02,037 - main - INFO - Firebird config: {'host': '192.168.160.168:3050', 'database': '099-1', 'user': 'SYSDBA', 'password': 'masterkey', 'charset': 'UTF-8', 'debug': False}
2025-05-20 14:43:02,037 - src.connectors.firebird_connector - INFO - Testing TCP connectivity to 192.168.160.168:3050
2025-05-20 14:43:02,037 - src.connectors.firebird_connector - INFO - TCP connection to 192.168.160.168:3050 successful
2025-05-20 14:43:02,038 - src.connectors.firebird_connector - INFO - Registered Firebird server and database configurations
2025-05-20 14:43:02,039 - src.connectors.firebird_connector - INFO - Attempting to connect to Firebird at 192.168.160.168:3050, database: 099-1
2025-05-20 14:43:02,091 - src.connectors.firebird_connector - INFO - Connected to Firebird using firebird-driver
2025-05-20 14:43:02,091 - main - INFO - Firebird connection successful
2025-05-20 14:43:02,098 - main - INFO - Firebird current time: 2025-05-20 14:43:02.100000
2025-05-20 14:43:02,110 - src.repositories.firebird_repository - INFO - Retrieved 3 patients from Firebird
2025-05-20 14:43:02,111 - main - INFO - Retrieved 3 patients from Firebird through repository
2025-05-20 14:43:02,111 - main - INFO - Patient 1: Проверочный Иван
2025-05-20 14:43:02,111 - main - INFO - Patient 2: Петровский Василий
2025-05-20 14:43:02,115 - src.connectors.firebird_connector - INFO - Disconnected from Firebird
2025-05-20 14:43:02,115 - main - INFO - Testing YottaDB connection...
2025-05-20 14:43:02,116 - main - ERROR - YottaDB connection failed
2025-05-20 14:43:02,116 - main - INFO - Testing PostgreSQL schema...
2025-05-20 14:43:02,138 - src.connectors.postgres_connector - INFO - Connected to PostgreSQL
2025-05-20 14:43:02,147 - main - INFO - All essential tables exist
2025-05-20 14:43:02,148 - main - INFO - Found 2 HIS systems in hislist table
2025-05-20 14:43:02,149 - main - INFO -   hislist entry: (1, 'qMS')
2025-05-20 14:43:02,149 - main - INFO -   hislist entry: (2, 'Инфоклиника')
2025-05-20 14:43:02,150 - main - INFO - Found 3 business units in businessunits table
2025-05-20 14:43:02,150 - main - INFO -   businessunits entry: (1, 'ОО ФК "Хадасса Медикал ЛТД"')
2025-05-20 14:43:02,150 - main - INFO -   businessunits entry: (2, 'ООО "Медскан"')
2025-05-20 14:43:02,150 - main - INFO -   businessunits entry: (3, 'ООО "Клинический госпиталь на Яузе"')
2025-05-20 14:43:02,151 - main - INFO - Found 17 document types in documenttypes table
2025-05-20 14:43:02,151 - main - INFO -   documenttypes entry: (1, 'Паспорт')
2025-05-20 14:43:02,151 - main - INFO -   documenttypes entry: (2, 'Паспорт СССР')
2025-05-20 14:43:02,151 - main - INFO -   documenttypes entry: (3, 'Заграничный паспорт РФ')
2025-05-20 14:43:02,151 - main - INFO -   documenttypes entry: (4, 'Заграничный паспорт СССР')
2025-05-20 14:43:02,151 - main - INFO -   documenttypes entry: (5, 'Свидетельство о рождении')
2025-05-20 14:43:02,152 - src.connectors.postgres_connector - INFO - Disconnected from PostgreSQL
2025-05-20 14:43:02,153 - main - INFO - Testing document type handling...
2025-05-20 14:43:02,177 - src.connectors.postgres_connector - INFO - Connected to PostgreSQL
2025-05-20 14:43:02,192 - src.repositories.postgres_repository - INFO - Patient inserted with ID: 100146
2025-05-20 14:43:02,192 - main - INFO - Inserted patient with Паспорт (ID: 1), number: 1791465508
2025-05-20 14:43:02,196 - src.repositories.postgres_repository - INFO - Patient inserted with ID: 100147
2025-05-20 14:43:02,196 - main - INFO - Inserted patient with Заграничный паспорт РФ (ID: 3), number: 437737011
2025-05-20 14:43:02,200 - src.repositories.postgres_repository - INFO - Patient inserted with ID: 100148
2025-05-20 14:43:02,200 - main - INFO - Inserted patient with Свидетельство о рождении (ID: 5), number: 251489386539
2025-05-20 14:43:02,203 - src.repositories.postgres_repository - INFO - Patient inserted with ID: 100149
2025-05-20 14:43:02,203 - main - INFO - Inserted patient with Иностранный паспорт (ID: 10), number: 597830857
2025-05-20 14:43:02,205 - src.repositories.postgres_repository - INFO - Patient inserted with ID: 100150
2025-05-20 14:43:02,206 - main - INFO - Inserted patient with Временное удостоверение (ID: 14), number: 66222158
2025-05-20 14:43:02,208 - src.repositories.postgres_repository - INFO - Patient inserted with ID: 100151
2025-05-20 14:43:02,209 - main - INFO - Inserted patient with Иные документы (ID: 17), number: 33221216
2025-05-20 14:43:02,209 - main - INFO - Successfully inserted 6 out of 6 test patients with different document types
2025-05-20 14:43:02,209 - src.connectors.postgres_connector - INFO - Disconnected from PostgreSQL
2025-05-20 14:43:02,210 - main - INFO - Testing ETL process with the repository-transformer architecture...
2025-05-20 14:43:02,210 - src.connectors.firebird_connector - INFO - Testing TCP connectivity to 192.168.160.168:3050
2025-05-20 14:43:02,211 - src.connectors.firebird_connector - INFO - TCP connection to 192.168.160.168:3050 successful
2025-05-20 14:43:02,211 - src.connectors.firebird_connector - INFO - Using previously registered Firebird configuration
2025-05-20 14:43:02,211 - src.connectors.firebird_connector - INFO - Attempting to connect to Firebird at 192.168.160.168:3050, database: 099-1
2025-05-20 14:43:02,247 - src.connectors.firebird_connector - INFO - Connected to Firebird using firebird-driver
2025-05-20 14:43:02,271 - src.connectors.postgres_connector - INFO - Connected to PostgreSQL
2025-05-20 14:43:02,271 - main - INFO - Processing 10 patients through ETL
2025-05-20 14:43:02,271 - src.etl.etl_service - INFO - Extracting up to 10 patients from Firebird
2025-05-20 14:43:02,290 - src.repositories.firebird_repository - INFO - Retrieved 10 patients from Firebird
2025-05-20 14:43:02,291 - src.etl.etl_service - INFO - Transforming 10 patients
2025-05-20 14:43:02,291 - src.etl.etl_service - INFO - Loading 10 patients into PostgreSQL
2025-05-20 14:43:02,301 - src.repositories.postgres_repository - INFO - Patient inserted with ID: 100152
2025-05-20 14:43:02,303 - src.repositories.postgres_repository - INFO - Patient inserted with ID: 100153
2025-05-20 14:43:02,307 - src.repositories.postgres_repository - INFO - Patient inserted with ID: 100154
2025-05-20 14:43:02,310 - src.repositories.postgres_repository - INFO - Patient inserted with ID: 100155
2025-05-20 14:43:02,312 - src.repositories.postgres_repository - INFO - Patient inserted with ID: 100156
2025-05-20 14:43:02,316 - src.repositories.postgres_repository - INFO - Patient inserted with ID: 100157
2025-05-20 14:43:02,322 - src.repositories.postgres_repository - INFO - Patient inserted with ID: 100158
2025-05-20 14:43:02,327 - src.repositories.postgres_repository - INFO - Patient inserted with ID: 100159
2025-05-20 14:43:02,329 - src.repositories.postgres_repository - INFO - Patient inserted with ID: 100160
2025-05-20 14:43:02,331 - src.repositories.postgres_repository - INFO - Patient inserted with ID: 100161
2025-05-20 14:43:02,332 - src.etl.etl_service - INFO - ETL complete: 10/10 patients processed successfully
2025-05-20 14:43:02,332 - main - INFO - ETL processed 10 patients successfully
2025-05-20 14:43:02,332 - main - INFO - ETL process test successful
2025-05-20 14:43:02,337 - src.connectors.firebird_connector - INFO - Disconnected from Firebird
2025-05-20 14:43:02,338 - src.connectors.postgres_connector - INFO - Disconnected from PostgreSQL
2025-05-20 14:43:02,338 - main - INFO - 
Test Results Summary:
2025-05-20 14:43:02,339 - main - INFO - PostgreSQL Connection: ✓
2025-05-20 14:43:02,339 - main - INFO - Firebird Connection: ✓
2025-05-20 14:43:02,339 - main - INFO - YottaDB Connection: ✗
2025-05-20 14:43:02,339 - main - INFO - PostgreSQL Schema: ✓
2025-05-20 14:43:02,339 - main - INFO - Document Type Handling: ✓
2025-05-20 14:43:02,339 - main - INFO - ETL Process: ✓
2025-05-20 14:43:02,339 - main - INFO - 
Tests completed.
2025-05-20 15:44:37,558 - main - INFO - Starting tests...
2025-05-20 15:44:37,558 - main - INFO - Testing PostgreSQL connection...
2025-05-20 15:44:37,572 - src.connectors.postgres_connector - INFO - Connected to PostgreSQL
2025-05-20 15:44:37,572 - main - INFO - PostgreSQL connection successful
2025-05-20 15:44:37,573 - main - INFO - PostgreSQL version: PostgreSQL 15.12 (Debian 15.12-0+deb12u2) on x86_64-pc-linux-gnu, compiled by gcc (Debian 12.2.0-14) 12.2.0, 64-bit
2025-05-20 15:44:37,573 - src.connectors.postgres_connector - INFO - Disconnected from PostgreSQL
2025-05-20 15:44:37,573 - main - INFO - Testing Firebird connection...
2025-05-20 15:44:37,574 - main - INFO - Firebird config: {'host': '192.168.160.168:3050', 'database': '099-1', 'user': 'SYSDBA', 'password': 'masterkey', 'charset': 'UTF-8', 'debug': False}
2025-05-20 15:44:37,574 - src.connectors.firebird_connector - INFO - Testing TCP connectivity to 192.168.160.168:3050
2025-05-20 15:44:37,574 - src.connectors.firebird_connector - INFO - TCP connection to 192.168.160.168:3050 successful
2025-05-20 15:44:37,575 - src.connectors.firebird_connector - INFO - Registered Firebird server and database configurations
2025-05-20 15:44:37,576 - src.connectors.firebird_connector - INFO - Attempting to connect to Firebird at 192.168.160.168:3050, database: 099-1
2025-05-20 15:44:37,623 - src.connectors.firebird_connector - INFO - Connected to Firebird using firebird-driver
2025-05-20 15:44:37,624 - main - INFO - Firebird connection successful
2025-05-20 15:44:37,630 - main - INFO - Firebird current time: 2025-05-20 15:44:37.631000
2025-05-20 15:44:37,645 - src.repositories.firebird_repository - INFO - Retrieved 3 patients from Firebird
2025-05-20 15:44:37,645 - main - INFO - Retrieved 3 patients from Firebird through repository
2025-05-20 15:44:37,645 - main - INFO - Patient 1: Проверочный Иван
2025-05-20 15:44:37,646 - main - INFO - Patient 2: Петровский Василий
2025-05-20 15:44:37,667 - src.connectors.firebird_connector - INFO - Disconnected from Firebird
2025-05-20 15:44:37,667 - main - INFO - Testing YottaDB connection...
2025-05-20 15:44:37,667 - main - ERROR - YottaDB connection failed
2025-05-20 15:44:37,667 - main - INFO - Testing PostgreSQL schema...
2025-05-20 15:44:37,712 - src.connectors.postgres_connector - INFO - Connected to PostgreSQL
2025-05-20 15:44:37,722 - main - INFO - All essential tables exist
2025-05-20 15:44:37,722 - main - INFO - Found 2 HIS systems in hislist table
2025-05-20 15:44:37,722 - main - INFO -   hislist entry: (1, 'qMS')
2025-05-20 15:44:37,723 - main - INFO -   hislist entry: (2, 'Инфоклиника')
2025-05-20 15:44:37,723 - main - INFO - Found 3 business units in businessunits table
2025-05-20 15:44:37,723 - main - INFO -   businessunits entry: (1, 'ОО ФК "Хадасса Медикал ЛТД"')
2025-05-20 15:44:37,723 - main - INFO -   businessunits entry: (2, 'ООО "Медскан"')
2025-05-20 15:44:37,723 - main - INFO -   businessunits entry: (3, 'ООО "Клинический госпиталь на Яузе"')
2025-05-20 15:44:37,724 - main - INFO - Found 17 document types in documenttypes table
2025-05-20 15:44:37,724 - main - INFO -   documenttypes entry: (1, 'Паспорт')
2025-05-20 15:44:37,724 - main - INFO -   documenttypes entry: (2, 'Паспорт СССР')
2025-05-20 15:44:37,724 - main - INFO -   documenttypes entry: (3, 'Заграничный паспорт РФ')
2025-05-20 15:44:37,724 - main - INFO -   documenttypes entry: (4, 'Заграничный паспорт СССР')
2025-05-20 15:44:37,724 - main - INFO -   documenttypes entry: (5, 'Свидетельство о рождении')
2025-05-20 15:44:37,725 - src.connectors.postgres_connector - INFO - Disconnected from PostgreSQL
2025-05-20 15:44:37,725 - main - INFO - Testing document type handling...
2025-05-20 15:44:37,738 - src.connectors.postgres_connector - INFO - Connected to PostgreSQL
2025-05-20 15:44:37,748 - src.repositories.postgres_repository - INFO - Patient inserted with ID: 1100162
2025-05-20 15:44:37,748 - main - INFO - Inserted patient with Паспорт (ID: 1), number: 1562289633
2025-05-20 15:44:37,750 - src.repositories.postgres_repository - INFO - Patient inserted with ID: 1100163
2025-05-20 15:44:37,750 - main - INFO - Inserted patient with Заграничный паспорт РФ (ID: 3), number: 211253004
2025-05-20 15:44:37,752 - src.repositories.postgres_repository - INFO - Patient inserted with ID: 1100164
2025-05-20 15:44:37,752 - main - INFO - Inserted patient with Свидетельство о рождении (ID: 5), number: 199790683997
2025-05-20 15:44:37,753 - src.repositories.postgres_repository - INFO - Patient inserted with ID: 1100165
2025-05-20 15:44:37,753 - main - INFO - Inserted patient with Иностранный паспорт (ID: 10), number: 788086967
2025-05-20 15:44:37,755 - src.repositories.postgres_repository - INFO - Patient inserted with ID: 1100166
2025-05-20 15:44:37,755 - main - INFO - Inserted patient with Временное удостоверение (ID: 14), number: 25507160
2025-05-20 15:44:37,757 - src.repositories.postgres_repository - INFO - Patient inserted with ID: 1100167
2025-05-20 15:44:37,757 - main - INFO - Inserted patient with Иные документы (ID: 17), number: 85817853
2025-05-20 15:44:37,757 - main - INFO - Successfully inserted 6 out of 6 test patients with different document types
2025-05-20 15:44:37,757 - src.connectors.postgres_connector - INFO - Disconnected from PostgreSQL
2025-05-20 15:44:37,758 - main - INFO - Testing ETL process with the repository-transformer architecture...
2025-05-20 15:44:37,758 - src.connectors.firebird_connector - INFO - Testing TCP connectivity to 192.168.160.168:3050
2025-05-20 15:44:37,758 - src.connectors.firebird_connector - INFO - TCP connection to 192.168.160.168:3050 successful
2025-05-20 15:44:37,758 - src.connectors.firebird_connector - INFO - Using previously registered Firebird configuration
2025-05-20 15:44:37,759 - src.connectors.firebird_connector - INFO - Attempting to connect to Firebird at 192.168.160.168:3050, database: 099-1
2025-05-20 15:44:37,804 - src.connectors.firebird_connector - INFO - Connected to Firebird using firebird-driver
2025-05-20 15:44:37,819 - src.connectors.postgres_connector - INFO - Connected to PostgreSQL
2025-05-20 15:44:37,819 - main - INFO - Processing 10 patients through ETL
2025-05-20 15:44:37,819 - src.etl.etl_service - INFO - Extracting up to 10 patients from Firebird
2025-05-20 15:44:37,836 - src.repositories.firebird_repository - INFO - Retrieved 10 patients from Firebird
2025-05-20 15:44:37,837 - src.etl.etl_service - INFO - Transforming 10 patients
2025-05-20 15:44:37,837 - src.etl.etl_service - INFO - Loading 10 patients into PostgreSQL
2025-05-20 15:44:37,845 - src.repositories.postgres_repository - INFO - Patient inserted with ID: 1100168
2025-05-20 15:44:37,847 - src.repositories.postgres_repository - INFO - Patient inserted with ID: 1100169
2025-05-20 15:44:37,851 - src.repositories.postgres_repository - INFO - Patient inserted with ID: 1100170
2025-05-20 15:44:37,853 - src.repositories.postgres_repository - INFO - Patient inserted with ID: 1100171
2025-05-20 15:44:37,854 - src.repositories.postgres_repository - INFO - Patient inserted with ID: 1100172
2025-05-20 15:44:37,855 - src.repositories.postgres_repository - INFO - Patient inserted with ID: 1100173
2025-05-20 15:44:37,856 - src.repositories.postgres_repository - INFO - Patient inserted with ID: 1100174
2025-05-20 15:44:37,858 - src.repositories.postgres_repository - INFO - Patient inserted with ID: 1100175
2025-05-20 15:44:37,858 - src.repositories.postgres_repository - INFO - Patient inserted with ID: 1100176
2025-05-20 15:44:37,859 - src.repositories.postgres_repository - INFO - Patient inserted with ID: 1100177
2025-05-20 15:44:37,860 - src.etl.etl_service - INFO - ETL complete: 10/10 patients processed successfully
2025-05-20 15:44:37,860 - main - INFO - ETL processed 10 patients successfully
2025-05-20 15:44:37,860 - main - INFO - ETL process test successful
2025-05-20 15:44:37,864 - src.connectors.firebird_connector - INFO - Disconnected from Firebird
2025-05-20 15:44:37,864 - src.connectors.postgres_connector - INFO - Disconnected from PostgreSQL
2025-05-20 15:44:37,864 - main - INFO - 
Test Results Summary:
2025-05-20 15:44:37,864 - main - INFO - PostgreSQL Connection: ✓
2025-05-20 15:44:37,864 - main - INFO - Firebird Connection: ✓
2025-05-20 15:44:37,864 - main - INFO - YottaDB Connection: ✗
2025-05-20 15:44:37,864 - main - INFO - PostgreSQL Schema: ✓
2025-05-20 15:44:37,864 - main - INFO - Document Type Handling: ✓
2025-05-20 15:44:37,865 - main - INFO - ETL Process: ✓
2025-05-20 15:44:37,865 - main - INFO - 
Tests completed.
2025-05-20 17:12:51,616 - main - INFO - Starting tests...
2025-05-20 17:12:51,616 - main - INFO - Testing PostgreSQL connection...
2025-05-20 17:12:51,629 - src.connectors.postgres_connector - INFO - Connected to PostgreSQL
2025-05-20 17:12:51,629 - main - INFO - PostgreSQL connection successful
2025-05-20 17:12:51,630 - main - INFO - PostgreSQL version: PostgreSQL 15.12 (Debian 15.12-0+deb12u2) on x86_64-pc-linux-gnu, compiled by gcc (Debian 12.2.0-14) 12.2.0, 64-bit
2025-05-20 17:12:51,630 - src.connectors.postgres_connector - INFO - Disconnected from PostgreSQL
2025-05-20 17:12:51,630 - main - INFO - Testing Firebird connection...
2025-05-20 17:12:51,631 - main - INFO - Firebird config: {'host': '192.168.160.168:3050', 'database': '099-1', 'user': 'SYSDBA', 'password': 'masterkey', 'charset': 'UTF-8', 'debug': False}
2025-05-20 17:12:51,631 - src.connectors.firebird_connector - INFO - Testing TCP connectivity to 192.168.160.168:3050
2025-05-20 17:12:51,631 - src.connectors.firebird_connector - INFO - TCP connection to 192.168.160.168:3050 successful
2025-05-20 17:12:51,632 - src.connectors.firebird_connector - INFO - Registered Firebird server and database configurations
2025-05-20 17:12:51,632 - src.connectors.firebird_connector - INFO - Attempting to connect to Firebird at 192.168.160.168:3050, database: 099-1
2025-05-20 17:12:51,686 - src.connectors.firebird_connector - INFO - Connected to Firebird using firebird-driver
2025-05-20 17:12:51,686 - main - INFO - Firebird connection successful
2025-05-20 17:12:51,695 - main - INFO - Firebird current time: 2025-05-20 17:12:51.688000
2025-05-20 17:12:52,000 - src.repositories.firebird_repository - INFO - Retrieved 3 patients from Firebird
2025-05-20 17:12:52,000 - main - INFO - Retrieved 3 patients from Firebird through repository
2025-05-20 17:12:52,000 - main - INFO - Patient 1: Корректировка Касса
2025-05-20 17:12:52,001 - main - INFO - Patient 2: Е Е
2025-05-20 17:12:52,006 - src.connectors.firebird_connector - INFO - Disconnected from Firebird
2025-05-20 17:12:52,006 - main - INFO - Testing YottaDB connection...
2025-05-20 17:12:52,006 - main - ERROR - YottaDB connection failed
2025-05-20 17:12:52,007 - main - INFO - Testing PostgreSQL schema...
2025-05-20 17:12:52,027 - src.connectors.postgres_connector - INFO - Connected to PostgreSQL
2025-05-20 17:12:52,031 - main - INFO - All essential tables exist
2025-05-20 17:12:52,032 - main - INFO - Found 2 HIS systems in hislist table
2025-05-20 17:12:52,032 - main - INFO -   hislist entry: (1, 'qMS')
2025-05-20 17:12:52,032 - main - INFO -   hislist entry: (2, 'Инфоклиника')
2025-05-20 17:12:52,033 - main - INFO - Found 3 business units in businessunits table
2025-05-20 17:12:52,033 - main - INFO -   businessunits entry: (1, 'ОО ФК "Хадасса Медикал ЛТД"')
2025-05-20 17:12:52,033 - main - INFO -   businessunits entry: (2, 'ООО "Медскан"')
2025-05-20 17:12:52,033 - main - INFO -   businessunits entry: (3, 'ООО "Клинический госпиталь на Яузе"')
2025-05-20 17:12:52,033 - main - INFO - Found 17 document types in documenttypes table
2025-05-20 17:12:52,034 - main - INFO -   documenttypes entry: (1, 'Паспорт')
2025-05-20 17:12:52,034 - main - INFO -   documenttypes entry: (2, 'Паспорт СССР')
2025-05-20 17:12:52,034 - main - INFO -   documenttypes entry: (3, 'Заграничный паспорт РФ')
2025-05-20 17:12:52,034 - main - INFO -   documenttypes entry: (4, 'Заграничный паспорт СССР')
2025-05-20 17:12:52,034 - main - INFO -   documenttypes entry: (5, 'Свидетельство о рождении')
2025-05-20 17:12:52,034 - src.connectors.postgres_connector - INFO - Disconnected from PostgreSQL
2025-05-20 17:12:52,034 - main - INFO - Testing document type handling...
2025-05-20 17:12:52,047 - src.connectors.postgres_connector - INFO - Connected to PostgreSQL
2025-05-20 17:12:52,057 - src.repositories.postgres_repository - INFO - Patient inserted with ID: 1100178
2025-05-20 17:12:52,058 - main - INFO - Inserted patient with Паспорт (ID: 1), number: 1694327543
2025-05-20 17:12:52,062 - src.repositories.postgres_repository - INFO - Patient inserted with ID: 1100179
2025-05-20 17:12:52,062 - main - INFO - Inserted patient with Заграничный паспорт РФ (ID: 3), number: 971889558
2025-05-20 17:12:52,065 - src.repositories.postgres_repository - INFO - Patient inserted with ID: 1100180
2025-05-20 17:12:52,066 - main - INFO - Inserted patient with Свидетельство о рождении (ID: 5), number: 818923043522
2025-05-20 17:12:52,069 - src.repositories.postgres_repository - INFO - Patient inserted with ID: 1100181
2025-05-20 17:12:52,070 - main - INFO - Inserted patient with Иностранный паспорт (ID: 10), number: 591743171
2025-05-20 17:12:52,073 - src.repositories.postgres_repository - INFO - Patient inserted with ID: 1100182
2025-05-20 17:12:52,073 - main - INFO - Inserted patient with Временное удостоверение (ID: 14), number: 16471268
2025-05-20 17:12:52,077 - src.repositories.postgres_repository - INFO - Patient inserted with ID: 1100183
2025-05-20 17:12:52,077 - main - INFO - Inserted patient with Иные документы (ID: 17), number: 26515642
2025-05-20 17:12:52,077 - main - INFO - Successfully inserted 6 out of 6 test patients with different document types
2025-05-20 17:12:52,078 - src.connectors.postgres_connector - INFO - Disconnected from PostgreSQL
2025-05-20 17:12:52,078 - main - INFO - Testing ETL process with the repository-transformer architecture...
2025-05-20 17:12:52,078 - src.connectors.firebird_connector - INFO - Testing TCP connectivity to 192.168.160.168:3050
2025-05-20 17:12:52,079 - src.connectors.firebird_connector - INFO - TCP connection to 192.168.160.168:3050 successful
2025-05-20 17:12:52,079 - src.connectors.firebird_connector - INFO - Using previously registered Firebird configuration
2025-05-20 17:12:52,080 - src.connectors.firebird_connector - INFO - Attempting to connect to Firebird at 192.168.160.168:3050, database: 099-1
2025-05-20 17:12:52,134 - src.connectors.firebird_connector - INFO - Connected to Firebird using firebird-driver
2025-05-20 17:12:52,147 - src.connectors.postgres_connector - INFO - Connected to PostgreSQL
2025-05-20 17:12:52,147 - main - INFO - Processing 10 patients through ETL
2025-05-20 17:12:52,147 - src.etl.etl_service - INFO - Extracting up to 10 patients from source
2025-05-20 17:12:52,430 - src.repositories.firebird_repository - INFO - Retrieved 10 patients from Firebird
2025-05-20 17:12:52,431 - src.etl.etl_service - INFO - Transforming 10 patients
2025-05-20 17:12:52,431 - src.etl.etl_service - INFO - Loading 10 patients into target
2025-05-20 17:12:52,450 - src.repositories.postgres_repository - INFO - Patient inserted with ID: 1100184
2025-05-20 17:12:52,454 - src.repositories.postgres_repository - INFO - Patient inserted with ID: 1100185
2025-05-20 17:12:52,458 - src.repositories.postgres_repository - INFO - Patient inserted with ID: 1100186
2025-05-20 17:12:52,461 - src.repositories.postgres_repository - INFO - Patient inserted with ID: 1100187
2025-05-20 17:12:52,465 - src.repositories.postgres_repository - INFO - Patient inserted with ID: 1100188
2025-05-20 17:12:52,470 - src.repositories.postgres_repository - INFO - Patient inserted with ID: 1100189
2025-05-20 17:12:52,472 - src.repositories.postgres_repository - INFO - Patient inserted with ID: 1100190
2025-05-20 17:12:52,474 - src.repositories.postgres_repository - INFO - Patient inserted with ID: 1100191
2025-05-20 17:12:52,476 - src.repositories.postgres_repository - INFO - Patient inserted with ID: 1100192
2025-05-20 17:12:52,478 - src.repositories.postgres_repository - INFO - Patient inserted with ID: 1100193
2025-05-20 17:12:52,479 - src.etl.etl_service - INFO - Batch complete: 10/10 patients processed successfully
2025-05-20 17:12:52,479 - main - INFO - ETL processed 10 patients successfully
2025-05-20 17:12:52,479 - main - INFO - ETL process test successful
2025-05-20 17:12:52,486 - src.connectors.firebird_connector - INFO - Disconnected from Firebird
2025-05-20 17:12:52,487 - src.connectors.postgres_connector - INFO - Disconnected from PostgreSQL
2025-05-20 17:12:52,487 - main - INFO - 
Test Results Summary:
2025-05-20 17:12:52,487 - main - INFO - PostgreSQL Connection: ✓
2025-05-20 17:12:52,487 - main - INFO - Firebird Connection: ✓
2025-05-20 17:12:52,487 - main - INFO - YottaDB Connection: ✗
2025-05-20 17:12:52,488 - main - INFO - PostgreSQL Schema: ✓
2025-05-20 17:12:52,488 - main - INFO - Document Type Handling: ✓
2025-05-20 17:12:52,488 - main - INFO - ETL Process: ✓
2025-05-20 17:12:52,488 - main - INFO - 
Tests completed.
